

using DrWatson, Plots, LaTeXStrings

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end



# Define data


#T = 0.1, alpha = 0.1, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.001, jump = 10, boson_dim = 12, omega = 5;

mQ1 = [7.569385609601771e-10;
1.250437638537191e-5;
0.0014895063572579166;
0.005413776291221681;
0.01163692679755641;
0.020016076290858765;
0.030506758442998133;
0.042670721070349256;
0.05620067265428433;
0.0707833301315027;
0.0866317433255432;
0.1030873853981776;
0.11953367285797742;
0.13689634600940176;
0.15426127518054472;
0.17098537518340015;
0.18826355793472338;
0.2051340872211295;
0.2211171748873654;
0.23743056560474368;
0.25246228639006757;
0.2664916024241576;
0.28076922697508827;
0.2970950547493657;
0.3107375752639702;
0.3246614229654116;
0.33677644759764624;
0.34984876533739584;
0.36112882992269696;
0.372950444368582;
0.3822975037536246;
0.39306056596041805;
0.40268440372403036;
0.41176983912367465;
0.42150053943022714;
0.42965549682811227;
0.4390102008431808;
0.4468647613702106;
0.45529638283109314;
0.46270769214705154;
0.47065805212073697;
0.4774941149414349;
0.48498026156327156;
0.49141020873161206;
0.4981135307533122;
0.5040542091823711;
0.5096748041543786;
0.5158543087558185;
0.521116138925917;
0.5272091085807341;
0.5324465438711844;
0.5373956400381882;
0.5429509079350961;
0.5486355161792755;
0.5537599654690519;
0.5589798475061789;
0.5633733701398492;
0.5676454766409081;
0.5715642244657752;
0.5761450904639522;
0.5806720244624433;
0.5849251886897725;
0.588817128599488;
0.5928927842870729;
0.5962029480919903;
0.6003801760990893;
0.6035337748112564;
0.6071591342399952;
0.6103135291608384;
0.6134414741797889;
0.6171111239068382;
0.6200407497603615;
0.6226099141450883;
0.6258158673523685;
0.6294754493032282;
0.6329232215694823;
0.6357740934621984;
0.6388950461624413;
0.641762482328778;
0.644377577462287;
0.6471659385464035;
0.6499791319004322;
0.652220242057596;
0.6554683625380542;
0.6576052457716128;
0.6602114514965794;
0.6619092699186131;
0.6642613496203809;
0.6666458626860292;
0.668972595293983;
0.671135381231412;
0.6739434299117789;
0.676261532785134;
0.6795768193267514;
0.6816754330239156;
0.684557794350434;
0.6866514883148128;
0.6891958262819617;
0.6913158938594414;
0.693423473678998;
0.6956707734155851;
0.6973213450192216;
0.6987138485242543;
0.7005822796444171;
0.7022410721955868;
0.7037871769071524;
0.7060763008438314;
0.7078968110180414;
0.7108527905652127;
0.7127672204347227;
0.7149087197793169;
0.7166049120521626;
0.7185884837147466;
0.7196562712757653;
]


vQ1 = [5.381890252714272e-19;
1.5648104930919258e-10;
0.02225698195215903;
0.08047764297745028;
0.17135142676575543;
0.29405353386805;
0.4484368694783147;
0.6257449402380733;
0.8047919319770888;
1.0037767063450014;
1.22292378331588;
1.352687007834318;
1.5368875845609606;
1.7471947492160929;
1.8730299894148172;
2.0268034760264464;
2.21027735358998;
2.323802234954883;
2.4540320790960393;
2.5528930527990013;
2.6462470930943742;
2.7323097768310367;
2.834699662098452;
2.9460775420998515;
3.0207930613050085;
3.1242289386353126;
3.2056567650234347;
3.269734965520243;
3.342641065891081;
3.4106993536982544;
3.447647328937385;
3.4942782926664324;
3.528826801975417;
3.504600505715828;
3.598351784187097;
3.5888853582014697;
3.645757370933783;
3.689961708399755;
3.633934585655118;
3.7206257315009026;
3.727964161370056;
3.7391687816382952;
3.8328607773936643;
3.796491591015983;
3.7543734413784398;
3.7722518945954677;
3.823617170253194;
3.7489138498438987;
3.7857919329901732;
3.85113530041904;
3.7847099137374673;
3.782345641654328;
3.8504254804380578;
3.775151518239581;
3.8745027014470192;
3.873223699825091;
3.8221295453864643;
3.850523142388307;
3.7923220888630738;
3.841221741240702;
3.8191159009413362;
3.8554505865276743;
3.87437968589856;
3.8224616131743163;
3.8015435352669447;
3.8047258390770087;
3.72831206814714;
3.728102476547441;
3.6954810283479835;
3.6629152938306375;
3.7253212968945193;
3.6770650488529832;
3.6390709814207645;
3.627951140371135;
3.604168471168289;
3.6419063305521715;
3.618830428481889;
3.630666826072645;
3.5649176991624763;
3.5543366843698867;
3.5710928434681777;
3.5474290386745557;
3.521656102251396;
3.530669381135138;
3.4926611534066185;
3.4539464763520784;
3.389987532005331;
3.345097829564717;
3.3326224908178443;
3.297014139661354;
3.248663885210118;
3.317803041719247;
3.3280346559187852;
3.2506801388480495;
3.32190930039696;
3.316654621042852;
3.3474079261643195;
3.3988827439960994;
3.4131656928722363;
3.3314317246432292;
3.30593149223586;
3.1958832196342177;
3.09089596028593;
3.0497449031703043;
2.936258366957189;
2.9021758580675754;
2.883600740378024;
2.8663236713935727;
2.972261641889984;
2.977995266640987;
2.9260719127284918;
2.8769364974680114;
2.7760405855621753;
2.7224594619318503;

]
#


#= 
mQ1 = mQ1[1:30]
vQ1 = vQ1[1:30]
 =#

# Time step duration
tau = 0.001
jump = 10

ttotal = nt * tau  # Total time evolution
#time_steps = collect(0:10*tau:ttotal)

time_steps = collect(0:lastindex(mQ1)-1) * 5 * jump* tau

# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0, stop = maximum(time_steps), length = 5)
yticks1 = range(0, stop = 6, length = 5)
yticks2 = range(0, stop = 60, length = 5)
#= 
xtick_labels = [L"\$" * string(round(x, digits = 2)) * "\$" for x in xticks]
ytick_labels1 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks1]
ytick_labels2 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks2] =#

xtick_labels = [string(round(x, digits = 2)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]


p1 = plot(time_steps, mQ1, xaxis = L"t", yaxis = L"\langle Q \rangle", 
xtickfont = font(12), ytickfont = font(12), xticks = (xticks, xtick_labels),# yticks = (yticks1, ytick_labels1), 
xguidefontsize=18,yguidefontsize=20, color = :brown,
seriesalpha = 0.9, linewidth = 6, label = L"\ \alpha = 0.1")


plot!(twinx(),time_steps, vQ1, line = :dot, color = :brown, ytickfont = font(12),
seriesalpha = 0.9, linewidth = 6, label = false, yguidefontsize=20, yaxis = L"\langle\langle Q^2 \rangle\rangle")

plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
#plot!(legend = :outertopright)

title!(L"\epsilon = 1, \Delta = 0, T = 0.1, \omega_C = 5, |1\rangle")

#ticks_length!(tl=.04)

# Customize plot appearance, place legend inside
plot!(legend = :right, grid = false, legendfontsize = 16)

display("image/png", p1)
