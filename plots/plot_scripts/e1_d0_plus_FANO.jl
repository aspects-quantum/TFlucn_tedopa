

using DrWatson, Plots, LaTeXStrings

#GR()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


#T = 0.01, alpha = 0.5, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 12;

mQ1 = [0; 0.03841005356687807;
0.14686462157712626;
0.30777945537135754;
0.49920650801011807;
0.7009170575709426;
0.8983545683864623;
1.0821859092827897;
1.2477885612668866;
1.3943517961110423;
1.5217804696887434;
1.6320489890404337;
1.7279422624575644;
1.8113179094567964;
1.8834678734040056;
1.946116324679857;
2.0015176188175676;
2.0498557385334473;
2.090750532732996;
2.127420293154871;
2.160358825977795;
2.186483675287454;
2.21098687506732;
2.2762378934288687;
2.2535328309765976;
2.2672230264452695;
2.28495873195419;
2.2992600911964027;
2.2931103096076373;
2.3342912838752303;
2.3290024273487364;
2.336808955143919;
2.3531324422921123;
2.3569476931855213;
2.366125210853806;
2.3700841109603723;
2.3742653544169547;
2.371065216711606;
2.3642221675344333;
2.3709170531584878;
2.3812254694755985;
2.3876738337008847;
2.3922736205839366;
2.398436200233744;
2.4067310431681896;
2.4180248729081715;
2.419402723159677;
2.4258293657630055;
2.426682500919342;
2.4293948762036606;
2.431151316686351;
2.4328159655395716;
2.4365468623749624;
2.4359327356879463;
2.435437536321621;
]
vQ1 = [0; 0.5671251842264959;
2.1363291792616965;
4.328919679655172;
6.721322970823623;
9.028028433283927;
11.055449350670422;
12.718389424467794;
14.049801903571206;
15.114716331868845;
15.918339161417418;
16.539400186784345;
17.034897699279036;
17.373538014869027;
17.640876267304474;
17.806620049329847;
17.984428451610817;
18.15050281950623;
18.25123194644664;
18.340150178463283;
18.36050672688766;
18.36257639885574;
18.384409151508176;
19.128192992691122;
18.349264350611413;
18.315269321527673;
18.31873764988013;
18.11669133751424;
17.754030496723807;
18.72306818682729;
17.994289489420833;
17.93413520004542;
18.021346816361355;
17.679668500324702;
17.90070298351313;
17.578326595205773;
17.43541670406494;
17.12805241084381;
17.10657768515711;
17.208635063581326;
17.659918546744844;
17.711573206627644;
17.69443750294204;
17.734341230360243;
17.53970164900784;
17.447165988097545;
17.129577715199275;
17.04630758539691;
17.122633465905224;
16.799889067221603;
16.80118322935168;
16.19297228784562;
16.17705395178781;
16.02300677307364;
16.68303583040874;
]
#


# T = 0.01, alpha = 1.5, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 12;
mQ2 = [0;
0.11527472952076645;
0.44059904883902457;
0.923332793246479;
1.4975591621410824;
2.1032075215837427;
2.6951003438350583;
3.2457049036305436;
3.7416080060312784;
4.18010918603795;
4.566356864227117;
4.8937504189306695;
5.17899215887256;
5.423740362347365;
5.6352384422223745;
5.817503814777362;
5.9742533814796515;
6.110395614725393;
6.2277902912734495;
6.329441530499122;
6.419241301123806;
6.495961607712043;
6.563422701856094;
6.620971752855503;
6.67435164510846;
6.720792683777274;
6.7610895329172385;
6.79453527611924;
6.827486204567353;
6.855023676168378;
6.877075690616271;
6.895572216609952;
6.90212502147282;
6.924299166402804;
6.9573485592686275;
6.95168854397965;
6.962220324520073;
6.969182755263568;
6.981528374570481;
6.998744935284984;
7.011805016951626;
7.0225039830520615;
7.028813045981755;
]
vQ2 = [0; 
1.7463009241265657;
6.5397229259727085;
13.550532188333449;
21.70631537078599;
30.07540602733217;
37.996368650048645;
45.15785196431086;
51.43369147237114;
56.85334549796795;
61.53940058985018;
65.26830425783672;
68.51994562022693;
71.27110771077149;
73.50595959633263;
75.53624768394855;
77.19790649181351;
78.6857106179504;
79.89040790884039;
80.85323763812457;
81.80295778265712;
82.74692195545468;
83.38441355929294;
83.74690709067359;
84.13912516481459;
84.54042399508144;
85.1247830430929;
85.36739844330727;
85.70462349487514;
86.05523918482935;
85.91152843598265;
85.77701653971481;
85.4954636970357;
85.87178347430353;
86.30305868609278;
85.71000020287676;
85.46664871709126;
85.59601538592992;
84.97227815289196;
85.47803808924452;
85.55785291011875;
85.7962269609674;
86.17803064614483;
]
#


mQ1 = mQ1[1:43]
vQ1 = vQ1[1:43]
mQ2 = mQ2[1:43]
vQ2 = vQ2[1:43]


# Time step duration
tau = 0.005
nt = 250
ttotal = nt * tau  # Total time evolution
#time_steps = collect(0:10*tau:ttotal)

time_steps = collect(0:lastindex(mQ2)-1) * 5 * tau

# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0, stop = maximum(time_steps), length = 5)
yticks1 = range(0, stop = 6, length = 5)
yticks2 = range(0, stop = 60, length = 5)
#= 
xtick_labels = [L"\$" * string(round(x, digits = 2)) * "\$" for x in xticks]
ytick_labels1 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks1]
ytick_labels2 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks2] =#

xtick_labels = [string(round(x, digits = 2)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]


p1 = curves(time_steps, vQ1./mQ1, xaxis = L"t", yaxis = L"F", #yaxis = L"\frac{\langle\langle Q^2 \rangle\rangle}{\langle Q \rangle}", 
xtickfont = font(20), ytickfont = font(20), xticks = (xticks, xtick_labels),
xguidefontsize=28,yguidefontsize=28, color = :lightblue,
seriesalpha = 0.8, linewidth = 8, label = L"\ \alpha = 0.5")
plot!(time_steps, vQ2./mQ2, color = :coral,seriesalpha = 0.8, linewidth = 8, label = L"\ \alpha = 1.5")

plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
#plot!(legend = :outertopright)
annotate!(-0.1, 3, Plots.text(L"Force (F)", 15, :black, rotation=90))
#title!(L"\epsilon = 1, \Delta = 0, T = 0.01")
plot!(titlefontsize = 20,size=(550, 400))

ticks_length!(tl=.02)

# Customize plot appearance, place legend inside
plot!(legend = :right, legendposition=(0.7, 0.4), grid = false, legendfontsize = 20)

display("image/png", p1)
safesave("plots/fano.png",p1)