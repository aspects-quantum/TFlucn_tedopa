using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(;tl=0.02)
    p = Plots.current()
    xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
    xl, yl = Plots.xlims(p), Plots.ylims(p)
    x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
    sz = p.attr[:size]
    r = sz[1]/sz[2]
    dx, dy = tl*(xl[2] - xl[1]), tl*r*(yl[2] - yl[1])
    plot!([xticks xticks]', [y1 y1 .+ dy]', c=:black, labels=false)
    plot!([x1 x1 .+ dx]', [yticks yticks]', c=:black, labels=false, xlims=xl, ylims=yl)
    return Plots.current()
end
# Define data


T = 0.1
α = 0.5

# T = 0, alpha = 0.1, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;

mQ1 = [1.1548289194346837e-10;
0.0003120066328231101;
0.010988441634399096;
0.03510680762979128;
0.06878226688970603;
0.10775388778786078;
0.1483002897657531;
0.18708027226396692;
0.2232064037376123;
0.25566161753916233;
0.2842526784069933;
0.30940410592089534;
0.3312218836552533;
0.35023510324383667;
0.3668965575602423;
0.38162123500430595;
0.39448260167444754;
0.4053872621154928;
0.4148079052848426;
0.4230477847178284;
0.43004908882744225;
0.4367979096234406;
0.4429907738504922;
0.44736008954582884;
0.4526291824913432;
0.45745338401469443;
0.4616871493264878;
0.46573889318876244;
0.46933914635266333;
0.4726285588516753;
0.47561473226252826;
0.4786240736024611;
0.4816900129063305;
0.48463623111105764;
0.48760153190358885;
0.4907350983944678;
0.4940604505325087;
0.4957741402277561;
0.49829185428067235;
0.5016008041844393;
0.5035923894714975;
0.5072628038625253;
0.5092023339295692;
0.5096685323671432;
0.5085039210458027;
0.5119114526007742;
0.5142886510781237;
0.5163100877976441;
0.5182913231707477;
0.5149499751283063;
0.5168067640756963;
0.5168455299633741;
0.519380328945347;
0.5230625035312582;
0.5273759939982634;
0.5313698510384599;
0.5324657134538897;
0.5328654450543308;
0.5332130430245545;
0.5325638655029151;
0.5334872404073816;
0.5360160810315325;
0.5381721233978026;
0.541678134419145;
0.5448678031850839;
0.5470803222875193;
0.5455602841428356;
0.5438826239238467;
0.546487962016705;
0.5515262997276145;
0.5526968048774881;
0.5544240137234242;
0.5574134453966326;
0.5600415253717577;
0.5618312278545797;
0.563107857459735;
0.5622176900984437;
0.5626298225756812;
0.5646312633967818;
0.5664847920553518;
0.5686020126727196;
0.5703268889256933;
0.5722424930770469;
0.5722448138899889;
0.5740754101414259;
0.5750834166306873;
0.5783137886277601;
0.580375599235344;
0.582626762033195;
0.5819194885848572;
]


vQ1 = [1.316148913939056e-20;
9.740525905711966e-8;
0.16236435732124363;
0.502355944139672;
0.9409905990755112;
1.3941483729853192;
1.8070561455917493;
2.138830656067847;
2.400611658289239;
2.595311910418992;
2.7328090923771016;
2.838468472777996;
2.9030724606101814;
2.9527858471205604;
2.9984414771936456;
3.049872726235353;
3.040668437683771;
3.032236370681957;
3.0330621004013105;
3.033041816257962;
3.0155227516220577;
3.000509301994374;
2.979393067482374;
2.960931203088789;
2.954967159035859;
2.9598621843564943;
2.9408652284298995;
2.9053274615913933;
2.9067298358475377;
2.8836213379886764;
2.8381961226345527;
2.8249143998850967;
2.8258486276900654;
2.833255859435108;
2.8252915650011445;
2.819992220313522;
2.8307617494871873;
2.815485857234638;
2.807103963234848;
2.8115050515091697;
2.7957759886669034;
2.7464461143520733;
2.7386640067967525;
2.667417333540646;
2.6676017391595215;
2.714545986754626;
2.5196616304329904;
2.494442315703144;
2.5043524909511583;
2.2771230364291752;
2.184116047587022;
2.2104547045274905;
2.2512132540707186;
2.312746716346103;
2.2660590583662787;
2.4017574395359977;
2.35414772088866;
2.2954851348945637;
2.378894757440052;
2.3538081009047964;
2.209228624644762;
2.2754739002880604;
2.09122697979087;
2.0896978428963595;
2.134769753455159;
2.1564869090332714;
2.148877809987007;
2.2835411916755124;
2.451532046067383;
2.6321987481786913;
2.581853840577162;
2.47053236970204;
2.430902210223068;
2.4603339424004784;
2.4448323040980218;
2.4262822656858734;
2.4527614587624686;
2.4828793576677417;
2.3308650498417705;
2.3258203103946973;
2.445635750750618;
2.601499981523181;
2.50867641141951;
2.5723741356456222;
2.6988804087020783;
2.6591716263484058;
2.9082149299930866;
3.0114297418773264;
2.871714334720358;
2.491052115721441;

]
#

# T = 0, alpha = 1.5, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;
mQ2 = [2.4292158838401497e-10;
0.0046799828250777085;
0.16482678771973344;
0.5265580201407486;
1.0330182808866737;
1.6178969357605857;
2.2238196508644723;
2.8092266880836285;
3.3495715522196865;
3.834020550656686;
4.258576460052674;
4.636559118728705;
4.954497019954804;
5.2313329263229384;
5.469209772812501;
5.674007499900834;
5.8510085929372195;
6.003766257216114;
6.135702847410954;
6.250515265853334;
6.350243119945167;
6.43640891032271;
6.510810386176094;
6.577169579510763;
6.635138893195992;
6.683791155192243;
6.728594176860648;
6.76763508343988;
6.801467642116731;
6.831002564905481;
6.858061607948677;
6.882450321655193;
6.903768631239244;
6.922768932843405;
6.939224754249358;
6.955262650616948;
6.967981096659928;
6.979681778401206;
6.992975260901645;
7.000888019816955;
7.0150057675924025;
7.025965202425522;
7.035844521697417;
7.045748906968221;
]

#T = 0, alpha = 1.5, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;

vQ2 = [6.367301730915374e-20;
2.1914029432656162e-5;
2.4608508356961396;
7.8002137770964275;
15.130750435307947;
23.38467446426539;
31.6932787531177;
39.51367174098088;
46.499071452011734;
52.642291780279734;
57.70517226975717;
62.31069811657466;
66.00824057388694;
69.21501685350141;
71.64744648661784;
74.07400916028;
75.98008466897875;
77.60343290192013;
78.90639718855634;
80.07910721726628;
81.0798758683694;
81.97533175135142;
82.7727447632775;
83.19512418487638;
83.73081243670603;
84.11794264323704;
84.53365170460795;
84.9086035593829;
85.18387650909393;
85.30335996721193;
85.4832781910568;
85.6823687956303;
85.78416260464535;
85.94053055837702;
86.06679523146508;
86.14411458177793;
86.17885777000124;
86.27364800429943;
86.29380450887899;
86.25046001454966;
86.44347325987412;
86.50620112666128;
86.571057798801;
86.7389472538032;
]

# T = 0, alpha = 1.5, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, jump = 5, omega_C = 5, boson_dim = 13;
Sx2 = [0.5000000000000079;
0.4999937539153088;
0.4997788975180781;
0.4992608400104756;
0.4984682694772785;
0.4974238988186841;
0.4961715698239579;
0.49474481233133827;
0.4931870233412073;
0.49153918159946874;
0.48984072023888736;
0.4881272217767965;
0.48642747101466566;
0.4847715979701658;
0.4831820321147927;
0.4816713648177493;
0.48025288020973655;
0.47893338744139;
0.47771379867712604;
0.476594339459994;
0.47557395791521373;
0.47464589446634375;
0.47380551114060365;
0.473047023539649;
0.4723633889130105;
0.47174972805520154;
0.47120129084630585;
0.4707091044035708;
0.4702690286716751;
0.4698745028980611;
0.4695221171607096;
0.46920673923851286;
0.4689245135551995;
0.46867209546444905;
0.46844539748823727;
0.4682415266568821;
0.46805912406845707;
0.467895168019274;
0.4677481062877179;
0.46761533701007424;
0.4674961857577548;
0.4673869431703433;
0.4672893105305494;
0.46720214426077733;
0.46712311251426475;
0.4670522564552928;
0.4669878074354127;
0.4669304825733517;
0.4668785991856271;
0.46683122935528476;
0.4667906220681778;
0.46675396321288354;
0.4667230364584213;
0.4666947101907133;
0.4666717241991862;
0.46665136038489724;
0.46663463494364965;
]

vQ1 = vQ1-mQ1.^2
vQ2 = vQ2-mQ2.^2

#T = 0.1, alpha = 0.1, N_chain = 140, maxdim = 80, cutoff = -12, tau = 0.005, omega_C = 5, boson_dim = 13
Sx1 = [0.5000000000000049, 0.49999375000884616, 0.4997750114096665, 0.499243894845025, 0.49840067919015835, 0.49724583162181174, 0.49578002554877576, 0.4940041558316804, 0.4919193450078589, 0.489526939261012, 0.48682850050759024, 0.48382579919205215, 0.48052080751317144, 0.4769156934979441, 0.47301281608394313, 0.4688147209336683, 0.46432413701464853, 0.4595439738604841, 0.4544773185232597, 0.4491274323671829, 0.4434977487559385, 0.4375918709026867, 0.4314135689252135, 0.42496677726235793, 0.4182555919176641, 0.41128426810797725, 0.40405721740985956, 0.39657900453164674, 0.38885434460709595, 0.38088810039312815, 0.37268527830650017, 0.3642510245503621, 0.3555906218392964, 0.34670948665765816, 0.3376131668663738, 0.32830466744898357, 0.3187883719693899, 0.3090742092504785, 0.2991682658402052, 0.28907674631352204, 0.2788059693189579, 0.26836236368822486, 0.2577524636922533, 0.24698290485096727, 0.23606042076669906, 0.224991840058216, 0.2137840822527943, 0.20244415298132382, 0.19097910462616013, 0.17939610720948254, 0.16770240766357963, 0.15590531713536654, 0.1440122118502319, 0.13203052718578834, 0.11996775165355744, 0.1078314212083498, 0.09562911317361736, 0.08336844078412335, 0.07105705325816995, 0.058702624292822546, 0.04631284841678223, 0.033895447925575445, 0.02145816538449029, 0.009008756178538758, -0.0034450176277735067, -0.015895391651703294, -0.028334602533512724, -0.04075488720027326, -0.053148499748838444, -0.06550772903087866, -0.07782487696865446, -0.09009225442349124, -0.10230223695216538, -0.11444722175190579, -0.12651963982707604, -0.13851197898322107, -0.1504167691193881, -0.1622265928148798, -0.17393409998636605, -0.18553200405823309, -0.19701307976128166, -0.20837018146453845, -0.21959623862275268, -0.23068427392802998, -0.24162738919279228, -0.252418764190418, -0.2630516797161766, -0.2735195215970241, -0.2838157749887444, -0.2939340267937767, -0.30386798824770417, -0.31361147340704904, -0.3231584236896173, -0.3325028929419258, -0.3416390694579, -0.3505612658399568, -0.359263930736851, -0.36774164198533865, -0.3759891369252137, -0.38400127178777205, -0.39177307510361153, -0.39929971122001756, -0.40657650181752836, -0.4135989061557901, -0.4203625745879222, -0.4268632887720307, -0.43309700799133893, -0.4390598457071554, -0.444748102008491, -0.45015824243410457, -0.45528690457052284, -0.46013090273020685, -0.4646872223154886, -0.46895302585473814, -0.472925669582514, -0.47660267967134035, -0.4799817720487599, -0.48306083989726856, -0.485837987217893, -0.48831149650894506, -0.49047982586757755, -0.4923416363747161, -0.49389577043915606, -0.49514127772951694, -0.4960773905037425, -0.4967035351024764, -0.4970193289920832, -0.4970245632142251, -0.4967192566641297, -0.4961036045454602, -0.4951779809470138, -0.4939429535200918, -0.49239929690847956, -0.490547971468118, -0.48839014582358303, -0.4859271642591885, -0.4831605527905048, -0.4800920268963, -0.4767234974723486, -0.47305705663254966, -0.4690949841505274, -0.464839748895725, -0.4602939961752642, -0.45546055879036706, -0.45034243958595327, -0.4449428223187667, -0.4392650657520665, -0.4333126972330701, -0.4270894291573424, -0.42059914118641634, -0.41384584608385655, -0.40683375122829407, -0.39956720453274736, -0.39205072548526904, -0.38428899374699527, -0.3762868230164264, -0.36804919630295774, -0.3595812458795178, -0.350888231859693, -0.34197555183194006, -0.33284873527102854, -0.32351345863785363, -0.313975536803466, -0.3042409176928854, -0.2943156594208152, -0.28420590647203026, -0.2739179399571442, -0.26345686035209864, -0.2528305509560102, -0.2420456894838187, -0.23110902859183374, -0.2200273687784907, -0.2088076413685217, -0.1974568229971194, -0.18598185796334724, -0.174390106236243, -0.16268898184397293, -0.1508854457059693, -0.1389868399638136, -0.12700058584435456, -0.11493452809075849, -0.10279619006329306, -0.09059321269347796, -0.07833314751719843, -0.066023293711964, -0.05367113603949164, -0.041284388644509735, -0.028870989945405687, -0.01643902086040906, -0.003996451159300348, 0.008448905405286986, 0.0208896231569944, 0.033318266007023006, 0.045727396600398214, 0.0581092261367919, 0.07045577343881684, 0.08275892612739001, 0.09501063042689187, 0.10720319688444324, 0.11932922421339093, 0.13138169935241825, 0.14335347186631356, 0.1552374803530479, 0.1670261482711819, 0.17871190124424605, 0.1902868114765822, 0.20174309855074826, 0.21307386177355037, 0.22427169979241535, 0.23532978416933334, 0.24624234140002924, 0.2570022501057329, 0.26760391554980606, 0.2780403424240258, 0.28830427398660735, 0.2983891747085037, 0.3082881728698208, 0.3179950494440664, 0.3275033903086625, 0.3368065296428878, 0.3459004334221303, 0.35477956694449614, 0.3634384930962582, 0.37187251178932856, 0.38007586449613934, 0.38804340299332407, 0.39576918561974594, 0.4032492062196245, 0.41047748753195484, 0.41744998749405143, 0.4241624609874088, 0.43061020285082446, 0.4367901553599994, 0.44269855612943143, 0.44833175780067097, 0.45368629119268283, 0.45875905915524884, 0.4635462174513484, 0.46804500118375836, 0.47225281677765746, 0.4761663984769162, 0.4797835157056375, 0.4831021819923786, 0.4861190283734615, 0.48883319167247274, 0.4912436374222848, 0.4933482610127558, 0.4951460816622882, 0.49663609939509257, 0.4978166708377555, 0.4986878046818969, 0.4992474707026961, 0.4994960867782775, 0.4994343501340986, 0.4990609854985945, 0.498377164268725, 0.4973832313621855, 0.49607972351845736, 0.49446714163319266, 0.49254650807410555, 0.49031907146379045, 0.48778587921253685, 0.48494971771771184, 0.48181113926996205, 0.47837178812595715, 0.47463417795549423, 0.4706018930782756, 0.4662767618707365, 0.4616615777811039, 0.4567593130785782, 0.45157335750801547, 0.44610668415323845, 0.440362571290012, 0.43434570457932226, 0.4280578739442203, 0.42150321466225626, 0.4146853073243591, 0.4076076980966138, 0.40027438586592046, 0.39269139900742495, 0.3848619633450108, 0.3767917934052314, 0.36848672117817244, 0.35995170816783706, 0.351193157124728, 0.3422172995562723, 0.33303049882457714, 0.3236391790429674, 0.314048696796874, 0.30426502097054037, 0.2942944631616909, 0.2841426532689575, 0.2738149358739822, 0.2633172726954729, 0.25265534028108844, 0.24183467920522506, 0.23086114546158112, 0.21974114057377245, 0.20848152025336755, 0.19708869687925368, 0.18556929921226767, 0.17393163822095448, 0.1621839281142259, 0.1503339042447996, 0.13839017871051928, 0.12636116609727366, 0.11425552739809852, 0.10208170803851532, 0.08984813416560412, 0.07756288103433383, 0.0652338595565856, 0.05286857021675247, 0.04047465039030329, 0.028059185732838825, 0.015629059422958183, 0.0031910119350813883, -0.00924825157296497, -0.021682090624059076, -0.03410376602373215, -0.046506535025569486, -0.058883329353280736, -0.07122704344490516, -0.08353015532773211, -0.0957849241886378, -0.1079835445962544, -0.12011806706339535, -0.13218032738713942, -0.14416148444269436, -0.15605362891859165, -0.16784836066194858, -0.17953756903839466, -0.1911132178163049, -0.20256713314769956, -0.21389086569312046, -0.2250780123796039, -0.23612096690306028, -0.24701307914192683, -0.2577468222081462, -0.26831658070438286, -0.27871622279189046, -0.28893904498667194, -0.29898032827820914, -0.3088339141760706, -0.3184945888206, -0.3279570224223254, -0.3372156543332934, -0.34626447015546746, -0.3550985213723341, -0.3637130423430572, -0.3721025535635299, -0.3802621277024851, -0.38818597034312413, -0.39586879509038364, -0.40330645090384165, -0.41049319697567793, -0.4174242291120218, -0.4240955708377764, -0.4305022631929357, -0.4366397346187058, -0.4425041749668183, -0.44809202872215537, -0.45340013273712576, -0.45842461736202744, -0.4631617190913706, -0.4676094831781045, -0.47176440014315896, -0.47562346420797547, -0.47918505771465475, -0.48244694198584737, -0.48540689582551916, -0.48806396487443787, -0.49041602374055493, -0.4924625782495728, -0.4942016154096323, -0.495631107850346, -0.49675140507413895, -0.4975626248089924, -0.4980626785870339, -0.49825247584488014, -0.4981310190957609, -0.4976981473292223, -0.4969550582912637, -0.49590208732337426, -0.4945394017006998, -0.49286835116479905, -0.49088970776427343, -0.48860541017452086, -0.48601589231323905, -0.4831241652027155, -0.47993195577569503, -0.47644009853739233, -0.4726510785211548, -0.4685670989025135, -0.46419207964046383, -0.4595282569307957, -0.45457845114585144, -0.4493459925757922, -0.4438334890463573, -0.43804437375071814, -0.43198103129717624, -0.4256488999792956]



num = 44
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]


ω_C = 5


# Time step duration
tau = 0.005  


time_steps = collect(0:lastindex(Sx1)-1)*5*tau*ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0.2, stop = maximum(time_steps[end-1]), length = 5)
yticks1 = range(0, stop = 10, length = 4)
yticks2 = range(0, stop = 40, length = 4)
yticks3 = range(0, stop = 12, length = 4)
yticks4 = range(.3, stop = .5, length = 4)

xtick_labels = [string(round(x, digits = 1)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]
ytick_labels3 = [string(round(y, digits = 1)) for y in yticks3]
ytick_labels4 = [string(round(y, digits = 2)) for y in yticks4]

#(collect(0:1:length(mean_Q)-1)*tau)[1:2:end]

p1 = plot(time_steps[1:2:length(mQ1)], mQ1[1:2:end], linewidth=5, xaxis = "", #yaxis = L"\langle Q \rangle", 
xticks = (xticks, xtick_labels), yticks = (yticks1, ytick_labels1),
xtickfont = font(14), ytickfont = font(14), 
xguidefontsize=24,yguidefontsize=22, color = :teal) #, label = L"\  (1, 1.5)")
plot!(time_steps[1:2:length(mQ2)], mQ2[1:2:end], linewidth=5, color = :lightcoral) #, label = L"\ (0.1, 0.75)")
plot!(yaxis=L"⟨Q⟩")
plot!(legend=false)
plot!(widen=false)
vline!([xlims(p1)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p1)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)





p2 = plot(time_steps[1:2:length(vQ1)], vQ1[1:2:end], linewidth=5,  color = :teal, seriesalpha = 1, xaxis = "") #, label = L"\  (1, 1.5)")
plot!(time_steps[1:2:length(vQ2)], vQ2[1:2:end], linewidth=5, color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),  yticks = (yticks2, ytick_labels2),
seriesalpha = 1, xguidefontsize=24,yguidefontsize=18)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel=false)
vline!([xlims(p2)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p2)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)

#plot!(legend = :outertopright)
#plot!(legend = (.6,0.7), grid = false, legendfontsize = 13) #, left_margin = [2mm 0mm], right_margin = [0mm 3mm], bottom_margin = [3mm 3mm])   #,framestyle = :box), legendposition = (1.6, 0.7)

#ticks_length!(tl=.02)

p3 = plot(time_steps[2:2:length(vQ1)], vQ1[2:2:end]./mQ1[2:2:end], color = :teal, seriesalpha = 1, xaxis = "", linewidth = 5) #, label = L"\  (1, 1.5)")
plot!(time_steps[2:2:length(vQ2)], vQ2[2:2:end]./mQ2[2:2:end], color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),  yticks = (yticks3, ytick_labels3),
seriesalpha = 1, linewidth = 5,xguidefontsize=24,yguidefontsize=22)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"F")
vline!([xlims(p3)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p3)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)


#############
p4 = plot(time_steps[1:2:length(Sx1)], Sx1[1:2:end], color = :teal, seriesalpha = 1, xaxis = "", linewidth = 5,  yticks = (yticks4, ytick_labels4)) #, label = L"\  (1, 1.5)")
plot!(time_steps[1:2:length(Sx2)], Sx2[1:2:end], markersize=6, markerstrokewidth=1, color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),
seriesalpha = 1, linewidth = 5,xguidefontsize=24,yguidefontsize=22)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"S_x")
vline!([xlims(p4)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p4)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)




p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png",p)

