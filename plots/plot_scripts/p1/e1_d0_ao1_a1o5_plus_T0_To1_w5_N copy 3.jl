using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


T = 0.1
Î± = 0.5

# T = 0, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 11, omega_C = 5, jump = 10;

mQ1 = [1.8405812081189988e-10;
	0.0001250064108894105;
	0.01494065208608288;
	0.05277934360044519;
	0.10943664547513685;
	0.17956513299568533;
	0.2575609055189282;
	0.3384026116898393;
	0.4187429399590482;
	0.4941581437575594;
	0.5652784887039901;
	0.6304741928723817;
	0.6893231900490155;
	0.7427717781517547;
	0.7902835266323109;
	0.8334036095621097;
	0.8716374513814449;
	0.9062542182107779;
	0.9365135449422374;
	0.9634496559192202;
	0.9870589069838109;
	1.0089910398170652;
	1.0293798703350356;
	1.0450664048415181;
	1.060777617117483;
	1.0759879015841012;
	1.088874227624748;
	1.101007419982707;
	1.1165924870972648;
	1.1276321782330956;
	1.1379861017450912;
	1.1470203181795056;
	1.1532541089106636;
	1.1609293312125324;
	1.1684202200412523;
	1.1754963710192057;
	1.1824353416139533;
	1.1888043896543783;
	1.1946277503989569;
	1.2005031159738888;
	1.2054993724568923;
	1.2102306029070469;
	1.2149621226324812;
	1.2190453266681107;
	1.2230464720388372;
	1.2263574388617076;
	1.2309904416449027;
	1.2348232849139211;
	1.23822610540554;
	1.2412104049623789;
	1.244418954145979;
	1.247295317309231;
	1.2500046805647043;
	1.2529533768623593;
	1.255746444047463;
	1.2586472411475962;
	1.2606942677492505;
	1.2627219844081496;
	1.264908572915064;
	1.2666743725170961;
	1.2685216618061546;
	1.2710386943038252;
	1.2726314463720823;
	1.2749269291632916;
	1.2771533732193838;
	1.279275741797773;
	1.2819221459886772;
	1.2840224908522007;
	1.2855243620166519;
	1.2869738634326353;
	1.2879144144148822;
	1.2894531053493536;
	1.2899731577785964;
	1.2913586091755056;
	1.2928493795619023;
	1.294197156072127;
	1.296145343390103;
	1.2977326803352873;
	1.2992315559014949;
	1.2998335941677015;
	1.3003928146987764;
	1.3014653741322804;
	1.3020705747661094;
	1.3025170880851262;
	1.30364698931601;
	1.3046884055090384;
	1.305893591551506;
	1.3069464347640383;
	1.3076354704223203;
	1.3078911978762633;
	1.308622709628375
]


vQ1 = [2.388012295509135e-21;
	1.0962176467827036e-11;
	0.22226779899688334;
	0.7689605765289165;
	1.5454429711213857;
	2.4349901301247976;
	3.3319835566934977;
	4.159413573907889;
	4.878809642762786;
	5.463425059656779;
	5.930415546689885;
	6.287881389885476;
	6.550029402798663;
	6.739656089478035;
	6.8686396964418845;
	6.969533766236356;
	7.034298189167698;
	7.0825144237258675;
	7.09218382905461;
	7.107908192951239;
	7.105868935206357;
	7.1040143452194755;
	7.135353043395648;
	7.0958232780138495;
	7.019626204758704;
	6.964164746444448;
	6.877792717994686;
	6.80450657837212;
	6.802713572645995;
	6.751421973677694;
	6.719567498215516;
	6.679209152180881;
	6.587909046854928;
	6.506494511139;
	6.483101691454682;
	6.4547773379681255;
	6.47504271718884;
	6.435296267847235;
	6.4241818779686835;
	6.436691209170958;
	6.390489825248273;
	6.347171247780086;
	6.326882620857347;
	6.285476862927391;
	6.241912729027859;
	6.146558808186752;
	6.143313703362571;
	6.170596285023927;
	6.127426710800677;
	6.0436976570521965;
	6.043863114724729;
	6.009283215747681;
	5.934907555377326;
	5.922303044312204;
	5.920435533518504;
	5.889835821992295;
	5.879871915580752;
	5.845003389549144;
	5.794948833388687;
	5.748704694598329;
	5.711934365562274;
	5.736820815391525;
	5.701328315461925;
	5.683114886874477;
	5.704713150730175;
	5.695003581332782;
	5.7589521348342965;
	5.768445794478453;
	5.7391347482131;
	5.678812468470714;
	5.640809180104151;
	5.591644585199991;
	5.494971983829895;
	5.516715800048563;
	5.580703578049837;
	5.521597318487775;
	5.546808868560515;
	5.519079580818103;
	5.542721025654048;
	5.505447092813535;
	5.4630750193018205;
	5.465350791474617;
	5.462030042284525;
	5.374639359145459;
	5.426424785690702;
	5.363041251517956;
	5.360086108833599;
	5.409943385206222;
	5.428667762923505;
	5.343840212704828;
	5.357210259661553
]
#

# T = 0, alpha = 1.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 14, omega_C = 5, jump = 10;

mQ2 = [2.8894128382948843e-11;
0.06187912884709622;
0.24035421237283222;
0.515918956146334;
0.8617051839254265;
1.249279935318054;
1.6532501090543334;
2.0537636218267608;
2.43707246541452;
2.7948525750372224;
3.122990726774787;
3.4203244800425785;
3.6875769909157308;
3.9265580962424527;
4.139613665839143;
4.329271619877786;
4.498029929387864;
4.6482404147698935;
4.782053346091607;
4.901399230413898;
5.007991030149298;
5.103338210642029;
5.188765940141513;
5.2654344409442455;
5.334360010411248;
5.3964320315819805;
5.452429573825515;
5.503036071345296;
5.548851496480675;
5.59040305666133;
5.628155008322075;
5.662516724310599;
5.693849080042178;
5.722471837547141;
5.748667452582238;
5.772686124899712;
5.794749248781278;
5.815053377522572;
5.833772453695711;
5.85106178960729;
5.86706065993489;
5.881892793188629;
5.895667442880774;
5.908482506445515;
5.920424604562705;
5.931572677133416;
5.941997224400479;
5.951761462232937;
5.960921729560374;
5.969528636412311;
5.977628660832965;
5.985263420948199;
5.992469476592207;
5.9992814017429925;
6.005729297080392;
6.01184006755816;
6.017638051218058;
6.023145425350341;
6.028382479285916;
6.033368663026428;
6.0381213532468365;
6.042656048274448;
6.046986658789236;
6.051126520076065;
6.055087169971459;
6.058879785271123;
6.062514512492771;
6.066000972792535;
6.069347608441013;
6.072563050536685;
6.075654982538625;
6.078630478791396;
6.0814966546237095;
6.084259035718132;
6.0869233658506205;
6.0894945158678;
6.091976406000259;
6.094373004548739;
6.096688287651756;
6.0989252537411645;
6.101086908935746;
6.103176616727531;
6.105197777825383;
6.107153730576589;
6.1090479316798945;
6.110883788534851;
6.112664104097124;
6.114390632540374;
6.116066361496573;
6.117693575765265;
6.119273693537884;
6.120808863854412;
6.1223012656944125;
6.123752529972794;
6.125163481733405;
6.126535567981116;
6.127869878379971;
6.129167244447997;
6.130429497670059;
6.1316585418338;
6.1328560021391345;
6.134022793590728;
6.135159550564694;
6.13626739540127;
6.137347618256116;
6.1384018409991885;
6.139431591967128;
6.140437671170815;
6.141420134687098;
6.142378982531328;
6.143314030135853;
6.144226017088013;
6.1451156519609444;
6.145984342480989;
6.146833337270436;
6.147663364057331;
6.148474397606521;
6.149267157881545;
6.150042343038042;
6.150801643622089;
6.151546668066067;
6.152277694197412;
6.152994003734176;
6.153694900216496;
6.154379461668257;
6.155047767998378;
6.1557004083243045;
6.1563380071367355;
6.156961382913768;
6.157571031586237;
6.158167033063551;
6.158749854141539;
6.159320406898987;
6.1598795871917655;
6.160428449803054;
6.1609676472822015;
6.161497644382809;
6.16201862139264;
6.162530377854433;
6.163032902980524;
6.163526587110211;
6.164012552945652;
6.164492107598301;
6.164966049144555;
6.165434240748237;
6.165895477274182;
6.166347810148912;
6.166789934707361;
6.1672212228393875;
6.167641336195615;
6.168050591826122;
6.16845053497125;
6.1688438224807305;
6.169232567484457;
6.169615584931428;
6.169989746330732;
6.170357232578768;
6.170725296679078;
6.171091393297661;
6.171439412563755;
6.171768341010467;
6.17211133026988;
6.172488525568422;
6.1728505290610185;
6.173128283458991;
6.173353487490634;
6.173659803223999;
6.174107233499964;
6.174551144955997;
6.174776560196408;
6.174786629380522;
6.17488069135347;
6.175356057004563;
6.1761264170859205;
6.176711998009495;
6.176691617730472;
6.176189192184337;
6.175872925286525;
6.176388289889079;
6.177708752514074;
6.179023781379132;
6.179339539328615;
6.178336806693622;
6.176767364248733;
6.176008548662049;
6.177047614059921;
6.179644881927228;
6.182331865281451;
6.183319615984365;
6.1817320796235435;
6.178333167887245;
6.17521585049312;
6.174594694090427;
6.177418418779116;
6.182649956502779;
6.187682630798656;
6.18969861688245;
]

#T = 0, alpha = 1.25, N_chain = 190, maxdim = 90, cutoff = -11, tau = 0.001, boson_dim = 15, omega_C = 5, jump = 20;

vQ2 = [4.018863001724452e-7;
0.9220743603166695;
3.512918586883069;
7.31307677903506;
11.738233530071344;
16.24426267722294;
20.43073306878706;
24.06781477929203;
27.070196485677734;
29.4507186251964;
31.27603172801369;
32.634183023107795;
33.61476377350288;
34.298725084625886;
34.754510558941455;
35.03763605208985;
35.19192359257863;
35.25139069121159;
35.242112939042556;
35.18390699210552;
35.09171063079096;
34.976744148845754;
34.84740271866782;
34.70986892963633;
34.56868843356919;
34.42719157389167;
34.287754079219525;
34.15202504403986;
34.021106518962;
33.895722161918904;
33.776279282519795;
33.66297628495991;
33.55582850993397;
33.45472870355278;
33.35952996895713;
33.27002216802054;
33.18593233753688;
33.10695981120514;
33.03281175127026;
32.96319942196113;
32.89783305413769;
32.836437084716074;
32.77873467561229;
32.724457502422744;
32.67335755524691;
32.62522559042699;
32.57985024451821;
32.537031792726864;
32.49657586320125;
32.45831489201446;
32.42210371942582;
32.38780805593247;
32.35529758895931;
32.32444754633199;
32.29514076503877;
32.26727544242282;
32.240743763082534;
32.215443589122444;
32.19129847059482;
32.16827018905855;
32.14627667027911;
32.12525643327301;
32.105142258679514;
32.08585911615434;
32.067354104152756;
32.049591628522734;
32.03253059248674;
32.016129098547765;
32.00035111618478;
31.98516687080157;
31.970504028207856;
31.956348655497656;
31.942714648052764;
31.92962601302424;
31.917034908481455;
31.90490848727898;
31.89322491849105;
31.881951624583692;
31.871053680980616;
31.86047098601273;
31.850198971315983;
31.840225911125337;
31.83052736550541;
31.821096009338028;
31.8119472997505;
31.803079136006353;
31.79447618513131;
31.786128161517787;
31.778035757980604;
31.77018859552154;
31.762544238109555;
31.75510234919959;
31.747892572218973;
31.740908350703364;
31.73412294802838;
31.72750596546617;
31.721051377459503;
31.71473324526962;
31.708550136859927;
31.702508743566334;
31.69662848008688;
31.69091544196766;
31.685345244169064;
31.67988463643008;
31.674530704162187;
31.669325248705775;
31.664285999384354;
31.659407306651445;
31.65466920654675;
31.650029889172224;
31.64549158359472;
31.641030571360425;
31.636653107535693;
31.63236384696763;
31.628161363008886;
31.624056995121116;
31.620043037351806;
31.616105874449282;
31.612230254714106;
31.608480691923965;
31.60490099303115;
31.601467223997233;
31.598142593402287;
31.594887147649956;
31.591653263246577;
31.588429157512245;
31.585220840236275;
31.58206737198058;
31.578980358039203;
31.575955713274205;
31.572974371646453;
31.570019911945025;
31.567092671813775;
31.564210965809863;
31.5614015607158;
31.558660701970155;
31.556000766052513;
31.55343319370271;
31.550930616790822;
31.548470361373845;
31.5460484208838;
31.543678762298967;
31.541403923646712;
31.53925858893637;
31.53721723696333;
31.535248557180736;
31.533309706062205;
31.5313534436036;
31.52935001123248;
31.527289217320764;
31.525158026401236;
31.522995446576402;
31.520903890417074;
31.518993700136086;
31.51718448039737;
31.515210319614198;
31.513141511816194;
31.511539781370793;
31.510427250423206;
31.50860050616769;
31.50554590348051;
31.503391136550356;
31.50416956632867;
31.505224988895755;
31.50150874180415;
31.493853363636298;
31.490489438871336;
31.496532396016512;
31.504577341206435;
31.50119853306802;
31.48426500663335;
31.46955883685652;
31.475223577924893;
31.499539767364183;
31.51804001679126;
31.506470060027986;
31.467585945779376;
31.433600032957806;
31.438813191145925;
31.48623618075475;
31.539613106054006;
31.550492660118394;
31.499202825926815;
31.415649782189575;
31.361303908834557;
31.38407545243107;
31.47949074107759;
31.588021586208406;
31.632505732974877;
31.570727645668356;
31.42764085313999;
31.28498466559101;
31.23357547000125;
31.317220742487187;
31.50244156737555;
31.692702364487864;
31.779552366384642;

]


# T = 0.1, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -13, tau = 0.002, jump = 10, boson_dim = 9, omega = 5;
mQ1_T = [1.6715733764602767e-10;
0.012375825163975366;
0.0480708245237993;
0.10318365436208117;
0.1723405691184477;
0.24985528692519673;
0.3306507037323257;
0.4107600363024096;
0.48744032852916425;
0.5590366393675144;
0.6247391131782883;
0.6843302953650428;
0.7379710897355521;
0.7860398982376009;
0.8290213496663572;
0.8674346577216321;
0.9017905333775614;
0.9325674203554972;
0.960200350947027;
0.9850772235933511;
1.0075393955536882;
1.0278848697899945;
1.0463725087010616;
1.0632264635674347;
1.0786405575894193;
1.0927822957534958;
1.105796544991943;
1.1178087184295113;
1.1289273641132256;
1.1392471416909464;
1.1488502495586312;
1.157808685002928;
1.1661855227430968;
1.1740360004993498;
1.181408741078652;
1.1883466091719324;
1.194887415596337;
1.201064770576987;
1.2069088364338671;
1.2124468418785947;
1.2177032052357417;
1.2226995366830973;
1.227454967814639;
1.2319864975346324;
1.2363094602795455;
1.2404375278423454;
1.244383398029819;
1.248158873914237;
1.251774846474365;
1.2552414039728412;
1.258567755058096;
1.2617620752570249;
1.2648318509425096;
1.2677841111819597;
1.2706253369170595;
1.2733616694857055;
1.2759987368172123;
1.2785416373540401;
1.2809950490137074;
1.283363414197976;
1.2856508284656505;
1.287861063691031;
1.2899975347861403;
1.292063435568765;
1.2940617666602456;
1.2959953538794327;
1.297867086130295;
1.2996797119439063;
1.301435764314436;
1.303137402236045;
1.3047866275810716;
1.3063854319953225;
1.307935639824;
1.3094393997714393;
1.3108984406065167;
1.3123144197480396;
1.3136888209124018;
1.3150228042656322;
1.3163174194716225;
1.3175740466462518;
1.3187941852870433;
1.319979268865451;
1.321130669027154;
1.3222495039753617;
1.3233367709665678;
1.3243934555047252;
1.3254203082884817;
1.3264184015164702;
1.3273887621304004;
1.3283324496422835;
1.3292503297540856;
1.3301430182700837;
1.3310110718317367;
1.3318549493425695;
1.3326753814463435;
1.3334733233003822;
1.3342496050673522;
1.3350049206862924;
1.3357398188193181;
1.3364548760249517;
1.3371503057958687;
1.3378263346523094;
1.3384834764717812;
1.3391223167435666;
1.3397436708260835;
1.3403481782501485;
1.3409363304704467;
1.3415083551486804;
1.342064468982004;
1.3426049012043872;
1.3431298505203426;
1.3436395834786548;
1.3441344560806954;
1.3446151189423818;
1.3450821991605675;
1.3455363400438207;
1.3459781050150053;
1.3464079404167224;
1.3468263273256154;
1.347233201952645;
1.3476285845320897;
1.3480123744718289;
1.3483846738565155;
1.3487457507357823;
1.3490959745378062;
1.349435660145947;
1.3497651523136966;
1.350084577061752;
1.3503939293762341;
1.3506933881385916;
1.3509835735255524;
1.3512651533384261;
1.3515385423728707;
1.351803728442919;
1.3520606366603263;
1.352309308731559;
1.3525498846109285;
1.3527824635282473;
1.3530071706960076;
1.3532242818082691;
1.3534341090513227;
1.3536369481123236;
1.3538328517926446;
1.3540217916481498;
1.3542039856430395;
1.354379893765978;
1.3545499712322364;
1.354714391867947;
1.354873058324302;
1.3550259769624764;
1.3551733573920925;
1.3553153690688096;
1.3554515674334362;
1.3555811439987704;
1.3557044372570757;
1.3558233993833655;
1.3559388050106513;
1.3560479854681269;
1.356148173255077;
1.3562426695701972;
1.356339519472384;
1.3564410592761444;
1.3565370457526649;
1.3566140980828374;
1.3566737314889998;
1.3567365016642423;
1.356822063175557;
1.3569239394672497;
1.357008287816848;
1.357044086286488;
1.3570384818406576;
1.3570405635365888;
1.3571029594265795;
1.3572317838239614;
1.3573700906786437;
1.3574349412154527;
1.357383290329716;
1.357255394136101;
1.3571578788606036;
1.357193592833712;
1.357384715586177;
1.3576442381185436;
1.3578200912157532;
1.3577880585856337;
1.3575365455464872;
1.3571885692551164;
1.356943229403489;
1.3569665944050961;
1.3572927280237042;
1.3577907025258662;
1.3582188248760727;
1.358340946962765;
1.3580477913188682;
1.3574221683783725;
1.3567146984990481;
1.3562396776933698;
1.356236311910861;
1.3567574250491856;
1.3576337979165747;
1.3585308758989687;
1.3590760684035672;
1.3590053638598238;
1.3582725712143537;
1.3570779278465017;
1.355806258904863;
1.3548960369039333;
1.354687599709186;
1.3553024329001224;
1.3565941996028035;
1.3581873260166435;
1.3595892597098236;
1.360340074910764;
1.360152797161041;
1.3590035149292319;
1.3571447974329873;
1.3550403836078855;
1.3532412125294249;
1.35223792521518;
1.3523295618957736;
1.353543104962787;
1.3556229748732607;
1.3580913120841782;
1.360361774562978;
1.3618780640011483;
1.3622434850221141;
1.3613121757401996;
1.3592218645106366;
1.3563642482748863;
1.3533014288601322;
1.350648346249785;
1.3489468190629748;
1.3485571498733198;
1.3495880316367677;
1.351877147715711;
1.3550239589416928;
1.3584658713510906;
]

vQ1_T = [1.1774912952419211e-6;
0.1844150631810909;
0.702583837596581;
1.4626029507105676;
2.3475895946260135;
3.2487145861179467;
4.085943076717562;
4.813445044756888;
5.414385684435174;
5.891592937920448;
6.2586541465063945;
6.5333825288890655;
6.733797887311716;
6.8761355588619155;
6.974031351118293;
7.038469512462115;
7.078060285531264;
7.099407849097159;
7.107516825244304;
7.106135787603623;
7.098049719552585;
7.085319890796512;
7.069465938231241;
7.051600686514443;
7.032522545508732;
7.012810226981779;
6.992873457598094;
6.9730041339859925;
6.9534056988139925;
6.934214612228556;
6.915517708054415;
6.897368329743663;
6.879801135316983;
6.862824371222928;
6.846441119347917;
6.830641562926486;
6.815394714849814;
6.800668178941266;
6.786441924885759;
6.772715378094222;
6.759482098904513;
6.746723498643843;
6.734406814805293;
6.722496445949069;
6.710957838690435;
6.69975404316739;
6.68886266223222;
6.67826719854582;
6.667960241575777;
6.657935680263584;
6.648185354383657;
6.6386912921828465;
6.629436899347258;
6.620405205251715;
6.61158480127353;
6.602974725143588;
6.594570114823379;
6.586360483825011;
6.578333059451091;
6.5704800320181675;
6.562794667752779;
6.555268415444621;
6.547892252366975;
6.540656604911609;
6.533553094322317;
6.526571167900094;
6.519710214347603;
6.512973297538894;
6.506364264391015;
6.499875361030852;
6.493491892748029;
6.4872004448492;
6.481001779210684;
6.474902868300767;
6.468906230319233;
6.463013867114459;
6.457216150109201;
6.451498879328204;
6.445850799421145;
6.440271251290552;
6.434763354049188;
6.429331716352916;
6.423981663794992;
6.418708760396728;
6.4135129691787895;
6.408387446621175;
6.403323475752037;
6.398314280425216;
6.393366523875415;
6.388486397387608;
6.3836780715603325;
6.3789367455166;
6.3742532123322055;
6.369614181416331;
6.365017346673376;
6.360472350361356;
6.355988631725071;
6.351563461946596;
6.347195539651474;
6.342883739755475;
6.338621003490013;
6.3343951858663665;
6.330197947931458;
6.32603108437212;
6.321910339415508;
6.31785063022283;
6.313847613161672;
6.309888590275683;
6.305970326118671;
6.302095456825291;
6.298260089598108;
6.294452338788441;
6.290664109027539;
6.2869044712443;
6.283182712913433;
6.279509900812508;
6.275891220405342;
6.272331578729181;
6.268826866537183;
6.265374773481806;
6.261961546157938;
6.258578543422545;
6.255222335885998;
6.251893670275456;
6.248590069180486;
6.24532070486785;
6.242089759831828;
6.238894622361564;
6.235716369454618;
6.232551785201439;
6.2294218853301215;
6.226343699810284;
6.223308434349017;
6.220315827321045;
6.217359239100812;
6.2144277747572945;
6.2115186944463385;
6.208629478936645;
6.205764027666065;
6.20292283097279;
6.200112442379195;
6.197341867638045;
6.194602587551238;
6.191876100037082;
6.1891650341196405;
6.186484775801959;
6.18385053251394;
6.181258333763436;
6.178694893306905;
6.176152296968137;
6.17363974953422;
6.171172514125383;
6.168730303286868;
6.166255929978146;
6.163746425721148;
6.161313901102153;
6.1590351392281715;
6.156745367793992;
6.154211023463531;
6.151547204827972;
6.149233354154644;
6.147501335310485;
6.145840829890345;
6.143441625656477;
6.140231935751271;
6.137242658303965;
6.135631608562311;
6.135283030374801;
6.134565995841814;
6.131768687754248;
6.126937771718062;
6.122265504030989;
6.120370626680119;
6.1218791134326676;
6.124479936621158;
6.124446937709969;
6.119543818768772;
6.111084110372509;
6.1034055182977;
6.100990161639388;
6.105205426185023;
6.1129666993537;
6.1183362358578695;
6.1161512729913;
6.105420345975;
6.090342391849041;
6.078240841199134;
6.075541042100017;
6.084050167176864;
6.09962118612206;
6.1139536351929635;
6.118628860031823;
6.109357535125955;
6.08832040199488;
6.0634643935293;
6.045104090615947;
6.04138062188917;
6.0545982121312685;
6.079997034772219;
6.107475189168344;
6.125511871891499;
6.125670008682787;
6.105933412557096;
6.071635616255662;
6.033691427795231;
6.004812426307023;
5.995090307796183;
6.008497189272686;
6.0414835453780125;
6.084070449974375;
6.12298655153843;
6.145740040582036;
6.14436021402073;
6.117733596608307;
6.071917389994494;
6.018456250095178;
5.971229169767943;
5.942727882371429;
5.940762088819383;
5.966452297199198;
6.013989954320065;
6.072140076588497;
6.127022440675363;
6.1654345238064;
6.177904195343175;
6.160784413061485;
6.116942993990881;
6.055008055039853;
5.987425121210466;
5.927783564952313;
5.887997957723196;
5.875946882144897;
5.894031406015954;
5.938884812657677;
6.002207526406245;
6.072467380860164;
]

# T = 0.1, alpha = 1.25, N_chain = 160, maxdim = 100, cutoff = -12, tau = 0.001, jump = 20, boson_dim = 14, omega = 5;
mQ2_T = [4.859787434203807e-11;
0.061879127585930116;
0.2403542083114906;
0.5159189498888297;
0.8617051800451642;
1.2492799456933463;
1.653250155645813;
2.0537637347088675;
2.437072680468358;
2.7948529320687623;
3.122991267627007;
3.4203252622330336;
3.6875781059353456;
3.926559689790668;
4.1396159366382825;
4.329274821080918;
4.498034383453682;
4.648246479311985;
4.782061423591577;
4.901409820866881;
5.0080047127003695;
5.1033556899018775;
5.188787924143385;
5.265461759452758;
5.334393508240733;
5.396472786658172;
5.452478310134938;
5.503093775036828;
5.548919059927399;
5.590481278705076;
5.628244699414313;
5.662619120127723;
5.693965898048509;
5.722603667311455;
5.748815095054973;
5.772850095983323;
5.794929869577704;
5.815250928288487;
5.833987973558304;
5.851295906445155;
5.8673133448180135;
5.882164051060489;
5.895957420753219;
5.908791643904038;
5.920753019410495;
5.9319203411040835;
5.94236388537619;
5.952147380127347;
5.961327391753214;
5.969954961033107;
5.978075871612239;
5.98573210355723;
5.992960885226556;
5.999795871304017;
6.006267274956702;
6.012401041161984;
6.01822054129407;
6.023748477721779;
6.029006174576927;
6.034012639738926;
6.0387856617723505;
6.043341966842065;
6.047696011794669;
6.0518601860005985;
6.055845872065368;
6.059663131190677;
6.06332226891324;
6.066832862121653;
6.070204015459975;
6.073443404415933;
6.076559180150087;
6.079558301976595;
6.082447754718814;
6.08523428496933;
6.087922960756455;
6.090517280148043;
6.093020554533886;
6.095436232483484;
6.097768356250663;
6.100021198551961;
6.102199844716208;
6.104309008721279;
6.106351764206046;
6.108330986748562;
6.1102494647220915;
6.11210974994749;
6.113914707192162;
6.11566670030949;
6.117367500583412;
6.119019832659552;
6.120625169992341;
6.1221848721593775;
6.123700684202224;
6.125174319967363;
6.126607444304496;
6.128001236878665;
6.129357969416556;
6.130679198865054;
6.131965806652844;
6.133219200306789;
6.1344401492682845;
6.135629579891337;
6.136788817322921;
6.137919197745623;
6.139022205270339;
6.140099851011804;
6.14115339893711;
6.142183021853416;
6.143189320860842;
6.144172140375028;
6.145130982124592;
6.146066502143926;
6.146979675649343;
6.147871329472085;
6.1487424669350155;
6.149594786409826;
6.150429573651757;
6.151247465607993;
6.152048219127444;
6.152831021774695;
6.153595438457801;
6.154342389081054;
6.155073178571935;
6.155788809972523;
6.156490314647996;
6.157178114921413;
6.157852597801186;
6.158513711741458;
6.1591617161871195;
6.1597968072159635;
6.160419778332993;
6.161031480846614;
6.161631891430336;
6.162220685418227;
6.162797357680003;
6.163361961146548;
6.163915261693487;
6.164457857056856;
6.164989960847493;
6.165511456197908;
6.166023192584532;
6.1665268643596445;
6.167022642680291;
6.167506925237047;
6.167978002681992;
6.168443931399143;
6.168912544816007;
6.169370836639622;
6.169798121991042;
6.170213508711494;
6.170670905692943;
6.17117147374014;
6.171621196187855;
6.171945108195425;
6.1722310871647785;
6.172667354818266;
6.173293876290906;
6.173877312588054;
6.174132987826439;
6.174093378996424;
6.174176717288099;
6.174794876544846;
6.175866365306632;
6.176769623242691;
6.17687064250401;
6.176174620629284;
6.175469045176396;
6.175745189485779;
6.177330441080686;
6.179472342916374;
6.180776725429037;
6.180238660496906;
6.178104440014056;
6.175886009098707;
6.175437504356737;
6.177673256683913;
6.181801405333939;
6.185627844195893;
6.186808844079977;
6.1843090629237425;
6.179181317250675;
6.174172103812334;
6.172323276003387;
]

vQ2_T = [5.390807671677148e-7;
0.9220746511217603;
3.5129196655979893;
7.313078896070375;
11.738237274171718;
16.244268812258408;
20.430742324005724;
24.067827615995135;
27.0702130121183;
29.450739278936144;
31.276057009078496;
32.634214824370396;
33.61480273387493;
34.298772896506435;
34.75457014193523;
35.03771129968754;
35.19202900003253;
35.251525687082726;
35.24227565964641;
35.184104093882944;
35.0919416758733;
34.977012660043506;
34.8477098866165;
34.710216772099685;
34.56907857734579;
34.42763048016292;
34.28824193973567;
34.15256273128561;
34.021696928003315;
33.89636287189737;
33.77696531858639;
33.66371221480218;
33.556622818774365;
33.45557853757818;
33.36042491869638;
33.27095982202532;
33.18691135781185;
33.107971282059765;
33.033860486559256;
32.96428075279177;
32.89894830251183;
32.83759363894836;
32.779950150002;
32.72573646677364;
32.67467233240001;
32.626536796587764;
32.58113832488548;
32.538293947033864;
32.49780445481867;
32.45950320257292;
32.42324781809482;
32.388909163696596;
32.356386513582635;
32.325573739951615;
32.29631857891509;
32.26848029831975;
32.24193059349802;
32.2165621704892;
32.192301838322486;
32.16913013496499;
32.14700680466894;
32.12590499573829;
32.10576095407432;
32.08651463668602;
32.068090510125515;
32.050405139220366;
32.03338134780559;
32.01699778523892;
32.001231449762834;
31.986072996504006;
31.971461169726346;
31.957355712272154;
31.94376886582028;
31.930745843368165;
31.918230728893775;
31.90616969450307;
31.894514294709822;
31.883192909381776;
31.872163276131097;
31.86142612629868;
31.85102755826869;
31.84100037168615;
31.831324856756297;
31.821964735010035;
31.812893492165486;
31.804097329395113;
31.795553380867972;
31.78725971889991;
31.779217300732817;
31.77141513540888;
31.7638315464078;
31.756450240348485;
31.749272265409807;
31.74229629090597;
31.73550017739943;
31.72887854592068;
31.722442718577916;
31.71617937944609;
31.710081519683214;
31.704137265896406;
31.698337127362876;
31.692680411040435;
31.68715807722961;
31.681750769263324;
31.676473992010052;
31.67134283369073;
31.66638780099433;
31.661608940494617;
31.65697230613793;
31.652429283363638;
31.647968004239537;
31.64357874816649;
31.639252664994913;
31.63495630429413;
31.63072371199125;
31.626604053130997;
31.62264403834918;
31.61885004726563;
31.615198364440516;
31.6116058086479;
31.608027983747064;
31.6044707867714;
31.600977255165446;
31.597569929290643;
31.59425243570532;
31.59102578500029;
31.587885357937715;
31.584822035391703;
31.581831693940735;
31.57890343471491;
31.57604831945217;
31.573290093803855;
31.570613921604455;
31.567985739202022;
31.56537444278596;
31.562787973887644;
31.560244402764518;
31.557766478788913;
31.555337502007603;
31.55291302055865;
31.55050569822756;
31.54821187923737;
31.54607182749681;
31.543841275544445;
31.541260951219527;
31.538799753977194;
31.537179947999427;
31.535674113384857;
31.532504841528592;
31.528324833153945;
31.52691302826799;
31.529417047874055;
31.53023559089067;
31.523549491034068;
31.513316920961437;
31.51122272970239;
31.52173564321786;
31.53280622188015;
31.526991432002625;
31.503052725696982;
31.482300474280024;
31.48878295015853;
31.522091455673525;
31.552239612664238;
31.545082002015455;
31.49616668064499;
31.44061136170219;
31.42708875027858;
31.47611300816387;
31.55794401117879;
31.61021032385171;
31.58374544707621;
31.482639736566263;
31.367922223438534;
31.319756150388045;
31.382679520890093;
31.531239745756032;
31.680147675683898;
31.73373302572334;
31.644385209890224;
31.44487901122411;
31.235516874300522;
31.132428564978632;
]

fmQ1(x) = (-97.817*x + 536.548*x^2)/(351.553 + 26.2609*x + 395.255*x^2)
fvQ1(x) = (1478.77*x^2 + 150.5*x^4)/(108.058 + 145.549*x^2 + 29.1615*x^4)
fmQ2(x) = (-3.37036*x + 30.2561*x^2)/(6.13764 - 1.71698*x + 4.64394*x^2)
fvQ2(x) = (10.308*x^2 + 5.35486*x^4)/(0.191549 + 0.135901*x^2 + 0.182081*x^4)
fmQ1T(x) = (-0.36018*x + 2.01181*x^2)/(1.32323 + 0.119858*x + 1.47309*x^2)
fvQ1T(x) = (1420.72*x^2 + 401.678*x^4)/(115.792 + 129.448*x^2 + 66.2136*x^4)
fmQ2T(x) = (-31.2982*x + 228.368*x^2)/(42.171 - 9.42199*x + 37.5266*x^2)
fvQ2T(x) = (22.1913*x^2 + 9.46*x^4)/(0.403431 + 0.356355*x^2 + 0.314482*x^4)

#= 
num = 48
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]

 =#
Ï_C = 5


# Time step duration
tau = 0.002


time_steps = collect(0:151) * 10 * tau * Ï_C
#time_steps4 = collect(0:lastindex(Sx1_T)-1)*10*tau*Ï_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks1 = range(2, stop = 8, length = 2)
xticks2 = range(2, stop = 8, length = 2)
xticks3 = range(5, stop = maximum(time_steps[end-1]), length = 3)
xticks3sub = range(10, stop = maximum(time_steps[end-1]), length = 2)

yticks1 = range(0, stop = 6, length = 3)
yticks2 = range(0, stop = 30, length = 3)
yticks3 = range(4, stop = 10, length = 4)
yticks3sub = range(4, stop = 5, length = 2)

#xtick_labels1 = [string(round(x, digits = 1)) for x in xticks1]
    xtick_labels1 = [" " for x in xticks1]

xtick_labels2 = [string(Int(round(x, digits = 1))) for x in xticks2]
xtick_labels3 = [string(Int(round(x, digits = 1))) for x in xticks3]
xtick_labels3sub = [string(Int(round(x, digits = 1))) for x in xticks3sub]
ytick_labels1 = [string(Int(round(y, digits = 1))) for y in yticks1]
ytick_labels2 = [string(Int(round(y, digits = 1))) for y in yticks2]
ytick_labels3 = [string(Int(round(y, digits = 1))) for y in yticks3]
ytick_labels3sub = [string(Int(round(y, digits = 1))) for y in yticks3sub]


# Plot
p1 = plot(time_steps, fmQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:6:length(mQ1)], mQ1[1:6:end], markersize = 4, markerstrokewidth = 0.5, xaxis = "", #yaxis = L"\langle Q \rangle", 
	xticks = (xticks1, xtick_labels1), yticks = (yticks1, ytick_labels1),
	xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:6:length(mQ2)], mQ2[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[1:6:length(mQ1_T)], mQ1_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[1:6:length(mQ2_T)], mQ2_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(yaxis = L"â¨Qâ©")
plot!(legend = false)
xlims!(0, 10)  
ylims!(0, 7)  
plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(bottom_margin = -8mm)
annotate!(9.5, 4.7, text("(a)", 17, :black, :right))
ticks_length!(tl=.03)




p2 = plot(time_steps, fvQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:6:length(vQ1)], vQ1[1:6:end], markersize = 4, markerstrokewidth = 0.5, xticks = (xticks2, xtick_labels2), yticks = (yticks2, ytick_labels2), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue, seriesalpha = 1, xaxis = "") #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:6:length(vQ2)], vQ2[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[1:6:length(vQ1_T)], vQ1_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[1:6:length(vQ2_T)], vQ2_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(widen = false)
xlims!(0, 10)  
ylims!(0, 38)  
plot!(yaxis = L"â¨â¨Q^2â©â©")
plot!(xaxislabel = false)
vline!([xlims(p2)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p2)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(legend = false)
annotate!(9.5, 21, text("(b)", 17, :black, :right))
ticks_length!(tl=.03)
plot!(xaxis = L"tÏ_C")



p3 = plot(time_steps[10:end], fvQ1.(time_steps[10:end])./fmQ1.(time_steps[10:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2.(time_steps[10:end])./fmQ2.(time_steps[10:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ1T.(time_steps[10:end])./fmQ1T.(time_steps[10:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2T.(time_steps[10:end])./fmQ2T.(time_steps[10:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[8:6:length(vQ1)], vQ1[8:6:end] ./ mQ1[8:6:end], color = :lightblue, xticks = (xticks3, xtick_labels3), yticks = (yticks3, ytick_labels3), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, seriesalpha = 1, xaxis = "", markersize = 4, markerstrokewidth = 0.5) #, label = L"\  (1, 1.5)")
scatter!(time_steps[8:6:length(vQ2)], vQ2[8:6:end] ./ mQ2[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[8:6:length(vQ1_T)], vQ1_T[8:6:end] ./ mQ1_T[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[8:6:length(vQ2_T)], vQ2_T[8:6:end] ./ mQ2_T[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(widen = false)
#plot!(yaxis = L"F")
ylims!(3.5, 11)  
xlims!(0, 16)  
vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false, ymirror = true)
plot!(legend = false)
annotate!(19.5, 7, text(L"F", 24, :black, :right))
ticks_length!(tl=.02)
annotate!(15, 10.5, text("(c)", 17, :black, :right))
plot!(xaxis = L"tÏ_C")


plot!(p3, inset=bbox(0.3,0.01,0.42, 0.6), subplot=2)

plot!(p3[2], time_steps[50:end], fvQ1.(time_steps[50:end])./fmQ1.(time_steps[50:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2.(time_steps[50:end])./fmQ2.(time_steps[50:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ1T.(time_steps[50:end])./fmQ1T.(time_steps[50:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2T.(time_steps[50:end])./fmQ2T.(time_steps[50:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(p3[2], time_steps[50:6:length(vQ1)], vQ1[50:6:end] ./ mQ1[50:6:end], color = :lightblue, xticks = (xticks3sub, xtick_labels3sub), yticks = (yticks3sub, ytick_labels3sub), xtickfont = font(12), ytickfont = font(12),
	xguidefontsize = 10, yguidefontsize = 15, seriesalpha = 1, xaxis = "", markersize = 4, markerstrokewidth = 0.5) #, label = L"\  (1, 1.5)")
scatter!(p3[2], time_steps[50:6:length(vQ2)], vQ2[50:6:end] ./ mQ2[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(p3[2], time_steps[50:6:length(vQ1_T)], vQ1_T[50:6:end] ./ mQ1_T[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(p3[2], time_steps[50:6:length(vQ2_T)], vQ2_T[50:6:end] ./ mQ2_T[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
ylims!(p3[2], 3.8, 5.3)  
xlims!(p3[2], 7, 15)  
#= vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false) =#
plot!(p3[2], grid = false)
plot!(p3[2], legend = false, aspect_ratio = 5., framestyle = :box)	
#annotate!(19.7, 4.7, text(L"F", 24, :black, :right))
#annotate!(14.5, 5.8, text("(c)", 20, :black, :right))
#plot!(p3[2], xaxis = L"tÏ_C")
#plot!(p3[2], xaxis = " ")



custom_layout = @layout [[a{0.5h}; b{1.35w}] c{0.6w}]
p = plot(p1, p2, p3, layout = custom_layout, size = (600, 400), left_margin = 5mm, right_margin = 7mm)



#p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png", p)

