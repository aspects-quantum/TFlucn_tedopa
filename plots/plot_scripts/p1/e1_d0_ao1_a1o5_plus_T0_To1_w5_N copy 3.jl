using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


T = 0.1
α = 0.5

# T = 0, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 11, omega_C = 5, jump = 10;

mQ1 = [1.8405812081189988e-10;
	0.0001250064108894105;
	0.01494065208608288;
	0.05277934360044519;
	0.10943664547513685;
	0.17956513299568533;
	0.2575609055189282;
	0.3384026116898393;
	0.4187429399590482;
	0.4941581437575594;
	0.5652784887039901;
	0.6304741928723817;
	0.6893231900490155;
	0.7427717781517547;
	0.7902835266323109;
	0.8334036095621097;
	0.8716374513814449;
	0.9062542182107779;
	0.9365135449422374;
	0.9634496559192202;
	0.9870589069838109;
	1.0089910398170652;
	1.0293798703350356;
	1.0450664048415181;
	1.060777617117483;
	1.0759879015841012;
	1.088874227624748;
	1.101007419982707;
	1.1165924870972648;
	1.1276321782330956;
	1.1379861017450912;
	1.1470203181795056;
	1.1532541089106636;
	1.1609293312125324;
	1.1684202200412523;
	1.1754963710192057;
	1.1824353416139533;
	1.1888043896543783;
	1.1946277503989569;
	1.2005031159738888;
	1.2054993724568923;
	1.2102306029070469;
	1.2149621226324812;
	1.2190453266681107;
	1.2230464720388372;
	1.2263574388617076;
	1.2309904416449027;
	1.2348232849139211;
	1.23822610540554;
	1.2412104049623789;
	1.244418954145979;
	1.247295317309231;
	1.2500046805647043;
	1.2529533768623593;
	1.255746444047463;
	1.2586472411475962;
	1.2606942677492505;
	1.2627219844081496;
	1.264908572915064;
	1.2666743725170961;
	1.2685216618061546;
	1.2710386943038252;
	1.2726314463720823;
	1.2749269291632916;
	1.2771533732193838;
	1.279275741797773;
	1.2819221459886772;
	1.2840224908522007;
	1.2855243620166519;
	1.2869738634326353;
	1.2879144144148822;
	1.2894531053493536;
	1.2899731577785964;
	1.2913586091755056;
	1.2928493795619023;
	1.294197156072127;
	1.296145343390103;
	1.2977326803352873;
	1.2992315559014949;
	1.2998335941677015;
	1.3003928146987764;
	1.3014653741322804;
	1.3020705747661094;
	1.3025170880851262;
	1.30364698931601;
	1.3046884055090384;
	1.305893591551506;
	1.3069464347640383;
	1.3076354704223203;
	1.3078911978762633;
	1.308622709628375
]


vQ1 = [2.388012295509135e-21;
	1.0962176467827036e-11;
	0.22226779899688334;
	0.7689605765289165;
	1.5454429711213857;
	2.4349901301247976;
	3.3319835566934977;
	4.159413573907889;
	4.878809642762786;
	5.463425059656779;
	5.930415546689885;
	6.287881389885476;
	6.550029402798663;
	6.739656089478035;
	6.8686396964418845;
	6.969533766236356;
	7.034298189167698;
	7.0825144237258675;
	7.09218382905461;
	7.107908192951239;
	7.105868935206357;
	7.1040143452194755;
	7.135353043395648;
	7.0958232780138495;
	7.019626204758704;
	6.964164746444448;
	6.877792717994686;
	6.80450657837212;
	6.802713572645995;
	6.751421973677694;
	6.719567498215516;
	6.679209152180881;
	6.587909046854928;
	6.506494511139;
	6.483101691454682;
	6.4547773379681255;
	6.47504271718884;
	6.435296267847235;
	6.4241818779686835;
	6.436691209170958;
	6.390489825248273;
	6.347171247780086;
	6.326882620857347;
	6.285476862927391;
	6.241912729027859;
	6.146558808186752;
	6.143313703362571;
	6.170596285023927;
	6.127426710800677;
	6.0436976570521965;
	6.043863114724729;
	6.009283215747681;
	5.934907555377326;
	5.922303044312204;
	5.920435533518504;
	5.889835821992295;
	5.879871915580752;
	5.845003389549144;
	5.794948833388687;
	5.748704694598329;
	5.711934365562274;
	5.736820815391525;
	5.701328315461925;
	5.683114886874477;
	5.704713150730175;
	5.695003581332782;
	5.7589521348342965;
	5.768445794478453;
	5.7391347482131;
	5.678812468470714;
	5.640809180104151;
	5.591644585199991;
	5.494971983829895;
	5.516715800048563;
	5.580703578049837;
	5.521597318487775;
	5.546808868560515;
	5.519079580818103;
	5.542721025654048;
	5.505447092813535;
	5.4630750193018205;
	5.465350791474617;
	5.462030042284525;
	5.374639359145459;
	5.426424785690702;
	5.363041251517956;
	5.360086108833599;
	5.409943385206222;
	5.428667762923505;
	5.343840212704828;
	5.357210259661553
]
#

# T = 0, alpha = 1.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 14, omega_C = 5, jump = 10;

mQ2 = [3.567500254549793e-10;
	0.0006249022715874813;
	0.07475743944316672;
	0.26482406719502755;
	0.5521799503863928;
	0.9119290857274037;
	1.3168504998238864;
	1.7422771450006447;
	2.17107905034659;
	2.5819995675126126;
	2.973477572822831;
	3.336500188445349;
	3.6682378306054875;
	3.9697593161605367;
	4.241974987188256;
	4.486313857401634;
	4.7040500542418195;
	4.899145135225017;
	5.0730658507889945;
	5.226317732080106;
	5.364379841974493;
	5.4875919731559115;
	5.597623523602879;
	5.6946640948493865;
	5.782126723837142;
	5.857089773783587;
	5.926123146076309;
	5.988000238266635;
	6.042783611751876;
	6.093582291480446;
	6.1370235398242325;
	6.176912152885097;
	6.2127126842769025;
	6.246164732868617;
	6.275766185118161;
	6.301046836162108;
	6.324806458942082;
	6.3460786142491274;
	6.365894095387877;
	6.383262851581314;
	6.399092724889714;
	6.412904350419165;
	6.425392819925894;
	6.437065585311147;
	6.447319023271443;
	6.458506926281032;
	6.467857001161147;
	6.476448462152278;
	6.483314234948074;
	6.490561225892032;
	6.49610631233362;
	6.5025787152595065
]

#T = 0, alpha = 1.25, N_chain = 190, maxdim = 90, cutoff = -11, tau = 0.001, boson_dim = 15, omega_C = 5, jump = 20;

vQ2 = [2.195244462453438e-20;
	0.009371395753627922;
	1.1181207834869096;
	3.9159771787177884;
	7.779134597952304;
	12.533408214852233;
	17.16137414676287;
	21.449586559175412;
	24.974156435229986;
	28.06993039742016;
	30.683596546347133;
	32.41980056410942;
	33.7234034192811;
	34.680247208055526;
	35.16160082367111;
	35.09742742486684;
	35.648746738826546;
	35.57440497811088;
	35.350140859729066;
	34.80430349625048;
	35.0278773360662;
	34.66033482177102;
	34.07603551851091;
	34.112337445649835;
	33.84805433164526;
	33.52848221419654;
	33.560742958917636;
	33.33405025135368;
	33.01494332854216;
	33.03562798468398;
	32.77981731888517;
	32.44741065983405;
	32.36345089773603;
	32.18069818435158;
	31.86337119612135;
	31.829994997465533;
	31.64489548286293;
	31.47468935693999;
	31.38027257734806;
	31.205824724472315;
	31.20213539470336;
	31.219872174909554;
	31.10880889853901;
	31.02153237674974;
	30.949573073941387;
	30.90297019608846;
	30.875796581577276;
	30.884220382065564;
	30.85015172556796;
	30.850167425902278;
	30.77990920174844;
	30.763159456872636
]


# T = 0.1, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -13, tau = 0.002, jump = 10, boson_dim = 9, omega = 5;
mQ1_T = [1.281842478429467e-9;
	0.00012501578827929822;
	0.014940657059867855;
	0.052779347537669635;
	0.10949233307257862;
	0.17971397857458474;
	0.25782722789797546;
	0.3385431662182373;
	0.4184184274802356;
	0.49468843176673644;
	0.56574500610912;
	0.6309669394379981;
	0.6900419102274707;
	0.7431252948664755;
	0.7904085567900477;
	0.8306711067123642;
	0.8671104641086591;
	0.900391386115474;
	0.934132514854479;
	0.9616202144741572;
	0.9857798215915557;
	1.0085727375745794;
	1.0286257213524523;
	1.0469037943646993;
	1.0638552707713205;
	1.0795236156896744;
	1.0936210154531791;
	1.105634716404114;
	1.1173561223541995;
	1.1278271708179575;
	1.1379183880844688;
	1.1474848317562103;
	1.1551849714416609;
	1.1635695963110884;
	1.172049611406541;
	1.1784925100952197;
	1.1850017932877737;
	1.1910151954427866;
	1.1966285720196457;
	1.2023753420609442;
	1.207741364524589;
	1.213113681118231;
	1.218310126573968;
	1.2233617587787198;
	1.2278334502681927;
	1.232316061469097;
	1.2359616004144829;
	1.2395927181973447;
	1.243070650935191;
	1.2462576840942456;
	1.2494090075203572;
	1.2526089229291326;
	1.255371538568965;
	1.257562463870169;
	1.2618539410210032;
	1.2641046569370173;
	1.2670038664343193;
	1.2697568428906159;
	1.2713449409589153;
	1.2735798376941603;
	1.275703640849852;
	1.2781123540547146;
	1.2801398656053313;
	1.2825321150685756;
	1.2843206771078872;
	1.286505565546624;
	1.2884342797122752;
	1.2898688153932418;
	1.2919434005984105;
	1.2938603039668444;
	1.2951249156244786;
	1.2966245533882361;
	1.2979668192329965;
	1.2994672178004463;
	1.3007467159459898;
	1.3015822068408804;
	1.3026906391619637;
	1.304370976320287
]

vQ1_T = [1.527649877625358e-19;
	1.2985268386138153e-11;
	0.22226799354830604;
	0.7689622110905452;
	1.5462719807932814;
	2.4370264974694575;
	3.3359834611633494;
	4.16143849088709;
	4.87805266024457;
	5.466577162024314;
	5.933026364974981;
	6.298020763471816;
	6.560092946264271;
	6.759169945716484;
	6.881221924954992;
	6.957897687477331;
	7.00833970566092;
	7.052034572618508;
	7.096756748283588;
	7.107399602522366;
	7.094220582441305;
	7.0949244121814825;
	7.06976078953775;
	7.059428501978322;
	7.026591267731811;
	7.011743959813139;
	6.988735853401765;
	6.949749479060623;
	6.926657184651798;
	6.870330612659847;
	6.826041582982341;
	6.818662790276404;
	6.771026321216221;
	6.7894648230513175;
	6.768899045861792;
	6.744530883433112;
	6.698652624218761;
	6.688946300689102;
	6.649104215809965;
	6.6338164423979595;
	6.616812095880335;
	6.598275095309559;
	6.588297222308368;
	6.574482417642667;
	6.537016215104602;
	6.513346783279786;
	6.50123277451099;
	6.472664481147792;
	6.4524154790325445;
	6.43663238544523;
	6.411452815962753;
	6.403978516696705;
	6.396964299203855;
	6.358303413487549;
	6.398825040315356;
	6.378440373651865;
	6.372455355322492;
	6.367828098359086;
	6.335354452437112;
	6.318556351744555;
	6.301098489585459;
	6.288415856712877;
	6.283271374817223;
	6.274992754663097;
	6.233911051223494;
	6.235382058180566;
	6.242787846141264;
	6.2243251775078665;
	6.225122022680584;
	6.238337425943078;
	6.2233539192936;
	6.202172960647967;
	6.184071010219015;
	6.166126812952896;
	6.15115011272375;
	6.157918888213119;
	6.159543979612101;
	6.124474663409623
]

# T = 0.1, alpha = 1.25, N_chain = 160, maxdim = 100, cutoff = -12, tau = 0.001, jump = 20, boson_dim = 14, omega = 5;
mQ2_T = [5.989396505547515e-11;
	0.0001562932177014501;
	0.06814900695611678;
	0.2519145963617368;
	0.5314479774588313;
	0.879885246004804;
	1.2690515831796527;
	1.6723851931877587;
	2.072408431301839;
	2.454840747506371;
	2.810988898774524;
	3.1357953099599314;
	3.429831082760596;
	3.6937007751957704;
	3.9291997118677253;
	4.1478261586873355;
	4.336982179899092;
	4.505242141471867;
	4.652125906799918;
	4.784914318119998;
	4.903065274763841;
	5.008290461840825;
	5.1029576914217865;
	5.1872874689447395;
	5.2629781524894765;
	5.330188432450602;
	5.390617804844508;
	5.44538598822404;
	5.494773553365357;
	5.539485437967166;
	5.5811405696078;
	5.618450260191613;
	5.651271806693405;
	5.682648720220385;
	5.710662443128628;
	5.736064689811054;
	5.759149586615316;
	5.780879507652541;
	5.799522401933674;
	5.8179209428077625;
	5.83504385918023;
	5.851004682636041;
	5.864371683937175;
	5.8766343827589935;
	5.890499924657706;
	5.900242594393487;
	5.91108723182422;
	5.921145523437197;
	5.931496702847394;
	5.9403332341845365;
	5.948018187202674;
	5.954892045302089;
	5.961970420787203;
	5.968528948613331;
	5.974471106531391
]

vQ2_T = [-1.2140048038597416e-20;
	1.7160845334233402e-11;
	1.0146601106111548;
	3.6770484025840156;
	7.519766346650278;
	11.959521887941223;
	16.475780924097556;
	20.628987671412222;
	24.238468735365146;
	27.207286403913592;
	29.52236691920304;
	31.30043030564299;
	32.64890796372694;
	33.596432545991874;
	34.16977639625016;
	34.693686514081236;
	34.90723796161731;
	35.05120650856262;
	35.10248706007463;
	35.12619163830346;
	35.102619146651975;
	35.03125608460434;
	34.923143969883824;
	34.70974341618456;
	34.5144108227701;
	34.259002358637176;
	34.06116467003746;
	33.77190371189812;
	33.57615265099757;
	33.48592577124601;
	33.38146143094103;
	33.18836117643744;
	32.969472819282075;
	32.9358913093489;
	32.85210645973264;
	32.62063722959215;
	32.47224568681617;
	32.442628416339694;
	32.10292348763794;
	32.084166942769244;
	32.04051070935656;
	31.926753987359582;
	31.883363549166297;
	31.875757283390485;
	31.876869341375702;
	31.54966128986309;
	31.579819980495515;
	31.495465379505106;
	31.52145140472539;
	31.42838571483395;
	31.34596123550294;
	31.23625374508555;
	31.13436825792423;
	31.048543624335743;
	30.940676986441666
]

fmQ1(x) = (-97.817*x + 536.548*x^2)/(351.553 + 26.2609*x + 395.255*x^2)
fvQ1(x) = (1478.77*x^2 + 150.5*x^4)/(108.058 + 145.549*x^2 + 29.1615*x^4)
fmQ2(x) = (-3.37036*x + 30.2561*x^2)/(6.13764 - 1.71698*x + 4.64394*x^2)
fvQ2(x) = (10.308*x^2 + 5.35486*x^4)/(0.191549 + 0.135901*x^2 + 0.182081*x^4)
fmQ1T(x) = (-0.36018*x + 2.01181*x^2)/(1.32323 + 0.119858*x + 1.47309*x^2)
fvQ1T(x) = (1420.72*x^2 + 401.678*x^4)/(115.792 + 129.448*x^2 + 66.2136*x^4)
fmQ2T(x) = (-31.2982*x + 228.368*x^2)/(42.171 - 9.42199*x + 37.5266*x^2)
fvQ2T(x) = (22.1913*x^2 + 9.46*x^4)/(0.403431 + 0.356355*x^2 + 0.314482*x^4)

#= 
num = 48
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]

 =#
ω_C = 5


# Time step duration
tau = 0.002


time_steps = collect(0:151) * 10 * tau * ω_C
#time_steps4 = collect(0:lastindex(Sx1_T)-1)*10*tau*ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks1 = range(2, stop = 8, length = 2)
xticks2 = range(2, stop = 8, length = 2)
xticks3 = range(5, stop = maximum(time_steps[end-1]), length = 3)
xticks3sub = range(10, stop = maximum(time_steps[end-1]), length = 2)

yticks1 = range(0, stop = 6, length = 3)
yticks2 = range(0, stop = 30, length = 3)
yticks3 = range(4, stop = 10, length = 4)
yticks3sub = range(4, stop = 5, length = 2)

#xtick_labels1 = [string(round(x, digits = 1)) for x in xticks1]
    xtick_labels1 = [" " for x in xticks1]

xtick_labels2 = [string(Int(round(x, digits = 1))) for x in xticks2]
xtick_labels3 = [string(Int(round(x, digits = 1))) for x in xticks3]
xtick_labels3sub = [string(Int(round(x, digits = 1))) for x in xticks3sub]
ytick_labels1 = [string(Int(round(y, digits = 1))) for y in yticks1]
ytick_labels2 = [string(Int(round(y, digits = 1))) for y in yticks2]
ytick_labels3 = [string(Int(round(y, digits = 1))) for y in yticks3]
ytick_labels3sub = [string(Int(round(y, digits = 1))) for y in yticks3sub]


# Plot
p1 = plot(time_steps, fmQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:6:length(mQ1)], mQ1[1:6:end], markersize = 4, markerstrokewidth = 0.5, xaxis = "", #yaxis = L"\langle Q \rangle", 
	xticks = (xticks1, xtick_labels1), yticks = (yticks1, ytick_labels1),
	xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:6:length(mQ2)], mQ2[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[1:6:length(mQ1_T)], mQ1_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[1:6:length(mQ2_T)], mQ2_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(yaxis = L"⟨Q⟩")
plot!(legend = false)
xlims!(0, 10)  
ylims!(0, 7)  
plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(bottom_margin = -8mm)
annotate!(9.5, 4.7, text("(a)", 17, :black, :right))
ticks_length!(tl=.03)




p2 = plot(time_steps, fvQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:6:length(vQ1)], vQ1[1:6:end], markersize = 4, markerstrokewidth = 0.5, xticks = (xticks2, xtick_labels2), yticks = (yticks2, ytick_labels2), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue, seriesalpha = 1, xaxis = "") #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:6:length(vQ2)], vQ2[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[1:6:length(vQ1_T)], vQ1_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[1:6:length(vQ2_T)], vQ2_T[1:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(widen = false)
xlims!(0, 10)  
ylims!(0, 38)  
plot!(yaxis = L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel = false)
vline!([xlims(p2)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p2)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(legend = false)
annotate!(9.5, 21, text("(b)", 17, :black, :right))
ticks_length!(tl=.03)
plot!(xaxis = L"tω_C")



p3 = plot(time_steps[10:end], fvQ1.(time_steps[10:end])./fmQ1.(time_steps[10:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2.(time_steps[10:end])./fmQ2.(time_steps[10:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ1T.(time_steps[10:end])./fmQ1T.(time_steps[10:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2T.(time_steps[10:end])./fmQ2T.(time_steps[10:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[8:6:length(vQ1)], vQ1[8:6:end] ./ mQ1[8:6:end], color = :lightblue, xticks = (xticks3, xtick_labels3), yticks = (yticks3, ytick_labels3), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, seriesalpha = 1, xaxis = "", markersize = 4, markerstrokewidth = 0.5) #, label = L"\  (1, 1.5)")
scatter!(time_steps[8:6:length(vQ2)], vQ2[8:6:end] ./ mQ2[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(time_steps[8:6:length(vQ1_T)], vQ1_T[8:6:end] ./ mQ1_T[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(time_steps[8:6:length(vQ2_T)], vQ2_T[8:6:end] ./ mQ2_T[8:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
plot!(widen = false)
#plot!(yaxis = L"F")
ylims!(3.5, 11)  
xlims!(0, 16)  
vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false, ymirror = true)
plot!(legend = false)
annotate!(19.5, 7, text(L"F", 24, :black, :right))
ticks_length!(tl=.02)
annotate!(15, 10.5, text("(c)", 17, :black, :right))
plot!(xaxis = L"tω_C")


plot!(p3, inset=bbox(0.3,0.01,0.42, 0.6), subplot=2)

plot!(p3[2], time_steps[50:end], fvQ1.(time_steps[50:end])./fmQ1.(time_steps[50:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2.(time_steps[50:end])./fmQ2.(time_steps[50:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ1T.(time_steps[50:end])./fmQ1T.(time_steps[50:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2T.(time_steps[50:end])./fmQ2T.(time_steps[50:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(p3[2], time_steps[50:6:length(vQ1)], vQ1[50:6:end] ./ mQ1[50:6:end], color = :lightblue, xticks = (xticks3sub, xtick_labels3sub), yticks = (yticks3sub, ytick_labels3sub), xtickfont = font(12), ytickfont = font(12),
	xguidefontsize = 10, yguidefontsize = 15, seriesalpha = 1, xaxis = "", markersize = 4, markerstrokewidth = 0.5) #, label = L"\  (1, 1.5)")
scatter!(p3[2], time_steps[50:6:length(vQ2)], vQ2[50:6:end] ./ mQ2[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(p3[2], time_steps[50:6:length(vQ1_T)], vQ1_T[50:6:end] ./ mQ1_T[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :lightcoral)
scatter!(p3[2], time_steps[50:6:length(vQ2_T)], vQ2_T[50:6:end] ./ mQ2_T[50:6:end], markersize = 4, markerstrokewidth = 0.5, color = :brown)
ylims!(p3[2], 3.8, 5.3)  
xlims!(p3[2], 7, 15)  
#= vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false) =#
plot!(p3[2], grid = false)
plot!(p3[2], legend = false, aspect_ratio = 5., framestyle = :box)	
#annotate!(19.7, 4.7, text(L"F", 24, :black, :right))
#annotate!(14.5, 5.8, text("(c)", 20, :black, :right))
#plot!(p3[2], xaxis = L"tω_C")
#plot!(p3[2], xaxis = " ")



custom_layout = @layout [[a{0.5h}; b{1.35w}] c{0.6w}]
p = plot(p1, p2, p3, layout = custom_layout, size = (600, 400), left_margin = 5mm, right_margin = 7mm)



#p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png", p)

