using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


# T = 0, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 11, omega_C = 5, jump = 10;

mQ1 = [0.0;
0.01237440439753447;
0.048070650809491876;
0.10320009707513593;
0.17240020612166482;
0.24998657673489677;
0.3308715254546042;
0.41106698065086783;
0.48780235231646624;
0.5593936653263402;
0.6250045706533489;
0.6843960406139884;
0.7377133802510141;
0.7853253804705336;
0.8277125518561315;
0.8653945722806446;
0.8988862322418983;
0.9286727881865547;
0.9551978721319002;
0.9788591473480016;
1.0000084945285155;
1.0189546596884749;
1.0359670800918308;
1.0512801206998417;
1.0650972827221739;
1.0775951529657715;
1.088926989270133;
1.099225909426822;
1.108607688113282;
1.1171731852376223;
1.1250104393485185;
1.132196463536146;
1.1387987811323164;
1.1448767357628484;
1.1504826096504248;
1.155662567734626;
1.1604574790467561;
1.1649036011199647;
1.1690331726529741;
1.172874919707415;
1.176454489900963;
1.1797948252693309;
1.1829164839902226;
1.1858379191524935;
1.1885757210276706;
1.1911448293988174;
1.1935587206606562;
1.195829571907597;
1.1979684040032899;
1.1999852062439496;
1.2018890456510407;
1.2036881638380688;
1.2053900635353945;
1.2070015859431649;
1.2085289795262102;
1.209977960647805;
1.211353767008623;
1.2126612049298147;
1.2139046911645044;
1.2150882899794715;
1.2162157459853902;
1.2172905134881553;
1.2183157834389273;
1.2192945080118687;
1.2202294224790018;
1.221123064623659;
1.2219777920115118;
1.2227957973532553;
1.2235791219788736;
1.2243296678687907;
1.2250492089081289;
1.2257394010405112;
1.2264017914406744;
1.2270378273742577;
1.2276488642617251;
1.2282361726870357;
1.228800944148124;
1.2293442965428387;
1.2298672797646406;
1.230370881046496;
1.2308560299480154;
1.2313236025299497;
1.231774424611397;
1.2322092743803772;
1.2326288855092151;
1.2330339504119205;
1.2334251234366955;
1.2338030236039987;
1.2341682365521283;
1.2345213159678887;
1.2348627862532755;
1.2351931456747132;
1.2355128675912903;
1.2358223996084936;
1.2361221635781072;
1.2364125578738063;
1.2366939624700612;
1.2369667448948152;
1.2372312601095552;
1.2374878419138613;
1.2377367982886214;
1.2379784157247862;
1.2382129655754042;
1.2384407105927127;
1.238661911303165;
1.2388768259169902;
1.239085701736686;
1.2392887665731673;
1.2394862293425122;
1.2396782892347349;
1.2398651397372347;
1.2400469644813994;
1.2402239395596348;
1.2403962379406968;
1.2405640212417501;
1.2407274425345913;
1.2408866469883946;
1.2410417754273397;
1.2411929533070811;
1.2413402984233084;
1.2414839466308638;
1.2416240587790428;
1.2417607977351262;
1.2418942899312897;
1.2420246195007092;
1.2421518389768003;
1.2422759909110597;
1.2423971304381203;
1.2425153470408972;
1.2426307794566713;
1.2427436000324397;
1.242853947315082;
1.2429618573917969;
1.2430672919368237;
1.2431702421555473;
1.243270800865957;
1.243369133115412;
1.2434653800189697;
1.2435596222477483;
1.243651908475237;
1.2437422832272829;
1.2438307908475392;
1.2439174696454671;
1.2440023430407914;
1.2440854129388206;
1.2441666684258639;
1.2442461148866575;
1.2443238063216948;
1.2443998442452089;
1.2444743610976303;
1.2445474857712893;
1.2446193209696939;
1.2446899235748294;
1.2447592970052692;
1.244827401568511;
1.2448941849842707;
1.244959606742338;
1.2450236209423236;
1.2450862303275825;
1.2451476060189706;
1.245207996678656;
1.2452672444758257;
1.2453247666971357;
1.2453808350116946;
1.2454372966028924;
1.2454948271321455;
1.2455497291676572;
1.2455980724012892;
1.2456447561127388;
1.2457009752594894;
1.2457660131489772;
1.2458196849735501;
1.2458470316816348;
1.2458677819223871;
1.245922073045105;
1.2460173411258824;
1.2461031842003636;
1.2461194168666576;
1.2460731186624074;
1.2460523591497172;
1.246144077472647;
1.246332048904467;
1.246486892794379;
1.246476438197272;
1.2463019096133174;
1.2461270563380096;
1.246155824249779;
1.2464516566831079;
1.2468539878961769;
1.2470763836836551;
1.2469235095313935;
1.2464627819251595;
1.2460123122247215;
1.2459381895503214;
1.246394000819909;
1.2471842422250758;
1.2478546894439841;
1.2479626707242373;
1.2473630489916367;
1.246331719491756;
1.2454420596152476;
1.2452567413154905;
1.2460051694819592;
1.2474251018256508;
1.2488616164043491;
1.2495787576605717;
1.2491272405348501;
1.247590764807679;
1.2455895555800296;
1.2440259329315309;
1.243685651452919;
1.2448775233344083;
1.247267170726305;
1.2499796722723082;
1.2519322916339537;
1.2522614518035218;
1.2506777264382904;
1.2476097199650833;
1.2440800054940064;
1.241357620479572;
1.2405086580803748;
1.2420073005248797;
1.245545845937654;
1.2501062863712922;
1.2542719052951508;
1.2566779135799715;
1.2564474547506723;
1.253478831837246;
1.2484984798263667;
1.2428664345783516;
1.2381907277151587;
1.2358713842886344;
1.2367030900383704;
1.2406404632185661;
1.2467952748456268;
1.2536565744426464;
1.259478379140328;
1.262717901819435;
1.2624210825599669;
1.258464427357495;
1.251599084469867;
1.2432866359437222;
1.2353699304246897;
1.2296669348329978;
1.2275643580512434;
1.2297087433525253;
1.2358648127361715;
1.2449563852110495;
1.255269205147235;
1.2648063643452725;
1.2716707913559586;
1.2744389595385694;
1.2724299844657283;
1.2658349148289203;
1.2556825940262277;
1.2436595088024387;
1.231809101134523;
1.222178805620079;
]

vQ1 = [0.0;
0.18436366804031093;
0.702476804866613;
1.4626174886551164;
2.347961029704691;
3.2494947927592683;
4.086796357331615;
4.813579185168099;
5.4126163314716775;
5.88648915749837;
6.248707088463449;
6.517148962033442;
6.7100225193207965;
6.8437831400015074;
6.932324267478079;
6.986884164558262;
7.016297060580519;
7.027371427532758;
7.025281046319559;
7.013916104447241;
6.996177574847725;
6.974212967895276;
6.949601343013277;
6.923494783273423;
6.8967261057203055;
6.869890490415469;
6.84340582208087;
6.817559257058925;
6.792541175088743;
6.768471284460528;
6.74541803923909;
6.723412746187026;
6.702460468740445;
6.682547935065981;
6.663649660165629;
6.64573076113469;
6.628752382493086;
6.6126722011218915;
6.597446672623716;
6.583032002269532;
6.569384874731627;
6.5564631712924735;
6.544226041557684;
6.5326342297715625;
6.521650167463102;
6.5112380083345425;
6.501363653368218;
6.491995066192149;
6.483101941044463;
6.474655784398935;
6.466629930179053;
6.458998984805168;
6.451739412469892;
6.44482887697149;
6.4382465952759445;
6.431973211182824;
6.4259904404596755;
6.420281550659673;
6.414830629139998;
6.409622925933378;
6.404644639003208;
6.399882931986169;
6.395325721264973;
6.390961399619842;
6.386779785768744;
6.382770994102306;
6.378925444134488;
6.375234788778326;
6.371691215087432;
6.368286765521466;
6.365014624749321;
6.361868585611901;
6.3588412034523;
6.355927576772671;
6.3531220190412965;
6.3504188515452;
6.347814031209768;
6.345302427708873;
6.342879451971696;
6.340541788923114;
6.338284566239665;
6.3361048379346645;
6.333999261552384;
6.331963756924493;
6.329996651258096;
6.328094044455194;
6.326253117259096;
6.324471855627792;
6.322746712922815;
6.3210765200699335;
6.319458337820548;
6.317889962768354;
6.316370312251473;
6.314896485237598;
6.3134675495071475;
6.312081052952992;
6.3107350812564915;
6.309428829920712;
6.308160342511194;
6.306929835641931;
6.30573458298842;
6.304573878822298;
6.303445656453091;
6.3023483565374985;
6.3012815638091375;
6.300243948298921;
6.299236211949587;
6.298256772894552;
6.297305371291664;
6.296384674166976;
6.29549461436521;
6.2946403092117915;
6.293814018826191;
6.293026771172482;
6.292258996647767;
6.291518816414112;
6.290783442434193;
6.290070039914738;
6.289368198114938;
6.2886895344346;
6.28802824104595;
6.287375206263934;
6.286749088881561;
6.286143133309237;
6.285549712521733;
6.2849663550988115;
6.284416369521834;
6.283873009304308;
6.283336688754365;
6.282813397290666;
6.282296892924096;
6.281807748448559;
6.281323052255811;
6.280823248589184;
6.2803455103077;
6.279871211458332;
6.27942158760726;
6.278992676342505;
6.278567057989708;
6.278140470483812;
6.277736074989788;
6.27734191635025;
6.276977709063342;
6.276632009520149;
6.2762887575940915;
6.275920959381141;
6.275542130307893;
6.2751729544789105;
6.274816022352535;
6.274480436524092;
6.274165874582335;
6.273843314516921;
6.273534089252586;
6.273235627345741;
6.272946026677197;
6.272651452055371;
6.272369021876175;
6.27209134861313;
6.271803995917686;
6.271517810516426;
6.2712536234401295;
6.271015945283988;
6.27074384602871;
6.270422470012736;
6.2701893172377545;
6.270118613484951;
6.270030081365548;
6.2695594976184825;
6.268899082480315;
6.268842214391409;
6.269566352292804;
6.269881351025878;
6.2685728756288315;
6.266551126350794;
6.266318460983255;
6.2687620742148145;
6.271252070951871;
6.270176272625029;
6.265303099591696;
6.261086811336602;
6.262534376378827;
6.26960470712544;
6.276063680500604;
6.2748062726606335;
6.264933968255085;
6.253741894539658;
6.251323976121751;
6.261706338053617;
6.278433142541218;
6.288588416598915;
6.282509829889046;
6.261873216674313;
6.239744446625812;
6.232125362243932;
6.246745244977896;
6.276848274292706;
6.304463775758164;
6.311159001247381;
6.289745128481255;
6.249556873415292;
6.212110376727834;
6.19937304227725;
6.221419682088104;
6.270138307353452;
6.322544848719935;
6.351939795112271;
6.341022872162998;
6.2908723693572695;
6.221596279905487;
6.1637219181385765;
6.144583017339889;
6.176133992471259;
6.249121568217786;
6.336252788823819;
6.402901190407065;
6.4206656201489505;
6.378742203210426;
6.288636030218751;
6.18044734880961;
6.092485756738216;
6.057639790578731;
6.091532803044725;
6.186724692976855;
6.314863071204812;
6.435810065989393;
6.510524150730238;
6.513381218872268;
6.440113276544839;
6.309306373529536;
6.157126985902458;
6.0267932408663984;
5.956329114911805;
5.967790028447622;
6.061120254967296;
6.214136810792103;
6.388581705068666;
6.540311360447597;
6.630410921161923;
6.634546410631322;
6.548724675178027;
6.3901674847932695;
6.1931676714868455;
6.001251768783093;
5.857502467048066;
5.7949962072791825;
5.82953891597141;
5.956531280168987;
6.15227529814877;
6.37867071191064;
6.591707318652727;
6.749797541552178;
6.821885196562894;
6.792866444064794;
6.665963287266502;
6.462006644133616;
6.215662732131488;
5.969182846179239;
5.765046448221891;
]


#

# T = 0, alpha = 1.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 14, omega_C = 5, jump = 10;
mQ2 = [0.0;
0.06187202198793929;
0.2403532540134229;
0.5160004853998426;
0.862001031318104;
1.249932885437438;
1.6543576294354503;
2.0553349056331527;
2.4390117675150944;
2.796968346766027;
3.125022908292603;
3.421980323650156;
3.688567126789907;
3.926627392479566;
4.138565942199873;
4.326978915845036;
4.494439100007571;
4.643372721366946;
4.775996452378074;
4.8943002366360835;
5.000045410683201;
5.094775040890194;
5.179836228103305;
5.256400713665098;
5.32548572551069;
5.387974188904583;
5.4446323860814925;
5.496126082192301;
5.543034389100735;
5.585861538133882;
5.625047411833148;
5.660977109473144;
5.693988119480195;
5.724372902117612;
5.752404773735264;
5.77830446540427;
5.802277681073731;
5.824502914615734;
5.84514266138867;
5.8643438556466565;
5.882232814326153;
5.898923009974551;
5.914519162461992;
5.929114076472266;
5.942789939572161;
5.955622468506447;
5.967678948177409;
5.9790193705909;
5.989700856660515;
5.999772092621034;
6.0092771876749795;
6.018259657939379;
6.026757415510106;
6.034804066232708;
6.0424304736509225;
6.049664801039362;
6.056534118949226;
6.063062742395687;
6.0692724378921765;
6.075183168783717;
6.080813900602334;
6.086181903130349;
6.091303322101694;
6.0961929640221815;
6.100864370444543;
6.105330314871743;
6.109602273413373;
6.113690873443714;
6.117606936122788;
6.121360130873459;
6.124958711137429;
6.128410582259975;
6.131723485081903;
6.13490446725964;
6.1379605615288995;
6.140898281121155;
6.143723388136576;
6.14644136250939;
6.149057824583113;
6.1515776976016046;
6.154005673043028;
6.156345833444095;
6.158601650802711;
6.160777597091943;
6.162878337547586;
6.164907652842597;
6.166866560888335;
6.168756420276041;
6.170581660148758;
6.172346849866513;
6.1740550252862;
6.1757095860220215;
6.177315704725386;
6.178876492903775;
6.1803896632402155;
6.181849689659693;
6.183253642900277;
6.184604625699729;
6.185909602849588;
6.187175461421674;
6.18840594190873;
6.1896043814871735;
6.190776218196567;
6.19192697337748;
6.193057306235356;
6.1941618065865365;
6.1952347103698004;
6.196276548383952;
6.1972938052680036;
6.198288233492951;
6.199248210461414;
6.200154654167545;
6.200998161303544;
6.201791041402668;
6.202560033306525;
6.203327881776603;
6.204099789314488;
6.204865426991843;
6.205614302112367;
6.206341840348977;
6.207040236253539;
6.207696899921836;
6.208309977953709;
6.208905805179822;
6.20953105879463;
6.2102218105941205;
6.210979798892483;
6.211775754897268;
6.212577538059195;
6.213368219424959;
6.214124392562988;
6.214795837101631;
6.215330796372584;
6.215725647215385;
6.216038742189905;
6.216349331394032;
6.216712273816326;
6.217139829953739;
6.2176029792995715;
6.2180552136966964;
6.218466796943473;
6.218837241734347;
6.2191730700527375;
6.2194662428439065;
6.219702505180117;
6.219890202007198;
6.220070929085965;
6.2202961248057465;
6.2206016706346245;
6.221005320768032;
6.221510021218676;
6.2221004249247045;
6.222750190819268;
6.223435331722313;
6.224132295525334;
6.224812433430369;
6.225452072323149;
6.226036599123094;
6.226546044293897;
6.226959615638783;
6.227291850458632;
6.227589834718198;
6.227860520257754;
6.228038790126102;
6.228082731304015;
6.22807384111258;
6.228138495816352;
6.228256742801287;
6.2282355355230115;
6.2279464802296145;
]

#T = 0, alpha = 1.25, N_chain = 190, maxdim = 90, cutoff = -11, tau = 0.001, boson_dim = 15, omega_C = 5, jump = 20;
vQ2 = [0.0;
0.9218183402501818;
3.5123840099213677;
7.313087397409677;
11.739805087830254;
16.24747372320589;
20.433980285362182;
24.06788988922682;
27.06306411572517;
29.43240548364186;
31.24345772165222;
32.58561304455057;
33.54990977386103;
34.21863100963597;
34.66136911632272;
34.93411791713933;
35.081059313454546;
35.13625321250117;
35.12551593817469;
35.06831459621728;
34.97934152161464;
34.869371030003556;
34.74617050649459;
34.615475788537296;
34.48139812844097;
34.34695000937465;
34.21425913343967;
34.0847587676231;
33.95942320723946;
33.838825626721814;
33.72329884370758;
33.61305318982038;
33.508160045312216;
33.40841046640903;
33.313957542825335;
33.22447582730596;
33.13971293436662;
33.05932355541509;
32.98312726372926;
32.91091822063828;
32.84250737355528;
32.7777649268473;
32.716581278233285;
32.65865951584854;
32.603692059433364;
32.551497743827014;
32.50193063905099;
32.454964640858975;
32.41043085231183;
32.368115609697796;
32.32790423889442;
32.28970017628575;
32.25341388685804;
32.218937707781194;
32.186029924057046;
32.154584432704524;
32.12444462842988;
32.09567505562228;
32.0683089158288;
32.04234766891586;
32.01754430405314;
31.99386771997628;
31.971176718208127;
31.949441030042806;
31.92857674741795;
31.90855369780339;
31.889259334103855;
31.870767391310395;
31.8530305537792;
31.83600064592426;
31.819649963356326;
31.80388153189709;
31.788646874832004;
31.77390353236453;
31.75963951917467;
31.7459764822893;
31.7327231485138;
31.72015990703072;
31.708059497745317;
31.696525081459193;
31.685366722643302;
31.6745922707831;
31.664140540544835;
31.654082481924256;
31.644282938930118;
31.634909509174037;
31.625686650793504;
31.61687401599493;
31.608105418041383;
31.59969710235172;
31.591376134660642;
31.583517082313264;
31.575943436492125;
31.568694494766262;
31.562112902559583;
31.555730289837342;
31.549704653543152;
31.542755253566988;
31.53634115049725;
31.529672235346588;
31.523566644008476;
31.517361809679763;
31.51161854860935;
31.506373839892447;
31.501953599219334;
31.498213541086876;
31.494078776013183;
31.489991330833156;
31.486106536286123;
31.48315393834445;
31.480393222597215;
31.47687174845006;
31.47195404095514;
31.466598568881686;
31.460952904243356;
31.45647807936041;
31.45321332338125;
31.45058174813373;
31.447698505489868;
31.44490066900957;
31.44228161830854;
31.43824853477181;
31.433127811249562;
31.42734271341235;
31.422495129178287;
31.420582693631694;
31.420814382877857;
31.421818957911327;
31.42274615868788;
31.424187743046055;
31.425795721738048;
31.427077261872398;
31.424786303446666;
31.41870478256125;
31.410622618945133;
31.403031501476278;
31.39860271265252;
31.397435385587627;
31.397406458907277;
31.397411373324353;
31.395790530886913;
31.393961047860046;
31.392386091364095;
31.390215224643477;
31.386081107438194;
31.380268974501057;
31.373365143303182;
31.367556492069696;
31.363458135682457;
31.361519865146924;
31.361671692552896;
31.363469453908273;
31.365711842825085;
31.368897050341907;
31.372175971505236;
31.375181886626834;
31.377343982674923;
31.37927667653657;
31.38021367894789;
31.37911990545411;
31.37621573372195;
31.37498980113144;
31.37635562418894;
31.375494308219032;
31.369030165028363;
31.360971623013008;
31.359586926219308;
31.36531577928475;
31.366037803403103;
31.35150472029278;
]



# T = 0.1, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -13, tau = 0.002, jump = 10, boson_dim = 9, omega = 5;
mQ1_T = [0.0;
0.012374318618985186;
0.048070314068892284;
0.10319937053575028;
0.1723990056808338;
0.24998489162043488;
0.3308694119020956;
0.4110645349991512;
0.48779967884184894;
0.5593908521371007;
0.6250016779366817;
0.6843930990715049;
0.7377103963436954;
0.7853223430503378;
0.8277094380602514;
0.8653913533636548;
0.8988828749823918;
0.9286692527632304;
0.9551941178366615;
0.9788551341555012;
1.000004187579402;
1.0189500376157565;
1.0359621375274475;
1.051274869401675;
1.0650917538966622;
1.0775893976449156;
1.0889210788693264;
1.0992199260867783;
1.1086017166773092;
1.1171672980014098;
1.1250046880355355;
1.1321908565321182;
1.138793287042151;
1.144871268806129;
1.1504770340533548;
1.1556567013338008;
1.1604510961166477;
1.1648964453986808;
1.1690249661993286;
1.1728653535637474;
1.176443225516117;
1.1797815204222113;
1.1829008230183862;
1.1858196285433966;
1.188554557776919;
1.1911205849423;
1.193531228226491;
1.1957987154848326;
1.1979341191569226;
1.19994747161868;
1.2018478599591613;
1.2036435218742818;
1.2053419474057678;
1.2069499716468786;
1.2084738478891928;
1.209919308199318;
1.2112916192866858;
1.2125956257970911;
1.2138357873284318;
1.2150162143828573;
1.2161406884298183;
1.2172126783292339;
1.2182353687269645;
1.2192117028838336;
1.2201444176568073;
1.2210360575642447;
1.2218889859809179;
1.2227053958843992;
1.2234873230203844;
1.2242366513767517;
1.2249551209007585;
1.2256443524517664;
1.226305881135197;
1.226941168763775;
1.2275515934526644;
1.2281384384421048;
1.2287028920017482;
1.2292460606007574;
1.2297689782550656;
1.2302726148078758;
1.2307578869470608;
1.2312256628097162;
1.2316767636221138;
1.2321119630843598;
1.2325319900782434;
1.232937533602361;
1.2333292497211823;
1.2337077577658888;
1.234073636533037;
1.2344274275971703;
1.2347696431609796;
1.2351007722305412;
1.2354212848775177;
1.2357316322570897;
1.2360322499778749;
1.236323551610315;
1.2366059279853974;
1.2368797397682247;
1.237145326749038;
1.2374030076905824;
1.237653088611504;
1.2378958654766035;
1.2381316256343764;
1.2383606434950793;
1.2385831804719645;
1.2387994834165026;
1.2390097864967096;
1.2392143120418189;
1.2394132725072462;
1.239606880698621;
1.2397953356154028;
1.2399788354862418;
1.2401575610891684;
1.240331683636026;
1.240501365163177;
1.2406667604178472;
1.240828018085036;
1.2409852798750247;
1.2411386783534486;
1.2412883408849436;
1.2414343916716504;
1.2415769665548624;
1.241716196179053;
1.2418522067895614;
1.2419851156158461;
1.2421150313341975;
1.2422420560161047;
1.2423662876149115;
1.242487820971362;
1.2426067508702772;
1.2427231697789585;
1.242837169170323;
1.24294883830321;
1.2430582607174299;
1.2431655200046243;
1.2432707000068508;
1.2433738833664458;
1.243475143667397;
1.2435745466591022;
1.2436721508950384;
1.2437680169475012;
1.2438622058501096;
1.2439547765594365;
1.2440457879087776;
1.2441352968230075;
1.2442233614220717;
1.2443100390289108;
1.2443953886628298;
1.2444794660698775;
1.244562324595921;
1.2446440158994394;
1.2447245906761712;
1.2448040968780312;
1.244882577833931;
1.244960074671307;
1.2450366293357953;
1.2451122867094058;
1.2451870887433123;
1.2452610815164515;
1.2453343092476403;
1.2454068132841927;
1.2454786294583509;
1.2455497874749437;
1.2456203127898746;
1.2456902300334407;
1.245759563073203;
1.245828340013404;
1.2458966001460197;
1.2459643816767687;
1.2460316937082525;
1.24609852970359;
1.2461649811467788;
1.246231222486551;
1.2462971730097328;
1.2463623647959052;
1.2464267949697325;
1.246491733623493;
1.2465580346147906;
1.246623348844235;
1.2466843333481126;
1.2467437668042693;
1.246810244840912;
1.246884569362351;
1.2469519132280509;
1.2469998216231026;
1.2470428407404286;
1.2471123512291475;
1.2472132082921572;
1.2473041552317383;
1.2473401076324064;
1.2473343671020105;
1.2473610574567526;
1.2474793700098126;
1.2476560556165524;
1.2477788074552154;
1.2477632060740025;
1.247651950908327;
1.247599387665469;
1.2477393171169353;
1.248049896313887;
1.2483439439993125;
1.2484090952992948;
1.248190703590743;
1.247864785528996;
1.2477291982248784;
1.2479840136474782;
1.2485624732589655;
1.2491438034085462;
1.2493531370150361;
1.2490207083916829;
1.248324512193176;
1.2477120797331112;
1.247638978470672;
]

vQ1_T = [0.0;
0.18468688731802607;
0.7037679079314868;
1.4655161380695172;
2.3530991755390502;
3.25749383414442;
4.098263716413027;
4.829104707237392;
5.432769141416606;
5.911815308940277;
6.279727876989137;
6.554359507333737;
6.7538904590585265;
6.894747598203768;
6.990794827434325;
7.053239608739818;
7.09088450142768;
7.110505746696432;
7.1172445888744775;
7.114958653463272;
7.1065166321674464;
7.094034669145406;
7.079060975608004;
7.062717943518319;
7.045809845320058;
7.02890440298301;
7.012393779983529;
6.996540600731426;
6.981512011402721;
6.967405781961872;
6.954270177964502;
6.942116234559097;
6.930931574395357;
6.920686532622136;
6.911340445738878;
6.902845589992923;
6.89515041628452;
6.888203003991532;
6.88195122158141;
6.8763431505306265;
6.871327548886466;
6.866856618006683;
6.862886367152255;
6.859374992120915;
6.8562830586135926;
6.853573003880421;
6.851210410879068;
6.849163705793892;
6.8474041119036;
6.8459049387382995;
6.844641107027979;
6.843588465813363;
6.842724316645436;
6.842028600488142;
6.841483136709455;
6.8410718021979395;
6.84078018474593;
6.840595461671843;
6.840505741727748;
6.8405013480186785;
6.840573095304032;
6.840711931771394;
6.840908582729791;
6.841155004715603;
6.841444726826537;
6.8417721731180094;
6.842132452017897;
6.8425209281036805;
6.842933678174491;
6.84336677249961;
6.843815495362104;
6.844275559635035;
6.844744263327069;
6.845220323667283;
6.845702808745413;
6.846190371646846;
6.84668132253109;
6.847173735364034;
6.847666110959906;
6.848156946201634;
6.848645128196302;
6.849129892930488;
6.84961038316902;
6.850086062166305;
6.850556491488563;
6.851021023079454;
6.851479691509148;
6.851932425812532;
6.852378928095927;
6.852818320059399;
6.853250456930961;
6.853674745332047;
6.854091329018612;
6.854500390395538;
6.854902252810849;
6.855297195628715;
6.855685585417713;
6.85606747654903;
6.856442528396855;
6.856810438888111;
6.857170810828625;
6.857523798455478;
6.8578697786326135;
6.85820892701595;
6.8585413445420915;
6.858867168828342;
6.859186293209835;
6.859498541842527;
6.859803730904476;
6.8601022886888146;
6.860394572242539;
6.860680977023291;
6.860961716480843;
6.861239566948465;
6.861518502430126;
6.861797508619557;
6.862078929983494;
6.862363038428956;
6.862634634289703;
6.862906866455023;
6.863177141133562;
6.863441637868144;
6.863691168541193;
6.863938217754012;
6.864194684823602;
6.864444633015875;
6.864693644352416;
6.864931157364219;
6.865161817358077;
6.865397307459139;
6.865638574729524;
6.865869830312423;
6.866086819776042;
6.866300194206833;
6.866509134503877;
6.866717604149366;
6.866928800271305;
6.867135486011136;
6.8673300815840586;
6.867511990074831;
6.867689767142957;
6.867872086398509;
6.868059419798351;
6.868238546121017;
6.868406066531637;
6.868576879408922;
6.8687414437055185;
6.868908323159577;
6.8690733026030975;
6.869235207934118;
6.869389876396832;
6.869535500952878;
6.869668618316868;
6.869792415841432;
6.869911889232655;
6.870035503525851;
6.870157750094119;
6.870273911995964;
6.870393620553493;
6.870502003641858;
6.870602903050407;
6.8707131261951275;
6.870820063574591;
6.870915244002833;
6.87099848901598;
6.871072098735734;
6.8711347793053;
6.8712037850954575;
6.87129453087541;
6.871394434242965;
6.87149417305612;
6.871586774245298;
6.871682032158274;
6.871772373020198;
6.871839339789241;
6.871851340226005;
6.871885234742663;
6.872045564856162;
6.872205152930807;
6.872087536861427;
6.87177084648254;
6.871865325591941;
6.872592931166834;
6.873092093151353;
6.872359187402417;
6.871042382968066;
6.871124779166738;
6.873274095433516;
6.875270127694478;
6.874259239928374;
6.870492807266984;
6.867915089124325;
6.8701897783813335;
6.876160110563131;
6.88009215004181;
6.877073798683359;
6.868504010219679;
6.861819700645213;
6.864132490709012;
6.875309821209086;
6.886982330653194;
6.888835510786751;
6.877335707250115;
6.859591059881316;
6.848849653490695;
6.854782898776693;
6.875714734590528;
6.89863688283425;
6.907398136751589;
6.893741486101575;
6.86367646791281;
6.834744643210127;
6.825681006567461;
]

# T = 0.1, alpha = 1.25, N_chain = 160, maxdim = 100, cutoff = -12, tau = 0.001, jump = 20, boson_dim = 14, omega = 5;
mQ2_T = [0.0;
0.061876121063326454;
0.2403432126259555;
0.5158971957332096;
0.8616717362097187;
1.2492345714170874;
1.6531918078525827;
2.0536893372187515;
2.4369768213790066;
2.7947281291582917;
3.1228286798192126;
3.4201159554790763;
3.6873148255234507;
3.9262387804509937;
4.139239035440522;
4.328850365133573;
4.497578801352099;
4.647784905427228;
4.781628010530122;
4.9010473373675465;
5.007764108050523;
5.103295003993677;
5.188970921036853;
5.265957068272965;
5.33527237932187;
5.397807671867066;
5.4543420399359865;
5.505557212165276;
5.552050115321288;
5.594343936018823;
5.632897929783758;
5.668115963233601;
5.700353666761501;
5.7299242822203995;
5.757103783056777;
5.782135729484353;
5.8052355690722965;
5.826594103409456;
5.846380422290143;
5.864744670327408;
5.881820366559023;
5.8977261390216364;
5.9125673570937;
5.926437892887346;
5.939421648629691;
5.9515936866374854;
5.963021314993118;
5.973765152618734;
5.983879948364044;
5.993415083339804;
6.0024148258567545;
6.01091863122722;
6.018961749353439;
6.026576152696572;
6.03379125154528;
6.040634167903831;
6.04712984415429;
6.0533010946988925;
6.059168690985691;
6.064751465064263;
6.070066500485009;
6.075129339233548;
6.079954087712814;
6.084553497660946;
6.088939390512236;
6.093123247740073;
6.097116342577296;
6.100929431727427;
6.104572480500708;
6.108054411081249;
6.111382916995894;
6.114564790889987;
6.117606688119546;
6.120515584892579;
6.123298393032438;
6.125961466406067;
6.128510554291325;
6.1309511028410135;
6.133288346650218;
6.135527143188022;
6.137671949549099;
6.139727048274446;
6.14169671345958;
6.143585104518326;
6.145396066407169;
6.147133176960027;
6.148799995651854;
6.150400180471786;
6.151937411822726;
6.153415316141468;
6.154837279928538;
6.1562063343228;
6.157525228305084;
6.158796565140099;
6.160022813104205;
6.161206321949234;
6.162349497010606;
6.163454959795747;
6.16452548281689;
6.165563731770956;
6.1665720221294595;
6.167552330107742;
6.168506567690655;
6.169436654303303;
6.170344213801158;
6.171230640736354;
6.172097737425451;
6.172948042970764;
6.173784330472812;
6.174608903625383;
6.175423445643671;
6.176229175804415;
6.177026998270219;
6.17781785348987;
6.178602825587352;
6.179383057068224;
6.1801599031373975;
6.180935074331082;
6.181710345255664;
6.182487358480411;
6.1832677120791875;
6.184052902864121;
6.184844026787544;
6.185641821199564;
6.186446959719352;
6.1872603505865795;
6.188083203648626;
6.1889167792885935;
6.189762044090103;
6.190619677498067;
6.191490154276355;
6.192373760343462;
6.193270900435566;
6.1941823592551835;
6.1951090997827585;
6.196052054645656;
6.197012258377904;
6.197990820407371;
6.198988733071259;
6.200006803172257;
6.20104575912117;
6.202106233147333;
6.203188450320603;
]

vQ2_T = [0.0;
0.9236081104893519;
3.5191091448344713;
7.3270914071828335;
11.76323532030932;
16.28335102132784;
20.486886569631444;
24.14388245995138;
27.168912067943822;
29.574599964177644;
31.427531688001793;
32.81565320605122;
33.82847294772037;
34.54694014504434;
35.03940949442148;
35.36130734163329;
35.55636514047434;
35.6583962374451;
35.69335983044212;
35.68089389624974;
35.63574043896515;
35.56894797357877;
35.488669357689034;
35.40094067435695;
35.310078157733834;
35.2192095778468;
35.13049223782733;
35.04541450079466;
34.96494188470297;
34.889613669505096;
34.819688342378335;
34.755246760000716;
34.69622489045231;
34.64247210202298;
34.5937201249753;
34.54967906410387;
34.51004690765767;
34.47453801815631;
34.442840255213774;
34.414659375822545;
34.38970524666916;
34.36768345718442;
34.34831895602257;
34.33135542842994;
34.316569894624905;
34.30376453407052;
34.29273993765781;
34.28332195592296;
34.27535281225247;
34.268697815486846;
34.263248940387555;
34.258880283534545;
34.255460502945546;
34.25287885086402;
34.25102478625273;
34.24984959326711;
34.249265681766;
34.24920911203785;
34.2496466781039;
34.250542104992874;
34.251847357081395;
34.25351884189729;
34.255501910914596;
34.25775564870103;
34.26022984352055;
34.26288466280663;
34.265702883927865;
34.268677138871546;
34.27181185302859;
34.275111825980105;
34.278533325828754;
34.28202950712749;
34.28555293305397;
34.28910486800539;
34.29270295632075;
34.29634533577565;
34.30001099009925;
34.30369037508768;
34.30739100686342;
34.31109500969503;
34.314778746786864;
34.31844108496609;
34.32206947917752;
34.32567353903901;
34.32924242532917;
34.33276434783901;
34.33621810249309;
34.33961037975796;
34.3429378688917;
34.346205621552144;
34.349411467973106;
34.352556453733115;
34.355636116696026;
34.3586482673911;
34.3615860551899;
34.36443371422606;
34.367177768600286;
34.369824394729264;
34.37238875325958;
34.3748787239283;
34.37727900640171;
34.37957791977738;
34.38177789748643;
34.383883094407835;
34.38588592288255;
34.38774861561954;
34.38946081168676;
34.39105107452099;
34.3925641603655;
34.394014780899326;
34.39540529371705;
34.39671770333941;
34.39792641319946;
34.39902205440446;
34.39999352022769;
34.40083015562485;
34.40152747289837;
34.40209816626772;
34.402554972704515;
34.402918555346815;
34.40319064585684;
34.40339546591552;
34.40353525119124;
34.40358707213144;
34.403529920532804;
34.40336003950109;
34.40308730290328;
34.40272952075639;
34.40229425464953;
34.401776233108556;
34.40117016517263;
34.40046043630063;
34.39964162589917;
34.398721858421666;
34.397716749029215;
34.39661999841336;
34.395439042307025;
34.394184424889325;
34.392868457455975;
34.391492051900826;
34.39007623624216;
34.38863085866473;
34.38716321745167;
]

#= 
num = 48
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]

 =#
ω_C = 5


# Time step duration
tau = 0.002


time_steps = collect(0:305) * 0.02 * ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks1 = (2:6:14) 
xticks2 = (2:6:14)
xticks3 = (2:6:15) 
xticks3sub = (10:4:15) 

yticks1 = (0:3:6) #range(0, stop = 6, length = 3)
yticks2 = (0:15:30) #range(0, stop = 30, length = 3)
yticks3 = (5:4:12) #range(4, stop = 10, length = 4)
yticks3sub = range(4.5, stop = 5.5, length = 2)

#xtick_labels1 = [string(round(x, digits = 1)) for x in xticks1]
    xtick_labels1 = [" " for x in xticks1]

xtick_labels2 = [string(Int(round(x, digits = 1))) for x in xticks2]
xtick_labels3 = [string(Int(round(x, digits = 1))) for x in xticks3]
xtick_labels3sub = [string(Int(round(x, digits = 1))) for x in xticks3sub]
ytick_labels1 = [string(Int(round(y, digits = 1))) for y in yticks1]
ytick_labels2 = [string(Int(round(y, digits = 1))) for y in yticks2]
ytick_labels3 = [string(Int(round(y, digits = 1))) for y in yticks3]
ytick_labels3sub = [string((round(y, digits = 1))) for y in yticks3sub]


ω_C = 5
f(t, α) = α*ω_C*(t)^2 /(1+t^2)
#= 
g(ω, t, β) = (1-cos(ω*t)*coth(β*ω/2)*2*α*ω*exp(-ω/ω_C))
vQ(t, α, β) = 0.5 .* [quadgk(g(ω, t[i], β), 0, 10^7) for i in 1:lastindex(t)] =#
#= 
g(ω, t, β, α) = (1 - cos(ω * t)) * coth(β * ω / 2) * 2 * α * ω * exp(-ω / ω_C)
vQ(t, α, β) = 0.5 .* [quadgk(ω -> g(ω, t[i], β, α), 0, 10^7)[2] for i in 1:lastindex(t)]
 =#


function vQ(t, α, β, ω_C=5)
    g(ω, t) = (1 - cos(ω * t/ω_C)) * coth(β * ω / 2) * 2 * α * ω * exp(-ω / ω_C)
    return 0.5 .* [quadgk(ω -> g(ω, t[i]), 0, 1e5)[1] for i in eachindex(t)]
end



mQ1_exact = f.(time_steps, 0.25)
mQ2_exact = f.(time_steps, 1.25)
mQ1_T_exact = f.(time_steps, 0.25)
mQ2_T_exact = f.(time_steps, 1.25)

vQ1_exact = vQ(time_steps, 0.25, 100000)
vQ2_exact = vQ(time_steps, 1.25, 100000)
vQ1_T_exact = vQ(time_steps, .25, 1)
vQ2_T_exact = vQ(time_steps, 1.25, 1)

# Plot
gap = 10
markersize = 3.5

p1 = plot(time_steps, mQ1_exact, color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, mQ2_exact, color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, mQ1_T_exact, color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, mQ2_T_exact, color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:gap:length(mQ1)], mQ1[1:gap:end], markersize=markersize, markerstrokewidth=.8, xaxis = "", 
xticks = (xticks1, xtick_labels1), yticks = (yticks1, ytick_labels1),
xtickfont = font(14), ytickfont = font(14),
xguidefontsize = 20, yguidefontsize = 17, color = :lightblue) 
scatter!(time_steps[1:gap:length(mQ2)], mQ2[1:gap:end],markersize=markersize, markerstrokewidth=.8,  color = :teal) 
scatter!(time_steps[5:gap:length(mQ1_T)], mQ1_T[5:gap:end], markersize=markersize, markerstrokewidth=.8,  color = :lightcoral)
scatter!(time_steps[5:gap:length(mQ2_T)], mQ2_T[5:gap:end], markersize=markersize, markerstrokewidth=.8, color = :brown)
plot!(yaxis = L"⟨Q⟩")
plot!(legend = false)
xlims!(0, 14)  
ylims!(0, 7)  
plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(bottom_margin = -8mm)
annotate!(13.3, 5.2, text("(a)", 12, :black, :right))
ticks_length!(tl=.03)


gap = 7
markersize = 3.5
p2 = plot(time_steps, vQ1_exact, color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, vQ2_exact, color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, vQ1_T_exact, color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, vQ2_T_exact, color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:gap:length(vQ1)], vQ1[1:gap:end], markersize=markersize, markerstrokewidth=.6,  xaxis = "", 
xticks = (xticks2, xtick_labels2), yticks = (yticks2, ytick_labels2),
xtickfont = font(14), ytickfont = font(14),
xguidefontsize = 20, yguidefontsize = 17, color = :lightblue) 
scatter!(time_steps[1:gap:length(vQ2)], vQ2[1:gap:end],markersize=markersize, markerstrokewidth=.8, color = :teal) 
scatter!(time_steps[2:gap:length(vQ1_T)], vQ1_T[2:gap:end], markersize=markersize, markerstrokewidth=.8,  color = :lightcoral)
scatter!(time_steps[2:gap:length(vQ2_T)], vQ2_T[2:gap:end], markersize=markersize, markerstrokewidth=.8,  color = :brown)
plot!(widen = false)
xlims!(0, 14)  
ylims!(0, 38)  
plot!(yaxis = L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel = false)
vline!([xlims(p2)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p2)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(legend = false)
annotate!(13.3, 26, text("(b)", 12, :black, :right))
ticks_length!(tl=.03)
plot!(xaxis = L"tω_C")

gap = 8
markersize = 3.3

p3 = scatter([], [],
    label = L"\ \ 0.0 \ \ 0.25",
    markersize = 1,     # 👈 different marker size!
    color = :lightblue, markerstrokewidth=.2
)

scatter!([], [],
    label = L"\ \ 0.0 \ \ 1.25",
    markersize = 1,     # 👈 different marker size!
    color = :teal, markerstrokewidth=.2
)

scatter!([], [],
    label = L"\ \ 1.0 \ \ 0.25",
    markersize = 1,     # 👈 different marker size!
    color = :lightcoral, markerstrokewidth=.2
)

scatter!([], [],
    label = L"\ \ 1.0 \ \ 1.25",
    markersize = 1,     # 👈 different marker size!
    color = :brown, markerstrokewidth=.2
)

plot!(time_steps[10:end], vQ1_exact[10:end]./mQ1_exact[10:end], color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], vQ2_exact[10:end]./mQ2_exact[10:end], color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], vQ1_T_exact[10:end]./mQ1_T_exact[10:end], color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], vQ2_T_exact[10:end]./mQ2_T_exact[10:end], color = :brown, seriesalpha = 1, linewidth = 2, label = false)
scatter!(time_steps[1:gap:length(vQ1)], vQ1[1:gap:end] ./ mQ1[1:gap:end], color = :lightblue, xticks = (xticks3, xtick_labels3), yticks = (yticks3, ytick_labels3), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 20, yguidefontsize = 20, seriesalpha = 1, xaxis = L"tω_C", markersize=markersize, markerstrokewidth=.6, label = "")
scatter!(time_steps[2:gap:length(vQ2)], vQ2[2:gap:end] ./ mQ2[2:gap:end], markersize=markersize, markerstrokewidth=.6, color = :teal, label = "")
scatter!(time_steps[3:gap:length(vQ1_T)], vQ1_T[3:gap:end] ./ mQ1_T[3:gap:end], markersize=markersize, markerstrokewidth=.6, color = :lightcoral, label = "")
scatter!(time_steps[4:gap:length(vQ2_T)], vQ2_T[4:gap:end] ./ mQ2_T[4:gap:end],markersize=markersize, markerstrokewidth=.6, color = :brown, label = "")
plot!(widen = false)
ylims!(4, 10)  
xlims!(0, 14)  
vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false, ymirror = true)
#plot!(legend = false)
annotate!(16.5, 7, text(L"F", 18, :black, :right))
ticks_length!(tl=.02)
annotate!(13.4, 9.7, text("(c)", 12, :black, :right))

plot!(legend = true)
#plot!(legend = :topright)
plot!(legend = (.6,.83), grid = false, legendfontsize = 12)
plot!(legendtitle=L"\ \ \ \ T \ \ \ \ \ \alpha", legendtitlefontsize=12)
plot!(foreground_color_legend = RGBA(0, 0, 0, 0.1), background_color_legend =  RGBA(0, 0, 0, 0))
#
#= 
plot!(p3, inset=bbox(0.35,0.01,0.42, 0.6), subplot=2)
gap = 5
markersize = 4
scatter!(p3[2], time_steps[50:gap:length(vQ1)], vQ1[50:gap:end] ./ mQ1[50:gap:end], color = :lightblue, xticks = (xticks3sub, xtick_labels3sub), yticks = (yticks3sub, ytick_labels3sub), xtickfont = font(12), ytickfont = font(12),
	xguidefontsize = 10, yguidefontsize = 15, seriesalpha = 1, xaxis = "", markersize=markersize, markerstrokewidth=.6,) #, label = L"\  (1, 1.5)")
scatter!(p3[2], time_steps[50:gap:length(vQ2)], vQ2[50:gap:end] ./ mQ2[50:gap:end], markersize=markersize, markerstrokewidth=.6, color = :teal) #, label = L"\ (0.1, 0.75)")
scatter!(p3[2], time_steps[50:gap:length(vQ1_T)], vQ1_T[50:gap:end] ./ mQ1_T[50:gap:end], markersize=markersize, markerstrokewidth=.6, color = :lightcoral)
scatter!(p3[2], time_steps[50:gap:length(vQ2_T)], vQ2_T[50:gap:end] ./ mQ2_T[50:gap:end], markersize=markersize, markerstrokewidth=.6, color = :brown)
ylims!(p3[2], 4.4, 5.9)  
xlims!(p3[2], 7, 14)  
plot!(p3[2], grid = false)
plot!(p3[2], legend = false, aspect_ratio = 5., framestyle = :box)	 =#



custom_layout = @layout [[a{0.5h}; b{1.35w}] c{0.6w}]
p = plot(p1, p2, p3, layout = custom_layout, size = (600, 400), left_margin = 5mm, right_margin = 9mm)



#p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png", p)

