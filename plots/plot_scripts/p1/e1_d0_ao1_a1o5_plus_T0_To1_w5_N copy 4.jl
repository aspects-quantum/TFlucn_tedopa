using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


T = 0.1
α = 0.5

# T = 0, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 11, omega_C = 5, jump = 10;

mQ1 = [0.0, 0.012375223685610925, 0.048068635170946346, 0.10317932320890462, 0.1723338720063597, 0.24984609153550583, 0.33063875213091404, 0.41074483699431946, 0.4874210168721017, 0.5590119669007166, 0.6247075862348143, 0.6842903123832982, 0.7379210302691748, 0.7859781429916004, 0.8289463661777903, 0.867345021913076, 0.9016849326916451, 0.932444696400465, 0.9600594136062099, 0.9849170182179238, 1.0073590012215792, 1.0276835143136154, 1.04614952528716, 1.062981250172937, 1.0783725049949031, 1.092490801750197, 1.1054810220941318, 1.117468604367675, 1.1285623214915728, 1.1388566934635507, 1.1484340565566673, 1.1573663289685705, 1.165716509309116, 1.1735399411312106, 1.1808853340969134, 1.1877956475474627, 1.194308986806221, 1.2004593432218018, 1.2062770074156661, 1.2117888352181954, 1.217018648686408, 1.2219877646650121, 1.226715356645001, 1.2312187060530877, 1.2355135471723415, 1.2396143506165769, 1.2435343607167768, 1.2472855514386925, 1.2508787498829683, 1.2543237864624053, 1.2576295236612205, 1.2608039383562353, 1.263854355930901, 1.2667876683565624, 1.2696103514822357, 1.2723283624449675, 1.274947028950224, 1.2774710876487427, 1.2799049533206401, 1.2822529810706924, 1.2845194482583047, 1.2867083777770012, 1.2888235004636948, 1.2908682366745814, 1.2928456088525284, 1.2947582838510308, 1.2966087855390585, 1.2983996312146424, 1.300133372852176, 1.3018125671071337, 1.3034394990439782, 1.3050159804440626, 1.3065435682481978, 1.3080238847327106, 1.3094586322018744, 1.3108494462571125, 1.3121978554909042, 1.3135052609682643, 1.3147729926777763, 1.3160024451609391, 1.3171951605012988, 1.318352750195799, 1.3194766615912081, 1.3205680397116066, 1.3216277153887463, 1.3226562392661176, 1.3236540336982154, 1.3246217428296438, 1.3255604809599335, 1.3264716579328029, 1.3273565280428288, 1.3282158979140861, 1.3290502927806682, 1.3298602747990635, 1.3306466032096165, 1.3314102084202581, 1.332151920772191, 1.3328721857687638, 1.3335711468558826, 1.3342489559133992, 1.3349059774922363, 1.3355429234203033, 1.3361607719478414, 1.3367604568704126, 1.3373426749108237, 1.3379078344980622, 1.3384561512775799, 1.338987941687552, 1.3395037696512921, 1.340004204317717, 1.3404896243610278, 1.3409603238966552, 1.3414165305386856, 1.3418582084689403, 1.342285082425371, 1.3426971393374239, 1.3430950208342523, 1.3434797837450796, 1.3438523072759327, 1.3442128910841855, 1.3445614458552955, 1.344898018437698, 1.3452229858317242, 1.3455368834475905, 1.3458403732294901, 1.3461344113753453, 1.3464200551248682, 1.3466979579685907, 1.3469680254118175, 1.3472294252994308, 1.3474810421396435, 1.3477221167003575, 1.3479525950614442, 1.3481729600797228, 1.3483837509227428, 1.3485852241763516, 1.3487773284870153, 1.3489600849834955, 1.3491340992929628, 1.3493004719850792, 1.349460239713655, 1.3496139893455896, 1.3497619397561091, 1.349904155893971, 1.350040456170482, 1.350170294005883, 1.3502931157821607, 1.350408862880868, 1.3505179093464592, 1.3506206862449173, 1.350717543870465, 1.3508089173110047, 1.3508955668901148, 1.3509784089799894, 1.3510578060201937, 1.351132999354332, 1.3512025776010808, 1.351265665751295, 1.351322409232017, 1.3513734078395783, 1.3514191008870826, 1.351459896782691, 1.351496550810607, 1.3515299391038529, 1.3515605720493133, 1.351588553518728, 1.3516138534303908, 1.3516364676376047, 1.3516562446297933, 1.3516727235027075, 1.351685287444084, 1.3516934003145713, 1.3516967210150335, 1.3516952726045017, 1.3516896610188514, 1.3516808134901017, 1.351669392412839, 1.3516555673126633, 1.3516389808230584, 1.351618939163421, 1.3515951487249607, 1.351568256786436, 1.351539473198841, 1.3515096209757893, 1.3514785977443144, 1.3514457693621977, 1.3514106978238882, 1.351373414644379, 1.3513341462671233, 1.3512928579259613, 1.351249047302784, 1.3512021295621934, 1.3511521333004592, 1.3510997123827562, 1.3510454056728514, 1.3509892890349113, 1.350931308668821, 1.35087175092779, 1.3508112418831677, 1.3507502442082684, 1.3506887653241086, 1.3506266023463582, 1.3505636289958383, 1.350499638512385, 1.3504340449437542, 1.3503661907407511, 1.350296087135019, 1.3502245323635462, 1.3501524091347379, 1.3500799767744915, 1.3500068545329558, 1.3499325685510946, 1.3498569284278716, 1.3497798347303518, 1.3497009771323116, 1.34961994113767, 1.3495365695988124, 1.3494512295725403, 1.3493649314150582, 1.34927901394307, 1.3491943836189548, 1.349110979473069, 1.3490280595983226, 1.3489449367226225, 1.3488613511378376, 1.348777323214522, 1.3486929575153233, 1.3486084212340854, 1.348523618772206, 1.3484376337892487, 1.3483493532625568, 1.3482591351435258, 1.348168549409755, 1.3480776064637359, 1.3479841936031438, 1.347888270182054, 1.3477946269847565, 1.3477078499358082, 1.3476250153129248, 1.3475375340313533, 1.347442205444634, 1.3473473543109935, 1.3472636429643103, 1.347188916111526, 1.3471070444953388, 1.3470055397894618, 1.3468927106645279, 1.3467926854637788, 1.3467206396612932, 1.3466638816394882, 1.3465904317080157]



vQ1 = [0.0, 0.18439723914913536, 0.7025255182386162, 1.4624967907004292, 2.3474349623610236, 3.2485102099298193, 4.0856816218642384, 4.813111742978808, 5.413956509355543, 5.891035067703516, 6.257933598417902, 6.5324724011093265, 6.732696897763471, 6.87484024686344, 6.9725106239497805, 7.036721155331404, 7.076078695235681, 7.097184435429088, 7.105054819385255, 7.103446083483259, 7.095145669618382, 7.082215191789797, 7.066167285896416, 7.048107772941243, 7.028839788842946, 7.00894410370539, 6.988839708373328, 6.968817607989158, 6.949073077583028, 6.929732917497746, 6.910893826431099, 6.892609088933988, 6.874903655531038, 6.857788331259513, 6.841259069492175, 6.825308076093365, 6.809911789754079, 6.795062162065397, 6.780745603204549, 6.766939026789756, 6.753605203594569, 6.740714050733462, 6.728242742507343, 6.7161649266516905, 6.7044571866414815, 6.693106768110614, 6.682097036533482, 6.671419200337061, 6.661056761586618, 6.6509986733233495, 6.641217591017429, 6.631694146068061, 6.622409830167009, 6.613354589201025, 6.604520392337081, 6.595909264526581, 6.58750092953052, 6.579271937281389, 6.571208134797694, 6.563298169878581, 6.555547722139475, 6.547955776718813, 6.540517690778187, 6.533228189328851, 6.526081461249789, 6.519065879468059, 6.512164453321569, 6.505373387206632, 6.498694266860227, 6.492137974324869, 6.485714749301012, 6.479400520289678, 6.473178703774453, 6.467038776061562, 6.460987738339881, 6.455024308411877, 6.449148127737221, 6.443352888346305, 6.437630884619111, 6.431979478744166, 6.426399071699041, 6.420899457482095, 6.4154956582064475, 6.410181546752521, 6.404947434496869, 6.399778531247186, 6.39465527644858, 6.389566493822425, 6.384526255544637, 6.379554464804946, 6.374665568188213, 6.36985107654242, 6.365089751214066, 6.3603723407543225, 6.3556995797709925, 6.351087509395221, 6.3465521962284015, 6.342086211142346, 6.337670358173325, 6.3332911819539675, 6.328932382356714, 6.3246008998950245, 6.320315114028182, 6.316090302789206, 6.31193038655403, 6.307831888859782, 6.3037784751691, 6.299758417472047, 6.295780440268935, 6.291855150124458, 6.287977848894586, 6.2841493982593555, 6.280377054197883, 6.276651038171438, 6.272937399872557, 6.269216134844088, 6.265500880064545, 6.2618267201025, 6.258217565510768, 6.2546659202544825, 6.2511509079044405, 6.247655546625595, 6.24417979466303, 6.240726005155006, 6.237296591341213, 6.233910563945904, 6.230604255088819, 6.2274000320814995, 6.224284731979026, 6.221220535971992, 6.218159822151016, 6.215075127236203, 6.211974132461462, 6.208887082597558, 6.205838329458255, 6.202826483811016, 6.199826552420276, 6.196814566994788, 6.19379410671448, 6.190801512813924, 6.187867823137764, 6.1850020462197834, 6.1821965805715315, 6.179448860385881, 6.176752667240234, 6.1740784017332215, 6.171398744949599, 6.1687122673949055, 6.16603675257708, 6.163378619391192, 6.160737795536437, 6.1581089546378465, 6.15551610027317, 6.152995115888421, 6.150572629488104, 6.148211438719294, 6.145845554180803, 6.143442198963543, 6.141016292547997, 6.138599584538614, 6.1361972146362405, 6.1337980343503, 6.13141693456553, 6.129083282807456, 6.12680841921769, 6.124582364478384, 6.1223963553846765, 6.12025142089581, 6.118149964370638, 6.116082735217036, 6.1140283355495075, 6.111976281113404, 6.109907051919339, 6.107814505568589, 6.105718838510855, 6.103653462671892, 6.101632209724519, 6.099660516438227, 6.097724526853758, 6.095778641587908, 6.0937958131813135, 6.091799658200413, 6.089847930371183, 6.087978070932143, 6.086175662627071, 6.084399841514653, 6.08262486711361, 6.080854878216493, 6.07910714783986, 6.077391368214943, 6.075690250641256, 6.073972109117818, 6.072233232904961, 6.070507368648677, 6.068808927660861, 6.067131186326454, 6.065455239649834, 6.063786686965677, 6.062152068440836, 6.060566967208067, 6.059020431075767, 6.057494913437134, 6.05599358555397, 6.054515031420733, 6.053045191296665, 6.051553291576076, 6.050040012378164, 6.048541589881221, 6.047098113748364, 6.045710666252216, 6.044345956404026, 6.042979054436477, 6.041613489840494, 6.040261056764711, 6.038910010317312, 6.037542571206691, 6.036149233052206, 6.034729342315048, 6.033311435594467, 6.031945751107816, 6.030657257710438, 6.029437055378399, 6.028242714035703, 6.027048375873041, 6.025853037514062, 6.02466177432905, 6.023486244912712, 6.022343370245708, 6.021247177842165, 6.0201588059930575, 6.019003175787473, 6.017795130357013, 6.016643837488473, 6.015561706100431, 6.014385279485911, 6.013032876004337, 6.01175387527939, 6.010854709544836, 6.010211762638584, 6.009306932953368, 6.007894257848232, 6.006434569445251, 6.005617365230766, 6.00543243669447, 6.005000182000083, 6.00353376500379, 6.001356555002331, 5.99973512040463, 5.999575243723796, 6.000343950858534, 6.000436445489359]


#

# T = 0, alpha = 1.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 14, omega_C = 5, jump = 10;

mQ2 = [0.0, 0.06187612140273144, 0.24034321062367148, 0.5158971483158757, 0.8616714926535112, 1.2492338823900415, 1.6531905048145212, 2.053687628978718, 2.436975524974801, 2.7947286324956786, 3.122832483169791, 3.4201237079164994, 3.6873249764034033, 3.9262460799156753, 4.139233067906649, 4.328814216522496, 4.497488030629747, 4.64760688672252, 4.781321625255352, 4.900563167484808, 5.007045288785839, 5.102278389921226, 5.187588136488703, 5.264135663353436, 5.332937399366526, 5.394883212386535, 5.450752507082356, 5.501228605739283, 5.546911443151914, 5.588328470266171, 5.62594409638746, 5.660167786277773, 5.691360878978478, 5.719842640046476, 5.745895656257443, 5.769770420314513, 5.791689133544178, 5.8118490300917935, 5.830425358511371, 5.847574019363281, 5.863433887620699, 5.878128823857784, 5.891769430820502, 5.9044545751044, 5.916272613455912, 5.927302520158589, 5.9376149023442535, 5.947272889744003, 5.956333014671845, 5.964846096653268, 5.972857957085333, 5.980409869417634, 5.987539005883955, 5.994278869078769, 6.0006595023753455, 6.006707834067312, 6.012448322351807, 6.017903346721786, 6.023093251846537, 6.028036394867653, 6.032749429916768, 6.037247689602175, 6.041545331640823, 6.045655321292776, 6.049589415516894, 6.05335825971371, 6.0569716155998385, 6.06043864907292, 6.063767985391854, 6.066967470699219, 6.070044031291966, 6.073003962349794, 6.0758532545192265, 6.078597678912907, 6.081242670985793, 6.083793177408441, 6.08625363494708, 6.088628109436893, 6.090920554840633, 6.093134917396454, 6.095275020218622, 6.09734439371489, 6.099346130812275, 6.101282914808086, 6.103157341469525, 6.104972155417533, 6.1067300596258685, 6.108433398405583, 6.110084175975302, 6.1116843584732825, 6.113235996621803, 6.1147411345930385, 6.116201713632431, 6.117619566230465, 6.118996417402858, 6.120333858333792, 6.121633383770214, 6.122896370808634, 6.1241239527252676, 6.1253170436819495, 6.126476634965219, 6.127604028429173, 6.128700740810157, 6.129768121134499, 6.1308070580916345, 6.131818193391192, 6.132802265385932, 6.133760138266786, 6.1346927213606826, 6.135600851292437, 6.13648528391079, 6.137346873331785, 6.1381866104974865, 6.139005389109563, 6.139803775738991, 6.140582015380419, 6.141340300778517, 6.142079053927321, 6.1427990300814, 6.143501271823693, 6.144186946586656, 6.14485701158537, 6.145511876285588, 6.14615151385428, 6.146775948800565, 6.1473855943024445, 6.147981120807018, 6.14856314097319, 6.149131985225198, 6.149687715410548, 6.15023038893031, 6.150760291928197, 6.151277861154511, 6.151783506095591, 6.152277555183923, 6.152760292068659, 6.153232072599311, 6.153693445977171, 6.154145020539781, 6.154587152097399, 6.155019864296911, 6.155443043922621, 6.155856695826297, 6.156261005518682, 6.156656263395934, 6.1570428667149395, 6.157421313912778, 6.15779211310488, 6.158155617660295, 6.15851180135868, 6.158860387349959, 6.159201323951609, 6.15953495897599, 6.1598617764597305, 6.160182128577651, 6.160496192502811, 6.1608039973798014, 6.161105431086936, 6.161400395151623, 6.161689042359332, 6.161971733603269, 6.162248789971726, 6.162520405989452, 6.162786660578664, 6.1630475545683305, 6.1633031513563195, 6.163553704875983, 6.163799651253641, 6.164041395176631, 6.164279037087739, 6.164512357915075, 6.164741065530995, 6.164964972814353, 6.165184012027025, 6.165398242707478, 6.165607909783282, 6.165813470876461, 6.166015421344727, 6.166214012265974, 6.1664091300060955, 6.166600525718889, 6.16678811717088, 6.1669720316019445, 6.167152485800406, 6.167329612705371, 6.167503399726135, 6.167673841368767, 6.1678410937738954, 6.168005528871634, 6.1681675417709805, 6.1683271973195515, 6.168484176482412, 6.168638102059642, 6.168788747844314, 6.168936066554752, 6.169080151101447, 6.169221160865321, 6.169359270843558, 6.16949465207417, 6.169627447670506, 6.169757843126532, 6.169886088557853, 6.170012304856574, 6.170136342396987, 6.170257947950358, 6.17037703372478, 6.170493781014852, 6.170608468574781, 6.17072118294004, 6.170831857395127, 6.1709405592003685, 6.171047423731211, 6.171152443239843, 6.171256016075126, 6.17135905695581, 6.171460647341771, 6.171557081328673, 6.171647825768887, 6.171740143734892, 6.171838164180773, 6.1719300658426315, 6.172004695424008, 6.172080127807891, 6.1721847454630705, 6.172302111865409, 6.172376849363693, 6.172401234669479, 6.1724527157283955, 6.1725948375335395, 6.17276482782116, 6.172828370403725, 6.172763325718804, 6.172729030431397, 6.172891820883333, 6.1731956340013765, 6.173376722315889, 6.1732521097997, 6.172968723885882, 6.172901842346203, 6.17326446179627, 6.173830434743176, 6.174096933648024, 6.1737724809405155, 6.173120219570297, 6.172786832382902, 6.173226797030231, 6.17423456308958, 6.175036078282393, 6.174911099620548, 6.173841053055757, 6.1726210823436425]


#T = 0, alpha = 1.25, N_chain = 190, maxdim = 90, cutoff = -11, tau = 0.001, boson_dim = 15, omega_C = 5, jump = 20;

vQ2 = [0.0, 0.9219863376808917, 3.5126311712131777, 7.31254904983731, 11.737464596632528, 16.2432519592888, 20.429444139390274, 24.06618198208143, 27.06816482511897, 29.44809080308245, 31.272677885862983, 32.62993965731992, 33.60946841813594, 34.29229309943268, 34.74686716537346, 35.02874946276185, 35.181789875324505, 35.24001440921609, 35.22950260812402, 35.170062372494186, 35.076671918623, 34.960573286709774, 34.830143649073975, 34.69154910676667, 34.54936196693246, 34.40691337835288, 34.26658792520462, 34.130013248285735, 33.99830051715594, 33.872148739428994, 33.75197777673486, 33.637965839620406, 33.53012325679055, 33.42834999079511, 33.33250170403204, 33.24236586697278, 33.15766528585601, 33.078118648440075, 33.00341764964735, 32.933250313845114, 32.86731303931351, 32.80534299632855, 32.74706028243581, 32.6922431686965, 32.64064292193971, 32.59207845542933, 32.546335050095045, 32.50321266952588, 32.46252066408327, 32.42406844896786, 32.38770891181512, 32.35329306905923, 32.32068837935385, 32.289772517521314, 32.26042829693916, 32.23254390309974, 32.206010578988916, 32.1807285512516, 32.156643648332704, 32.133673226428165, 32.11174718427193, 32.090783289955425, 32.07071760309338, 32.051519250217154, 32.033129561851084, 32.01549305679912, 31.998539974696612, 31.98224528995003, 31.96659678777334, 31.951568329425847, 31.93711951605568, 31.923176680857473, 31.9097066622344, 31.89670407123465, 31.884161668422216, 31.872064168335342, 31.860389369149928, 31.849082946616008, 31.83811170219149, 31.827493458457113, 31.81722560978337, 31.807289767820798, 31.797653270466114, 31.78829929892993, 31.779221619489924, 31.77043625415778, 31.76193652704123, 31.753674642652, 31.745640439144168, 31.737811328926192, 31.730166889397694, 31.722721493657048, 31.715485150419894, 31.708447286916375, 31.701621767031355, 31.695002824571525, 31.688582854862958, 31.682360525691564, 31.676293293193922, 31.670358790546935, 31.664548746431187, 31.65884777006525, 31.653296720912394, 31.647916102283695, 31.642684384373993, 31.637585082501005, 31.63259627181133, 31.627713936660307, 31.622923937381167, 31.618237574271724, 31.61363104375235, 31.609095926762222, 31.6046556309609, 31.600323715393785, 31.596135929058185, 31.59208639880385, 31.58816378605883, 31.5843223717145, 31.5805305714903, 31.57678146981798, 31.573097058509, 31.56949973031508, 31.565989412899704, 31.562535222376113, 31.55911973459927, 31.555770570688885, 31.552512740989748, 31.549351629958622, 31.546290097228827, 31.543288371988446, 31.54034377553046, 31.537464511307327, 31.534642954013208, 31.531866764133923, 31.529128435922978, 31.526426177921373, 31.523773591490183, 31.521154324759607, 31.51859715987613, 31.51608829858595, 31.51362827836421, 31.511206362258505, 31.508839827256068, 31.506523353800723, 31.504225763098674, 31.501968383550206, 31.49974377771114, 31.497562362295156, 31.49545168106245, 31.49339276604183, 31.491358883313538, 31.489331078760216, 31.487319394431587, 31.485347904290258, 31.483409324124963, 31.48150309309093, 31.47962815305808, 31.477798112750776, 31.47599825335263, 31.474234015652442, 31.472524149535438, 31.470855126602125, 31.46921036086728, 31.467568318331494, 31.465940040904343, 31.464328515146605, 31.462730152432414, 31.461162495383405, 31.459620127064852, 31.458129480489724, 31.45667671465334, 31.455252095544438, 31.453858098046624, 31.452478876036984, 31.45109599156693, 31.449698767541307, 31.448321624577673, 31.44697357071616, 31.445681875958634, 31.444439964852528, 31.443201923098357, 31.441968197108856, 31.440722719604018, 31.43947737951852, 31.43824854846836, 31.437026450677664, 31.435837373653285, 31.434683681243968, 31.43357605041504, 31.432515368265733, 31.4314749182929, 31.43044109262415, 31.429401053021536, 31.428347170044717, 31.427296605521107, 31.426257570894983, 31.42523848711368, 31.42423269638897, 31.423241604286567, 31.422269515151008, 31.421312243518663, 31.4203695422055, 31.41943439301601, 31.418518263435644, 31.417601081119443, 31.416708691042388, 31.415863479970177, 31.41503666434116, 31.414229984660686, 31.41341461173255, 31.412573337127007, 31.411744212603736, 31.41092858853186, 31.41012881270658, 31.40942981236013, 31.408817353935888, 31.40801931610364, 31.40693090524198, 31.406030738561768, 31.405754391594577, 31.405352667892842, 31.40377099135724, 31.401973473727715, 31.402198787140883, 31.40383505032613, 31.403118249819762, 31.398858483571736, 31.395739704670724, 31.398437506333856, 31.403823535434668, 31.40345078138109, 31.39484573767598, 31.386865048235812, 31.39008313378215, 31.4026870787156, 31.410061009877992, 31.400622524565073, 31.38078873448002, 31.370794388511825, 31.383789150766077, 31.40980850108067, 31.422757553259366, 31.405635058848482, 31.369476388283438, 31.3462372182278, 31.36041485383577, 31.404799218669496, 31.443181424008756, 31.439617438277637, 31.389994232595157, 31.32904257276582]



# T = 0.1, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -13, tau = 0.002, jump = 10, boson_dim = 9, omega = 5;
mQ1_T = [0.0;
0.0123733588715975;
0.048061558861083375;
0.10316474793193368;
0.1723105103958142;
0.24981296042060802;
0.33059440133284823;
0.4106868709840981;
0.48734597094904997;
0.5589153951362615;
0.6245841948282026;
0.6841341237085946;
0.7377256110631399;
0.7857368402914916;
0.8286525085130951;
0.8669920976096015;
0.9012667280910901;
0.9319553905228343;
0.9594936388289184;
0.9842698991444071;
1.0066261741462472;
1.0268610922484187;
1.0452340348271276;
1.0619695947619063;
1.0772619452980416;
1.0912788986732533;
1.1041655598556352;
1.116047551942064;
1.1270338306566219;
1.1372191148737891;
1.1466859640276634;
1.1555065413976333;
1.1637441157709316;
1.171454328034934;
1.1786862432156586;
1.185483246133476;
1.1918838238938092;
1.1979222233399178;
1.2036289895215153;
1.2090314244651394;
1.2141539686851839;
1.219018525420299;
1.223644759841414;
1.2280503770522386;
1.2322513674953868;
1.2362622095176712;
1.240096034060212;
1.2437647720074656;
1.2472792912688355;
1.2506494976161653;
1.2538843969347524;
1.2569921700351638;
1.259980246568421;
1.2628553904817934;
1.2656238296757243;
1.2682913581597797;
1.2708633618331426;
1.2733448185297416;
1.2757403097528914;
1.2780540351491876;
1.280289863215737;
1.2824514039245016;
1.2845420560884266;
1.2865650212586357;
1.2885232772969872;
1.290419584944572;
1.2922565577707712;
1.2940366734002868;
1.2957622210428785;
1.29743529498349;
1.2990578543488858;
1.300631770580976;
1.3021588314657608;
1.3036407567775115;
1.3050792077185542;
1.3064757540727623;
1.3078318842462595;
1.3091490762125073;
1.3104287979006728;
1.3116724215507107;
1.3128811807935674;
1.3140561686233625;
1.3151983249605288;
1.3163084938340255;
1.3173875340467844;
1.3184364028438162;
1.3194561980139219;
1.3204480675849801;
1.3214129904937173;
1.3223516820934194;
1.3232647510512177;
1.3241528914977965;
1.3250169022272085;
1.3258575971485618;
1.3266757582453614;
1.3274721512826941;
1.328247509924222;
1.3290024809247056;
1.3297376198334971;
1.3304534372620596;
1.331150427806375;
1.3318290618984128;
1.3324897261736102;
1.3331326960788061;
1.3337582527723593;
1.334366869550637;
1.3349592628132798;
1.3355362110794369;
1.33609837784356;
1.336646317151726;
1.3371805070684244;
1.3377012659962084;
1.3382087103320714;
1.3387029309857565;
1.3391842026220107;
1.3396529351031625;
1.3401095032910053;
1.3405542147598852;
1.3409874224457994;
1.3414096060909901;
1.3418213011697175;
1.342222958833374;
1.3426148687919481;
1.342997175228787;
1.343369953513795;
1.343733309836094;
1.3440874609943552;
1.3444326982308998;
1.3447692567030325;
1.3450973036460814;
1.3454170778674526;
1.3457289359670097;
1.3460332286135657;
1.3463302263095356;
1.346620116404181;
1.3469029911869295;
1.347178899747752;
1.3474479731064926;
1.3477104519350445;
1.3479665261073333;
1.3482162200491574;
1.3484595440513274;
1.3486966885825102;
1.3489279957853664;
1.3491537909721942;
1.3493742815355418;
1.3495896123467996;
1.3497999165647463;
1.3500053163473915;
1.3502059093429053;
1.3504017196674885;
1.3505927180031116;
1.350778960149436;
1.350960645848331;
1.3511380083884197;
1.351311167186347;
1.3514801091071507;
1.3516448244410508;
1.3518054275358558;
1.3519621425667916;
1.3521152009051804;
1.3522647670363412;
1.3524109062638947;
1.3525535416903476;
1.3526925124921625;
]

vQ1_T = [0.0;
0.18467583208784383;
0.7036528649142683;
1.465075103336706;
2.352086484225319;
3.2558463287129937;
4.0962783376657015;
4.827500457762644;
5.432627333392662;
5.914445872716258;
6.286505541702382;
6.566601661732491;
6.7727567908647295;
6.921187473546155;
7.025527175826074;
7.096752926422295;
7.143454369883108;
7.172219692389375;
7.188031725675365;
7.194616923071017;
7.194743829970621;
7.190450409939035;
7.183226218645133;
7.174157241967088;
7.164018395650608;
7.153364991927857;
7.142582701226245;
7.131938334810435;
7.121607714598969;
7.11170284878801;
7.102290448733038;
7.093403817956212;
7.085054653271151;
7.077240308811124;
7.06994605014005;
7.063153695781557;
7.056837031918584;
7.050970021279532;
7.04552452370225;
7.040472402664136;
7.035788554072361;
7.031444742529141;
7.027414215351421;
7.023670704799186;
7.020191841657101;
7.01695532181195;
7.013942750670548;
7.01113537516959;
7.008516152075852;
7.006071356383115;
7.00378845672485;
7.001653172942126;
6.999650768965759;
6.9977652766939;
6.995983431235834;
6.994296212363934;
6.992697801110928;
6.991181286844561;
6.989740983837935;
6.9883697844149;
6.987060342948227;
6.985805667408027;
6.984601172384842;
6.983443665424293;
6.9823296325710995;
6.981254715253869;
6.980217429457746;
6.979217118933966;
6.978252239621142;
6.97731668498365;
6.9764058027393645;
6.975517920006193;
6.97465079463746;
6.973802708778225;
6.97297346274261;
6.972162161448774;
6.971366998771984;
6.970588209667073;
6.969830556673095;
6.9690964393023735;
6.968386334036294;
6.967698211014922;
6.967025886101639;
6.966361999878447;
6.965701659199548;
6.965043180651771;
6.96439223597182;
6.963759469950185;
6.963150860568702;
6.962557970218132;
6.961971009639775;
6.961386932154863;
6.96080905809166;
6.960240528962355;
6.959682925546602;
6.959138501495747;
6.958610765746568;
6.958100688364226;
6.957604968288468;
6.957121306255436;
6.956649247700543;
6.95618848575417;
6.955737917625989;
6.955288962691441;
6.954831976688752;
6.954365651152132;
6.95390028636374;
6.9534462560520245;
6.953006948368893;
6.952584124155859;
6.952181828136819;
6.951799642916937;
6.951427529884941;
6.951052792214103;
6.950675585303138;
6.950301953768792;
6.949933018370978;
6.949564063125626;
6.949192986822426;
6.948824134469546;
6.948466088991731;
6.948124670286928;
6.947799823369772;
6.947486531232165;
6.947178169457774;
6.94686965924819;
6.946561631878852;
6.946257833618177;
6.945957854598461;
6.945655757389079;
6.945350878255219;
6.945049477176116;
6.9447573894186645;
6.9444754605031145;
6.944203820605567;
6.943938484737856;
6.9436727486587415;
6.9434047706347926;
6.943141539187785;
6.942887043912503;
6.942633268523548;
6.9423710261943405;
6.942101348226604;
6.941833209442973;
6.941573023862959;
6.941320500926419;
6.941074288050154;
6.940833680849384;
6.940598914394555;
6.940370775367482;
6.940146951359854;
6.939920118567101;
6.939687392598401;
6.9394536784508825;
6.939225810659979;
6.939005108107775;
6.93878471861247;
6.938559484207865;
6.9383296334473075;
6.938100827527718;
6.9378788435810765;
6.937666316263041;
6.9374646247578875;
6.937269124562186;
6.937071646426732;
]

# T = 0.1, alpha = 1.25, N_chain = 160, maxdim = 100, cutoff = -12, tau = 0.001, jump = 20, boson_dim = 14, omega = 5;
mQ2_T = [0.0;
0.06186736534281158;
0.24031230263222647;
0.5158387061664674;
0.8615868560966448;
1.249126670888843;
1.6530619237027722;
2.0535333149179453;
2.436784181480765;
2.794482221825811;
3.1225077234108274;
3.419694376013207;
3.686764472211176;
3.925530011070327;
4.13834180997414;
4.327735238652357;
4.496217630821412;
4.646151232287078;
4.779697242191201;
4.898796910079828;
5.005173770946605;
5.100346977142347;
5.185649672619654;
5.262248874423913;
5.331164977900701;
5.393289887136406;
5.449403344873179;
5.500187411571473;
5.546239240826808;
5.588082254989741;
5.626175824685368;
5.66092367651538;
5.692681163813054;
5.721761480647459;
5.748441081443065;
5.772964420702707;
5.79554804635401;
5.816384122797128;
5.835643413598719;
5.853477788453583;
5.870022398866235;
5.885397678102468;
5.8997111195844;
5.913058768107561;
5.925526439276093;
5.937190838493836;
5.948120636035884;
5.958377421444729;
5.968016497789058;
5.977087579015671;
5.985635439919515;
5.993700480297116;
6.001319206596528;
6.008524623537294;
6.015346565810142;
6.021811994565373;
6.027945305341506;
6.0337686956377805;
6.039302493475374;
6.044565382689822;
6.049574566572357;
6.054345912753976;
6.058894042106732;
6.0632324179552075;
6.067373463628817;
6.071328741066018;
6.075109124171442;
6.078724872148234;
6.082185614121698;
6.085500345548882;
6.0886774872298375;
6.091724961017023;
6.094650224648369;
6.097460316922802;
6.1001619695167895;
6.102761701154292;
6.105265838800923;
6.107680455905846;
]

vQ2_T = [0.0;
0.9233876577712081;
3.518336537976673;
7.325649435177361;
11.761151526011064;
16.28064624904915;
20.483459647308436;
24.139438528674255;
27.16303932912726;
29.56686807185833;
31.41746208807095;
32.802805444113076;
33.812459372723;
34.52737857435344;
35.01601761999658;
35.333881488633324;
35.52477672942747;
35.622647276323576;
35.65345707036386;
35.63688455035297;
35.587733434273765;
35.51704488022153;
35.4330083539074;
35.34163727832373;
35.247297642282604;
35.15310215172271;
35.061223133571914;
34.9731233366526;
34.889734993090045;
34.81159996058946;
34.738977166058234;
34.671918410508695;
34.610331680423606;
34.55402807658306;
34.50275532938255;
34.456224390628684;
34.41413021390885;
34.37616262401148;
34.342024785581145;
34.3114268579225;
34.28408542324243;
34.259735389166174;
34.23812795291313;
34.219035896727625;
34.20224221791311;
34.18754206402056;
34.17474599296421;
34.16367830595956;
34.15417889136327;
34.146096631326145;
34.13929948367463;
34.1336666052887;
34.129089578332675;
34.12546472434449;
34.122699042277986;
34.120700755624355;
34.11938454652099;
34.118672940006455;
34.11849604393837;
34.118794942383374;
34.11951633124674;
34.12061154310207;
34.12203485774963;
34.123739532883796;
34.125679819515;
34.12781707981408;
34.13011942115909;
34.13256282583319;
34.135123954877116;
34.13777736162594;
34.14049648066923;
34.14325767475389;
34.14604056048675;
34.14882662254355;
34.15159550098935;
34.15432857593693;
34.157013497192565;
34.159642945098945;
]
#= 
fmQ1(x) = (-97.817*x + 536.548*x^2)/(351.553 + 26.2609*x + 395.255*x^2)
fvQ1(x) = (1478.77*x^2 + 150.5*x^4)/(108.058 + 145.549*x^2 + 29.1615*x^4)
fmQ2(x) = (-3.37036*x + 30.2561*x^2)/(6.13764 - 1.71698*x + 4.64394*x^2)
fvQ2(x) = (10.308*x^2 + 5.35486*x^4)/(0.191549 + 0.135901*x^2 + 0.182081*x^4)
fmQ1T(x) = (-0.36018*x + 2.01181*x^2)/(1.32323 + 0.119858*x + 1.47309*x^2)
fvQ1T(x) = (1420.72*x^2 + 401.678*x^4)/(115.792 + 129.448*x^2 + 66.2136*x^4)
fmQ2T(x) = (-31.2982*x + 228.368*x^2)/(42.171 - 9.42199*x + 37.5266*x^2)
fvQ2T(x) = (22.1913*x^2 + 9.46*x^4)/(0.403431 + 0.356355*x^2 + 0.314482*x^4)
 =#
#= 
num = 48
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]

 =#
ω_C = 5


# Time step duration
tau = 0.002


time_steps = collect(0:250) * 0.02 * ω_C
#time_steps4 = collect(0:lastindex(Sx1_T)-1)*10*tau*ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks1 = (2:6:14) #range(2, stop = 15, length = 3)
xticks2 = (2:6:14)
xticks3 = (4:6:15) #range(5, stop = maximum(time_steps[end-1]), length = 3)
xticks3sub = (10:4:15) #range(10, stop = maximum(time_steps[end-1]), length = 2)

yticks1 = (0:3:6) #range(0, stop = 6, length = 3)
yticks2 = (0:15:30) #range(0, stop = 30, length = 3)
yticks3 = (4:2:9) #range(4, stop = 10, length = 4)
yticks3sub = range(4.5, stop = 5.5, length = 2)

#xtick_labels1 = [string(round(x, digits = 1)) for x in xticks1]
    xtick_labels1 = [" " for x in xticks1]

xtick_labels2 = [string(Int(round(x, digits = 1))) for x in xticks2]
xtick_labels3 = [string(Int(round(x, digits = 1))) for x in xticks3]
xtick_labels3sub = [string(Int(round(x, digits = 1))) for x in xticks3sub]
ytick_labels1 = [string(Int(round(y, digits = 1))) for y in yticks1]
ytick_labels2 = [string(Int(round(y, digits = 1))) for y in yticks2]
ytick_labels3 = [string(Int(round(y, digits = 1))) for y in yticks3]
ytick_labels3sub = [string((round(y, digits = 1))) for y in yticks3sub]


# Plot
#= p1 = 
plot(time_steps, fmQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p1 = plot(time_steps[1:6:length(mQ1)], mQ1[1:6:end], linewidth = 3, xaxis = "", 
	xticks = (xticks1, xtick_labels1), yticks = (yticks1, ytick_labels1),
	xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue) 
plot!(time_steps[1:6:length(mQ2)], mQ2[1:6:end], linewidth = 3, color = :teal) 
plot!(time_steps[1:6:length(mQ1_T)], mQ1_T[1:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[1:6:length(mQ2_T)], mQ2_T[1:6:end], linewidth = 3, color = :brown)
plot!(yaxis = L"⟨Q⟩")
plot!(legend = false)
xlims!(0, 15)  
ylims!(0, 7)  
plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(bottom_margin = -8mm)
annotate!(14, 4.7, text("(a)", 17, :black, :right))
ticks_length!(tl=.03)




#= p2 = plot(time_steps, fvQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p2 = plot(time_steps[1:6:length(vQ1)], vQ1[1:6:end], linewidth = 3, xticks = (xticks2, xtick_labels2), yticks = (yticks2, ytick_labels2), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue, seriesalpha = 1, xaxis = "") #, label = L"\  (1, 1.5)")
plot!(time_steps[1:6:length(vQ2)], vQ2[1:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(time_steps[1:6:length(vQ1_T)], vQ1_T[1:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[1:6:length(vQ2_T)], vQ2_T[1:6:end], linewidth = 3, color = :brown)
plot!(widen = false)
xlims!(0, 15)  
ylims!(0, 38)  
plot!(yaxis = L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel = false)
vline!([xlims(p2)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p2)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(legend = false)
annotate!(14, 24, text("(b)", 17, :black, :right))
ticks_length!(tl=.03)
plot!(xaxis = L"tω_C")



#= p3 = plot(time_steps[10:end], fvQ1.(time_steps[10:end])./fmQ1.(time_steps[10:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2.(time_steps[10:end])./fmQ2.(time_steps[10:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ1T.(time_steps[10:end])./fmQ1T.(time_steps[10:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2T.(time_steps[10:end])./fmQ2T.(time_steps[10:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p3 = plot(time_steps[8:6:length(vQ1)], vQ1[8:6:end] ./ mQ1[8:6:end], color = :lightblue, xticks = (xticks3, xtick_labels3), yticks = (yticks3, ytick_labels3), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, seriesalpha = 1, xaxis = "", linewidth = 3) #, label = L"\  (1, 1.5)")
plot!(time_steps[8:6:length(vQ2)], vQ2[8:6:end] ./ mQ2[8:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(time_steps[8:6:length(vQ1_T)], vQ1_T[8:6:end] ./ mQ1_T[8:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[8:6:length(vQ2_T)], vQ2_T[8:6:end] ./ mQ2_T[8:6:end], linewidth = 3, color = :brown)
plot!(widen = false)
#plot!(yaxis = L"F")
ylims!(4., 10)  
xlims!(0, 16)  
vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false, ymirror = true)
plot!(legend = false)
annotate!(19.5, 7, text(L"F", 24, :black, :right))
ticks_length!(tl=.02)
annotate!(15.2, 9.6, text("(c)", 17, :black, :right))
plot!(xaxis = L"tω_C")


plot!(p3, inset=bbox(0.35,0.01,0.42, 0.6), subplot=2)

#= plot!(p3[2], time_steps[50:end], fvQ1.(time_steps[50:end])./fmQ1.(time_steps[50:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2.(time_steps[50:end])./fmQ2.(time_steps[50:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ1T.(time_steps[50:end])./fmQ1T.(time_steps[50:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2T.(time_steps[50:end])./fmQ2T.(time_steps[50:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
plot!(p3[2], time_steps[50:6:length(vQ1)], vQ1[50:6:end] ./ mQ1[50:6:end], color = :lightblue, xticks = (xticks3sub, xtick_labels3sub), yticks = (yticks3sub, ytick_labels3sub), xtickfont = font(12), ytickfont = font(12),
	xguidefontsize = 10, yguidefontsize = 15, seriesalpha = 1, xaxis = "", linewidth = 3) #, label = L"\  (1, 1.5)")
plot!(p3[2], time_steps[50:6:length(vQ2)], vQ2[50:6:end] ./ mQ2[50:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(p3[2], time_steps[50:6:length(vQ1_T)], vQ1_T[50:6:end] ./ mQ1_T[50:6:end], linewidth = 3, color = :lightcoral)
plot!(p3[2], time_steps[50:6:length(vQ2_T)], vQ2_T[50:6:end] ./ mQ2_T[50:6:end], linewidth = 3, color = :brown)
ylims!(p3[2], 4.4, 5.9)  
xlims!(p3[2], 7, 15)  
#= vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false) =#
plot!(p3[2], grid = false)
plot!(p3[2], legend = false, aspect_ratio = 5., framestyle = :box)	
#annotate!(19.7, 4.7, text(L"F", 24, :black, :right))
#annotate!(14.5, 5.8, text("(c)", 20, :black, :right))
#plot!(p3[2], xaxis = L"tω_C")
#plot!(p3[2], xaxis = " ")



custom_layout = @layout [[a{0.5h}; b{1.35w}] c{0.6w}]
p = plot(p1, p2, p3, layout = custom_layout, size = (600, 400), left_margin = 5mm, right_margin = 7mm)



#p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png", p)

