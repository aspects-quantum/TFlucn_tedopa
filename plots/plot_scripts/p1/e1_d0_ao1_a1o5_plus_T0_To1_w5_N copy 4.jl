using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


T = 0.1
α = 0.5

# T = 0, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 11, omega_C = 5, jump = 10;

mQ1 = [0.0, 0.012374925817189316, 0.048066310791869286, 0.10317184475157636, 0.1723172445488717, 0.24981599073328276, 0.33059097072886834, 0.4106755938218668, 0.48732714062033206, 0.5588909649707312, 0.624557577291487, 0.6841098860141082, 0.7377091394946456, 0.7857340279377123, 0.8286694823386993, 0.8670349942883749, 0.9013415208205607, 0.9320677634724447, 0.9596489054529109, 0.9844729487835506, 1.0068814368884187, 1.0271725335970487, 1.0456051846812475, 1.0624035862283583, 1.0777615518449282, 1.0918465789985456, 1.1048035084945411, 1.1167577452401594, 1.12781805351674, 1.1380789638718156, 1.1476228327178795, 1.1565215995151117, 1.1648382766561918, 1.172628221981114, 1.1799402043771876, 1.186817246415015, 1.19329737530877, 1.1994143735064364, 1.2051984058587133, 1.2106764557735996, 1.2158726551914827, 1.2208085780544884, 1.225503518389002, 1.2299747773547383, 1.234237939091591, 1.2383071246833548, 1.2421952180520202, 1.245914021722587, 1.24947435420853, 1.2528861260388107, 1.2561583647250147, 1.259299226294626, 1.2623161108273773, 1.2652158419335298, 1.2680048185622987, 1.2706890789131977, 1.2732742125653544, 1.2757652410237381, 1.2781666840582975, 1.2804827489806037, 1.2827174258918674, 1.2848744708062612, 1.2869573814812405, 1.2889694404500809, 1.2909137907081578, 1.2927934601751532, 1.2946112866206037, 1.2963698223382933, 1.298071331918213, 1.299717904255583, 1.3013115649913451, 1.3028542751891332, 1.3043479061625196, 1.3057943097418152, 1.3071953738924946, 1.3085529220379857, 1.3098686035688918, 1.311143889957601, 1.3123800796020144, 1.3135783124193292, 1.3147396691221362, 1.3158652745600588, 1.316956351248898, 1.318014222501382, 1.319040197513248, 1.32003541183661, 1.3210007701976108, 1.3219370079892414, 1.3228447857501744, 1.3237248175606562, 1.3245779728356963, 1.3254052343135545, 1.3262075401083697, 1.3269856780820024, 1.3277402905553861, 1.3284719262484335, 1.329181121801781, 1.3298684831430343, 1.330534714824765, 1.3311805729141029, 1.3318067742287878, 1.3324138535599779, 1.333002081268097, 1.333571562968602, 1.334122519891944, 1.3346554871185825, 1.3351712194311542, 1.3356705095630061, 1.3361540063233779, 1.3366220464225407, 1.3370747090364532, 1.3375120678829548, 1.3379343679085987, 1.338342136441777, 1.3387361902709563, 1.3391173943136743, 1.3394862817920723, 1.3398428699950475, 1.3401869249524307, 1.340518366321077, 1.3408374181106024, 1.3411445483607007, 1.3414403467848488, 1.3417252996055118, 1.3419995650270706, 1.3422630261960984, 1.3425155976326901, 1.3427574718755277, 1.3429891374246155, 1.3432112305472534, 1.3434242892788357, 1.3436285599223259, 1.3438240500027545, 1.3440107940345392, 1.3441890042913234, 1.3443590064274, 1.3445211911942232, 1.3446759081596693, 1.3448232337942592, 1.3449629449973781, 1.3450949027290138, 1.3452194240012354, 1.3453371548061481, 1.3454486219560624, 1.3455539858605519, 1.3456531625657981, 1.3457460330562059, 1.3458325941618905, 1.3459130472151024, 1.3459876816096472, 1.3460566125135145, 1.346119698331509, 1.3461767712439083, 1.3462278974736586, 1.3462733563263272, 1.34631344739911, 1.3463484107206944, 1.346378483132096, 1.3464039542727957, 1.346425089089711, 1.3464419751961252, 1.3464545188243198, 1.3464626674363773, 1.346466643377202, 1.3464668907283708, 1.3464637311783896, 1.3464570658715402, 1.3464464802277332, 1.3464316200041762, 1.3464124034560923, 1.3463889795220207, 1.346361671338613, 1.3463309389184017, 1.3462971667693109, 1.3462605248827126, 1.3462210715427132, 1.3461789076943798, 1.3461342467350967, 1.3460873562414217, 1.3460384229802291, 1.3459874042797084, 1.3459339360513416, 1.3458774408825112, 1.3458174966468388, 1.3457541255341354, 1.345687677199615, 1.3456185750116947, 1.3455471903583338, 1.3454737802655579, 1.345398501835917, 1.3453215309991258, 1.3452430662746555, 1.345163162069415, 1.3450817368477446, 1.3449987649416904, 1.344914319998182, 1.3448284410545917, 1.3447410540801792, 1.3446520340452834, 1.3445612584511977, 1.3444685882377325, 1.3443739890449122, 1.3442779101054363, 1.3441812084975768, 1.3440840015041258, 1.3439849187766792, 1.3438829455118588, 1.3437800583832369, 1.3436795092476337, 1.3435802729779462, 1.3434765078046755, 1.3433657066498732, 1.3432545349004017, 1.3431514096824035, 1.3430535236177537, 1.3429467597051046, 1.3428222911336398, 1.3426908515197673, 1.3425748019591044, 1.3424831648203057, 1.3423971849177017, 1.3422858042713095, 1.342138381084304, 1.3419808834848073, 1.3418555382023203, 1.3417801086718926, 1.341725483250934, 1.3416359159615465, 1.3414774203332167, 1.3412724551884725, 1.3410885196369409, 1.3409863917448814, 1.3409682365633506, 1.3409681269095697, 1.340895896025094, 1.3407041042917913, 1.3404286639770453, 1.3401713333284875, 1.34003355468298, 1.3400456449518758, 1.3401395082924457, 1.3401849951567635, 1.3400688442134818, 1.3397675440832693, 1.3393687564357653, 1.3390268100607137, 1.338876756545669, 1.3389556473778919, 1.3391755761832052, 1.3393642667694583, 1.3393525421809658]


vQ1 = [0.0, 0.18439279681885287, 0.7024907793762823, 1.462389592059063, 2.347208908547519, 3.2481233946150088, 4.085102569721239, 4.812321233683832, 5.41294756781881, 5.88981226850712, 6.256509394901714, 6.530857856868178, 6.730883459503751, 6.872827126455543, 6.9703315443641305, 7.03438534246801, 7.073600718470246, 7.094585077736254, 7.102342639495174, 7.100620868881465, 7.092207433833099, 7.079162979938427, 7.063002536624149, 7.0448348361522966, 7.025465057882945, 7.00547063983057, 6.985260172975145, 6.96512309081772, 6.945264950444488, 6.925818493790892, 6.906870181101327, 6.888473022030739, 6.870657491854125, 6.85343359057642, 6.8368021368348355, 6.820755411563271, 6.8052726486810196, 6.790327384007013, 6.775898538634871, 6.761970914779126, 6.748526427285765, 6.73554196560754, 6.722991193671801, 6.710845596803895, 6.699077709022363, 6.687661884146482, 6.676578135396965, 6.665810441444633, 6.655347848573777, 6.645176941076828, 6.635284030169761, 6.625652585357623, 6.616265054701392, 6.607104140807574, 6.598156067020333, 6.58941897356474, 6.580891230559187, 6.572562113413327, 6.564415543738448, 6.5564356728000295, 6.548614066734654, 6.540945426469206, 6.533420618870091, 6.526032765269257, 6.518780867562906, 6.51166303507704, 6.504679593932534, 6.497826003525069, 6.491092110083866, 6.484465472840057, 6.477940546288514, 6.47151075226002, 6.465170382762302, 6.458916800467459, 6.452753422031877, 6.446686048671465, 6.440714827770337, 6.4348363221947125, 6.429047580780743, 6.423341814434975, 6.417708059643638, 6.412139150922985, 6.406634202078122, 6.401198494027326, 6.3958394291134475, 6.390558804451282, 6.38535101209723, 6.380205928878284, 6.375117310675524, 6.370080560781496, 6.365096383743255, 6.360169979885704, 6.355309256083146, 6.350514482941709, 6.3457805675917385, 6.341099320708042, 6.336463760146918, 6.331870371147511, 6.327326305345659, 6.322837602951495, 6.318411804583607, 6.314050306064261, 6.309743291649728, 6.305471534390542, 6.30122357819835, 6.2970021759327715, 6.292818322314641, 6.2886892945741035, 6.284625154781867, 6.280619777070377, 6.276656183499802, 6.272719147450625, 6.268798994268872, 6.2649002868832335, 6.261040776256705, 6.257241653704377, 6.253514879796471, 6.249844923074429, 6.246206924203893, 6.242584771940366, 6.238981278547063, 6.23540288974922, 6.2318662419377, 6.228383133151347, 6.224949601988762, 6.221546513533568, 6.218158920105282, 6.214782796524216, 6.211426189951793, 6.208105086805317, 6.204832219804866, 6.201605481299985, 6.198412963773502, 6.195244575761107, 6.192101600609604, 6.188984630023332, 6.185900894714468, 6.182860594326414, 6.179863099676288, 6.176887825803917, 6.173917885660382, 6.170959409558768, 6.168036799269801, 6.165164272904147, 6.162337133898259, 6.159544507251992, 6.156774323115163, 6.1540204706074455, 6.151288411761161, 6.148590200185082, 6.145926110054717, 6.1432853331043, 6.140656079585578, 6.138037237179574, 6.135436480467056, 6.132857004901744, 6.130299925793672, 6.127766222730278, 6.125261723864464, 6.1227935053567215, 6.120359770740703, 6.1179478438375785, 6.1155468826391495, 6.113159428723348, 6.110800933616622, 6.108486981934625, 6.10621454685116, 6.10396425816559, 6.101720798174167, 6.099479591487686, 6.097240641907977, 6.095008122495914, 6.092796000512513, 6.0906156187455425, 6.088464900677193, 6.0863362999472965, 6.084227083576382, 6.082139148188321, 6.080083711194451, 6.078068020155781, 6.076094697364601, 6.074151888649332, 6.07221450176031, 6.07026555972144, 6.068308721399017, 6.066356639908806, 6.064419368320035, 6.0625045482719795, 6.060613035319683, 6.058739498371078, 6.05688569139453, 6.055060034663541, 6.053263776168322, 6.0514883039932315, 6.049729439144155, 6.0479902919294215, 6.046273917866376, 6.044576424935063, 6.042895432823715, 6.041228143232784, 6.03956634966134, 6.037895949870876, 6.03622696567947, 6.0346101802725665, 6.033067617439667, 6.031514410649285, 6.0298542187196675, 6.028179275938589, 6.026717564452147, 6.025454861001441, 6.024029785316502, 6.022225313593234, 6.020409178407635, 6.019141275715002, 6.018354385639798, 6.01724506445249, 6.015199934735207, 6.012691898009775, 6.010951589322953, 6.010604668878711, 6.010780516713044, 6.009818098304073, 6.006991569792994, 6.003469991464653, 6.001399258720858, 6.001855589032367, 6.003612182866555, 6.003997828304889, 6.001201513890061, 5.996021448683971, 5.99146884246418, 5.990451317178024, 5.993352107845844, 5.997460168308557, 5.998799789709921, 5.995065633497995, 5.987489648959501, 5.980222212854062, 5.977607723870388, 5.981206316614361, 5.988556275229474, 5.99453528819583, 5.99448763797885, 5.987153032254239, 5.975614729031866, 5.965675436758282, 5.9626057608199385, 5.9681287012335416, 5.979316609990136, 5.99000501170599, 5.99394709020364]

#

# T = 0, alpha = 1.25, N_chain = 180, maxdim = 90, cutoff = -12, tau = 0.002, boson_dim = 14, omega_C = 5, jump = 10;

mQ2 = [0.0;
0.0618728856367717;
0.24031807134448058;
0.5158162348772104;
0.8614913595877927;
1.2489075219851438;
1.6526724108530466;
2.052937190369297;
2.435958620116906;
2.7934178635097067;
3.1212067218484267;
3.41816732149812;
3.685026819128277;
3.923598407755341;
4.136230668689214;
4.325453845999901;
4.493767977106184;
4.643526556898409;
4.776881236486041;
4.895763472605171;
5.001887354238207;
5.096763482149431;
5.1817177155135274;
5.257911325726182;
5.326360687488404;
5.387955517840611;
5.44347516717044;
5.493603037156413;
5.538939120115289;
5.580010802318886;
5.617282358267512;
5.651163218065281;
5.682014893753514;
5.710156856251081;
5.735871666641621;
5.75940960095129;
5.780992689123392;
5.800818082475967;
5.819061027343337;
5.835877486285949;
5.85140638424778;
5.865771592229977;
5.879083638024617;
5.891441164565538;
5.902932261012547;
5.913635694589301;
5.923622039895966;
5.932954648270906;
5.941690385727275;
5.949880210168885;
5.957569860658548;
5.964800478782351;
5.97160905977311;
5.978028838997341;
5.98408974057043;
5.989818820427033;
5.995240668779259;
6.000377696659586;
6.005250297183619;
6.009876965577754;
6.014274485615489;
6.018458107211767;
6.022441689266071;
6.026237846165087;
6.029858159640094;
6.033313329788785;
6.03661321699615;
6.039766864495607;
6.042782599534357;
6.045668157954495;
6.0484307551813306;
6.051077068541928;
6.05361325250773;
6.056044997694878;
6.058377597741243;
6.060615948472874;
6.062764588195547;
6.064827827523874;
6.066809792967897;
6.068714339418326;
6.07054506240867;
6.072305370399938;
6.07399846621027;
6.075627260466568;
6.077194399338518;
6.078702340605847;
6.080153427460553;
6.081549932220593;
6.082894160627838;
6.084188492983827;
6.085435211320993;
6.086636307101669;
6.087793443631181;
6.088908121432039;
6.089981788495862;
6.091015897635591;
6.092011940576653;
6.0929713996747825;
6.093895642852756;
6.0947858976429785;
6.0956433656196305;
6.096469259752772;
6.097264745912623;
6.09803089599924;
6.098768669812569;
6.099478925514011;
6.100162502028838;
6.1008202861882745;
6.101453274902928;
6.102062521505926;
6.102648936661568;
6.103213209284981;
6.10375590363598;
6.104277566555679;
6.104778795418975;
6.105260256070144;
6.105722631280751;
6.106166587372361;
6.106592747328833;
6.107001640138088;
6.107393712166079;
6.107769424435627;
6.108129269372121;
6.108473691479897;
6.108803074641346;
6.109117806990918;
6.10941830679521;
6.109704972043537;
6.109978165423581;
6.110238229773962;
6.110485537644291;
6.110720478473474;
6.110943373452228;
6.111154446183148;
6.111353918843196;
6.111542130071707;
6.111719540273818;
6.111886662647684;
6.1120440099437;
6.1121919855155635;
6.112330822121463;
6.112460588316532;
6.112581317701078;
6.112693224103488;
6.112796731094097;
6.112892287870634;
6.112980208258304;
6.113060682452771;
6.113133859604288;
6.113199879412877;
6.11325882673508;
6.113310727306061;
6.11335563006386;
6.113393689244923;
6.113425103524083;
6.113450002077624;
6.113468437254694;
6.113480486408978;
6.113486283198447;
6.1134859393554075;
6.11347955397126;
6.113467309602918;
6.113449457134034;
6.11342619466056;
6.113397594111217;
6.113363664741578;
6.113324433851324;
6.1132799735359535;
6.113230420217589;
6.1131759942734325;
6.1131169616177345;
6.113053532589191;
6.112985776462595;
6.112913685837187;
6.112837301140754;
6.112756715940598;
6.112672034716352;
6.112583337180162;
6.112490666278013;
6.112394095762761;
6.112293736640847;
6.112189671899921;
6.112081933247902;
6.111970554090929;
6.11185565889035;
6.11173746084222;
6.111616153003471;
6.1114918184001095;
6.111364457650111;
6.111234136290677;
6.111101010714914;
6.110965172423155;
6.110826627453514;
6.110685421768062;
6.110541684557914;
6.110395542047674;
6.110247029680496;
6.110096137446704;
6.109942878809451;
6.109787286514694;
6.109629420924617;
6.109469369031696;
6.109307224042501;
6.109143087675907;
6.10897704713376;
6.108809179529441;
6.108639551615129;
6.108468182739008;
6.108295026478944;
6.1081199927243865;
6.107942991946395;
6.1077637647212395;
6.107581951653725;
6.1073979778242595;
6.107213174510951;
6.107027204195443;
6.106836891920957;
6.106641925823644;
6.106449212272435;
6.106262090262289;
6.106068140702858;
6.105856031460753;
6.105643789176412;
6.105459962403746;
6.1052889073355;
6.10507631245421;
6.10481456962156;
6.104579826662619;
6.104434193984842;
6.1043149984650595;
6.104089488735645;
6.103736557210764;
6.103414648874195;
6.103288701567192;
6.103303201121628;
6.103197058271338;
6.102789200776908;
6.102224733663582;
6.101873853346371;
6.101945960664989;
6.102217627029843;
6.102193729710587;
6.101587561835466;
6.100657994203608;
6.1000419063169575;
6.100188549584976;
6.100897630556215;
6.101406519712017;
6.101002414267498;
]

#T = 0, alpha = 1.25, N_chain = 190, maxdim = 90, cutoff = -11, tau = 0.001, boson_dim = 15, omega_C = 5, jump = 20;

vQ2 = [0.0;
0.9219381969930862;
3.5122680626423173;
7.311440584606094;
11.735161608085875;
16.23940778774382;
20.423883578622263;
24.05888054727759;
27.059199304060495;
29.43775159566949;
31.26122904738137;
32.617701927713526;
33.596765119946994;
34.27936619389026;
34.733927249151336;
35.01595394532272;
35.169271032442325;
35.227875555295824;
35.21782501295377;
35.15892884607412;
35.066114125444685;
34.950607785002106;
34.82078015352676;
34.682803012167085;
34.54124631615198;
34.399427436658556;
34.259698607185314;
34.123711989619665;
33.99257963202135;
33.867003126603166;
33.74738493619594;
33.633908919482025;
33.526602242716514;
33.4253662400511;
33.33003359931925;
33.24037777389363;
33.15613093210045;
33.0770131152783;
33.00274332019554;
32.9330267698047;
32.86757863745466;
32.806134096321216;
32.74841498205464;
32.6941632365853;
32.64313661000603;
32.59510491917313;
32.549863255544714;
32.50723282025065;
32.467029115020054;
32.42907542327161;
32.39320604608536;
32.359278269591705;
32.32715878570385;
32.296715471964234;
32.267836619752345;
32.240423941211674;
32.21437551425797;
32.189598858116696;
32.16600436472311;
32.143509693658764;
32.12205222248221;
32.101563243665794;
32.08198715652089;
32.06325170042522;
32.04531633720778;
32.02813827843042;
32.011672539084586;
31.99587058250018;
31.980691303108053;
31.966093933382552;
31.95206031630041;
31.938565132427982;
31.92557760506024;
31.91306446652527;
31.90099665644601;
31.88935480838714;
31.878114054934038;
31.867261122679515;
31.856781894776887;
31.846646247247477;
31.836842186219343;
31.827353438076955;
31.81817994320516;
31.809313838864625;
31.800729492055176;
31.792405069904774;
31.784325164562745;
31.7764756753432;
31.76884441816877;
31.761444435908615;
31.75428373038781;
31.7473537252952;
31.740631784081778;
31.734103715325908;
31.727753370556698;
31.72157061864762;
31.715550654873987;
31.709692166582386;
31.70398925889456;
31.69843467465718;
31.693031579322195;
31.687778526356183;
31.682665724665036;
31.67769016678833;
31.672837885968868;
31.668109762305214;
31.663496977141243;
31.658994371998254;
31.654597360003116;
31.650306093998793;
31.646124207888306;
31.642043238473192;
31.638072403939077;
31.634205894233617;
31.630436567840704;
31.626766901402483;
31.623195141631996;
31.619718267515736;
31.616319456982886;
31.61298940380844;
31.609730224570434;
31.60654186005253;
31.603423215064062;
31.600373053755426;
31.597383699773303;
31.59445897960584;
31.59159676558;
31.588804072103017;
31.586074211582343;
31.583401084811733;
31.58078309975957;
31.57821967092474;
31.57571627840209;
31.573267407061905;
31.57087384811939;
31.568531425340176;
31.56624151568839;
31.563995956183525;
31.56179554574868;
31.559651233268333;
31.557562598691987;
31.555511495345065;
31.553485831233843;
31.551485617204705;
31.54953395806789;
31.547643240813386;
31.545800956563426;
31.543997635389616;
31.542230378132565;
31.540504039809946;
31.538814486696445;
31.53716277940179;
31.535551434570117;
31.53397600380365;
31.53243256729349;
31.530909563008564;
31.52940206843995;
31.527916884838397;
31.526463266977935;
31.525036390058368;
31.52363185051167;
31.522252539767507;
31.520905436690647;
31.519593025411645;
31.518313448170844;
31.51705617594864;
31.515823845054165;
31.514611639780966;
31.513415549021445;
31.512245162749693;
31.511112525822952;
31.51000628495145;
31.50892003236536;
31.507836722053213;
31.506760280371175;
31.505697894136475;
31.504657404972818;
31.503649487716594;
31.5026698004718;
31.501712584377962;
31.500774298018186;
31.499852127840263;
31.498943451603864;
31.498045449553118;
31.49715820165214;
31.496290140436415;
31.495438269828213;
31.494601432006263;
31.49377763423007;
31.49297005431481;
31.4921824010286;
31.491411785800203;
31.490647770324422;
31.48989450073558;
31.489156668387878;
31.488434848773274;
31.48773050625718;
31.487048697523896;
31.486385457386753;
31.4857356542051;
31.4850926428609;
31.484458131055817;
31.483838284820365;
31.483229326670376;
31.482631029350586;
31.48204347037519;
31.481473594707992;
31.48092957006851;
31.480407256194418;
31.479896383650747;
31.479393931130282;
31.478896299178828;
31.47837522717478;
31.47783532228405;
31.47737650615938;
31.477014771227978;
31.476522000187842;
31.475784564837433;
31.475272393477084;
31.47537029195452;
31.47528151154966;
31.4739725359619;
31.472450510750576;
31.472935539642485;
31.474838977933835;
31.474430232023728;
31.470524194322813;
31.46775835802702;
31.4707471523109;
31.47637768384599;
31.4762638700023;
31.467985187091003;
31.4603326187731;
31.463780066791458;
31.476551534183656;
31.48415141980255;
31.47512781545244;
31.455844132068528;
31.44630377226575;
31.45943709470142;
31.485337110072606;
31.498309126911664;
31.481641458115135;
31.44620424293749;
31.423482129058286;
31.43769321028858;
31.481821080761677;
31.520186003415333;
31.51717562234188;
]


# T = 0.1, alpha = 0.25, N_chain = 180, maxdim = 90, cutoff = -13, tau = 0.002, jump = 10, boson_dim = 9, omega = 5;
mQ1_T = [0.0;
0.0123733588715975;
0.048061558861083375;
0.10316474793193368;
0.1723105103958142;
0.24981296042060802;
0.33059440133284823;
0.4106868709840981;
0.48734597094904997;
0.5589153951362615;
0.6245841948282026;
0.6841341237085946;
0.7377256110631399;
0.7857368402914916;
0.8286525085130951;
0.8669920976096015;
0.9012667280910901;
0.9319553905228343;
0.9594936388289184;
0.9842698991444071;
1.0066261741462472;
1.0268610922484187;
1.0452340348271276;
1.0619695947619063;
1.0772619452980416;
1.0912788986732533;
1.1041655598556352;
1.116047551942064;
1.1270338306566219;
1.1372191148737891;
1.1466859640276634;
1.1555065413976333;
1.1637441157709316;
1.171454328034934;
1.1786862432156586;
1.185483246133476;
1.1918838238938092;
1.1979222233399178;
1.2036289895215153;
1.2090314244651394;
1.2141539686851839;
1.219018525420299;
1.223644759841414;
1.2280503770522386;
1.2322513674953868;
1.2362622095176712;
1.240096034060212;
1.2437647720074656;
1.2472792912688355;
1.2506494976161653;
1.2538843969347524;
1.2569921700351638;
1.259980246568421;
1.2628553904817934;
1.2656238296757243;
1.2682913581597797;
1.2708633618331426;
1.2733448185297416;
1.2757403097528914;
1.2780540351491876;
1.280289863215737;
1.2824514039245016;
1.2845420560884266;
1.2865650212586357;
1.2885232772969872;
1.290419584944572;
1.2922565577707712;
1.2940366734002868;
1.2957622210428785;
1.29743529498349;
1.2990578543488858;
1.300631770580976;
1.3021588314657608;
1.3036407567775115;
1.3050792077185542;
1.3064757540727623;
1.3078318842462595;
1.3091490762125073;
1.3104287979006728;
1.3116724215507107;
1.3128811807935674;
1.3140561686233625;
1.3151983249605288;
1.3163084938340255;
1.3173875340467844;
1.3184364028438162;
1.3194561980139219;
1.3204480675849801;
1.3214129904937173;
1.3223516820934194;
1.3232647510512177;
1.3241528914977965;
1.3250169022272085;
1.3258575971485618;
1.3266757582453614;
1.3274721512826941;
1.328247509924222;
1.3290024809247056;
1.3297376198334971;
1.3304534372620596;
1.331150427806375;
1.3318290618984128;
1.3324897261736102;
1.3331326960788061;
1.3337582527723593;
1.334366869550637;
1.3349592628132798;
1.3355362110794369;
1.33609837784356;
1.336646317151726;
1.3371805070684244;
1.3377012659962084;
1.3382087103320714;
1.3387029309857565;
1.3391842026220107;
1.3396529351031625;
1.3401095032910053;
1.3405542147598852;
1.3409874224457994;
1.3414096060909901;
1.3418213011697175;
1.342222958833374;
1.3426148687919481;
1.342997175228787;
1.343369953513795;
1.343733309836094;
1.3440874609943552;
1.3444326982308998;
1.3447692567030325;
1.3450973036460814;
1.3454170778674526;
1.3457289359670097;
1.3460332286135657;
1.3463302263095356;
1.346620116404181;
1.3469029911869295;
1.347178899747752;
1.3474479731064926;
1.3477104519350445;
1.3479665261073333;
1.3482162200491574;
1.3484595440513274;
1.3486966885825102;
1.3489279957853664;
1.3491537909721942;
1.3493742815355418;
1.3495896123467996;
1.3497999165647463;
1.3500053163473915;
1.3502059093429053;
1.3504017196674885;
1.3505927180031116;
1.350778960149436;
1.350960645848331;
1.3511380083884197;
1.351311167186347;
1.3514801091071507;
1.3516448244410508;
1.3518054275358558;
1.3519621425667916;
1.3521152009051804;
1.3522647670363412;
1.3524109062638947;
1.3525535416903476;
1.3526925124921625;
]

vQ1_T = [0.0;
0.18467583208784383;
0.7036528649142683;
1.465075103336706;
2.352086484225319;
3.2558463287129937;
4.0962783376657015;
4.827500457762644;
5.432627333392662;
5.914445872716258;
6.286505541702382;
6.566601661732491;
6.7727567908647295;
6.921187473546155;
7.025527175826074;
7.096752926422295;
7.143454369883108;
7.172219692389375;
7.188031725675365;
7.194616923071017;
7.194743829970621;
7.190450409939035;
7.183226218645133;
7.174157241967088;
7.164018395650608;
7.153364991927857;
7.142582701226245;
7.131938334810435;
7.121607714598969;
7.11170284878801;
7.102290448733038;
7.093403817956212;
7.085054653271151;
7.077240308811124;
7.06994605014005;
7.063153695781557;
7.056837031918584;
7.050970021279532;
7.04552452370225;
7.040472402664136;
7.035788554072361;
7.031444742529141;
7.027414215351421;
7.023670704799186;
7.020191841657101;
7.01695532181195;
7.013942750670548;
7.01113537516959;
7.008516152075852;
7.006071356383115;
7.00378845672485;
7.001653172942126;
6.999650768965759;
6.9977652766939;
6.995983431235834;
6.994296212363934;
6.992697801110928;
6.991181286844561;
6.989740983837935;
6.9883697844149;
6.987060342948227;
6.985805667408027;
6.984601172384842;
6.983443665424293;
6.9823296325710995;
6.981254715253869;
6.980217429457746;
6.979217118933966;
6.978252239621142;
6.97731668498365;
6.9764058027393645;
6.975517920006193;
6.97465079463746;
6.973802708778225;
6.97297346274261;
6.972162161448774;
6.971366998771984;
6.970588209667073;
6.969830556673095;
6.9690964393023735;
6.968386334036294;
6.967698211014922;
6.967025886101639;
6.966361999878447;
6.965701659199548;
6.965043180651771;
6.96439223597182;
6.963759469950185;
6.963150860568702;
6.962557970218132;
6.961971009639775;
6.961386932154863;
6.96080905809166;
6.960240528962355;
6.959682925546602;
6.959138501495747;
6.958610765746568;
6.958100688364226;
6.957604968288468;
6.957121306255436;
6.956649247700543;
6.95618848575417;
6.955737917625989;
6.955288962691441;
6.954831976688752;
6.954365651152132;
6.95390028636374;
6.9534462560520245;
6.953006948368893;
6.952584124155859;
6.952181828136819;
6.951799642916937;
6.951427529884941;
6.951052792214103;
6.950675585303138;
6.950301953768792;
6.949933018370978;
6.949564063125626;
6.949192986822426;
6.948824134469546;
6.948466088991731;
6.948124670286928;
6.947799823369772;
6.947486531232165;
6.947178169457774;
6.94686965924819;
6.946561631878852;
6.946257833618177;
6.945957854598461;
6.945655757389079;
6.945350878255219;
6.945049477176116;
6.9447573894186645;
6.9444754605031145;
6.944203820605567;
6.943938484737856;
6.9436727486587415;
6.9434047706347926;
6.943141539187785;
6.942887043912503;
6.942633268523548;
6.9423710261943405;
6.942101348226604;
6.941833209442973;
6.941573023862959;
6.941320500926419;
6.941074288050154;
6.940833680849384;
6.940598914394555;
6.940370775367482;
6.940146951359854;
6.939920118567101;
6.939687392598401;
6.9394536784508825;
6.939225810659979;
6.939005108107775;
6.93878471861247;
6.938559484207865;
6.9383296334473075;
6.938100827527718;
6.9378788435810765;
6.937666316263041;
6.9374646247578875;
6.937269124562186;
6.937071646426732;
]

# T = 0.1, alpha = 1.25, N_chain = 160, maxdim = 100, cutoff = -12, tau = 0.001, jump = 20, boson_dim = 14, omega = 5;
mQ2_T = [0.0;
0.06186736534281158;
0.24031230263222647;
0.5158387061664674;
0.8615868560966448;
1.249126670888843;
1.6530619237027722;
2.0535333149179453;
2.436784181480765;
2.794482221825811;
3.1225077234108274;
3.419694376013207;
3.686764472211176;
3.925530011070327;
4.13834180997414;
4.327735238652357;
4.496217630821412;
4.646151232287078;
4.779697242191201;
4.898796910079828;
5.005173770946605;
5.100346977142347;
5.185649672619654;
5.262248874423913;
5.331164977900701;
5.393289887136406;
5.449403344873179;
5.500187411571473;
5.546239240826808;
5.588082254989741;
5.626175824685368;
5.66092367651538;
5.692681163813054;
5.721761480647459;
5.748441081443065;
5.772964420702707;
5.79554804635401;
5.816384122797128;
5.835643413598719;
5.853477788453583;
5.870022398866235;
5.885397678102468;
5.8997111195844;
5.913058768107561;
5.925526439276093;
5.937190838493836;
5.948120636035884;
5.958377421444729;
5.968016497789058;
5.977087579015671;
5.985635439919515;
5.993700480297116;
6.001319206596528;
6.008524623537294;
6.015346565810142;
6.021811994565373;
6.027945305341506;
6.0337686956377805;
6.039302493475374;
6.044565382689822;
6.049574566572357;
6.054345912753976;
6.058894042106732;
6.0632324179552075;
6.067373463628817;
6.071328741066018;
6.075109124171442;
6.078724872148234;
6.082185614121698;
6.085500345548882;
6.0886774872298375;
6.091724961017023;
6.094650224648369;
6.097460316922802;
6.1001619695167895;
6.102761701154292;
6.105265838800923;
6.107680455905846;
]

vQ2_T = [0.0;
0.9233876577712081;
3.518336537976673;
7.325649435177361;
11.761151526011064;
16.28064624904915;
20.483459647308436;
24.139438528674255;
27.16303932912726;
29.56686807185833;
31.41746208807095;
32.802805444113076;
33.812459372723;
34.52737857435344;
35.01601761999658;
35.333881488633324;
35.52477672942747;
35.622647276323576;
35.65345707036386;
35.63688455035297;
35.587733434273765;
35.51704488022153;
35.4330083539074;
35.34163727832373;
35.247297642282604;
35.15310215172271;
35.061223133571914;
34.9731233366526;
34.889734993090045;
34.81159996058946;
34.738977166058234;
34.671918410508695;
34.610331680423606;
34.55402807658306;
34.50275532938255;
34.456224390628684;
34.41413021390885;
34.37616262401148;
34.342024785581145;
34.3114268579225;
34.28408542324243;
34.259735389166174;
34.23812795291313;
34.219035896727625;
34.20224221791311;
34.18754206402056;
34.17474599296421;
34.16367830595956;
34.15417889136327;
34.146096631326145;
34.13929948367463;
34.1336666052887;
34.129089578332675;
34.12546472434449;
34.122699042277986;
34.120700755624355;
34.11938454652099;
34.118672940006455;
34.11849604393837;
34.118794942383374;
34.11951633124674;
34.12061154310207;
34.12203485774963;
34.123739532883796;
34.125679819515;
34.12781707981408;
34.13011942115909;
34.13256282583319;
34.135123954877116;
34.13777736162594;
34.14049648066923;
34.14325767475389;
34.14604056048675;
34.14882662254355;
34.15159550098935;
34.15432857593693;
34.157013497192565;
34.159642945098945;
]
#= 
fmQ1(x) = (-97.817*x + 536.548*x^2)/(351.553 + 26.2609*x + 395.255*x^2)
fvQ1(x) = (1478.77*x^2 + 150.5*x^4)/(108.058 + 145.549*x^2 + 29.1615*x^4)
fmQ2(x) = (-3.37036*x + 30.2561*x^2)/(6.13764 - 1.71698*x + 4.64394*x^2)
fvQ2(x) = (10.308*x^2 + 5.35486*x^4)/(0.191549 + 0.135901*x^2 + 0.182081*x^4)
fmQ1T(x) = (-0.36018*x + 2.01181*x^2)/(1.32323 + 0.119858*x + 1.47309*x^2)
fvQ1T(x) = (1420.72*x^2 + 401.678*x^4)/(115.792 + 129.448*x^2 + 66.2136*x^4)
fmQ2T(x) = (-31.2982*x + 228.368*x^2)/(42.171 - 9.42199*x + 37.5266*x^2)
fvQ2T(x) = (22.1913*x^2 + 9.46*x^4)/(0.403431 + 0.356355*x^2 + 0.314482*x^4)
 =#
#= 
num = 48
mQ1 = mQ1[1:num]
vQ1 = vQ1[1:num]
mQ2 = mQ2[1:num]
vQ2 = vQ2[1:num]
Sx1 = Sx1[1:num]
Sx2 = Sx2[1:num]

 =#
ω_C = 5


# Time step duration
tau = 0.002


time_steps = collect(0:250) * 0.02 * ω_C
#time_steps4 = collect(0:lastindex(Sx1_T)-1)*10*tau*ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks1 = (2:6:14) #range(2, stop = 15, length = 3)
xticks2 = (2:6:14)
xticks3 = (4:6:15) #range(5, stop = maximum(time_steps[end-1]), length = 3)
xticks3sub = (10:4:15) #range(10, stop = maximum(time_steps[end-1]), length = 2)

yticks1 = (0:3:6) #range(0, stop = 6, length = 3)
yticks2 = (0:15:30) #range(0, stop = 30, length = 3)
yticks3 = (4:2:9) #range(4, stop = 10, length = 4)
yticks3sub = range(4.5, stop = 5.5, length = 2)

#xtick_labels1 = [string(round(x, digits = 1)) for x in xticks1]
    xtick_labels1 = [" " for x in xticks1]

xtick_labels2 = [string(Int(round(x, digits = 1))) for x in xticks2]
xtick_labels3 = [string(Int(round(x, digits = 1))) for x in xticks3]
xtick_labels3sub = [string(Int(round(x, digits = 1))) for x in xticks3sub]
ytick_labels1 = [string(Int(round(y, digits = 1))) for y in yticks1]
ytick_labels2 = [string(Int(round(y, digits = 1))) for y in yticks2]
ytick_labels3 = [string(Int(round(y, digits = 1))) for y in yticks3]
ytick_labels3sub = [string((round(y, digits = 1))) for y in yticks3sub]


# Plot
#= p1 = 
plot(time_steps, fmQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fmQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p1 = plot(time_steps[1:6:length(mQ1)], mQ1[1:6:end], linewidth = 3, xaxis = "", 
	xticks = (xticks1, xtick_labels1), yticks = (yticks1, ytick_labels1),
	xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue) 
plot!(time_steps[1:6:length(mQ2)], mQ2[1:6:end], linewidth = 3, color = :teal) 
plot!(time_steps[1:6:length(mQ1_T)], mQ1_T[1:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[1:6:length(mQ2_T)], mQ2_T[1:6:end], linewidth = 3, color = :brown)
plot!(yaxis = L"⟨Q⟩")
plot!(legend = false)
xlims!(0, 15)  
ylims!(0, 7)  
plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(bottom_margin = -8mm)
annotate!(14, 4.7, text("(a)", 17, :black, :right))
ticks_length!(tl=.03)




#= p2 = plot(time_steps, fvQ1.(time_steps), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2.(time_steps), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ1T.(time_steps), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps, fvQ2T.(time_steps), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p2 = plot(time_steps[1:6:length(vQ1)], vQ1[1:6:end], linewidth = 3, xticks = (xticks2, xtick_labels2), yticks = (yticks2, ytick_labels2), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, color = :lightblue, seriesalpha = 1, xaxis = "") #, label = L"\  (1, 1.5)")
plot!(time_steps[1:6:length(vQ2)], vQ2[1:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(time_steps[1:6:length(vQ1_T)], vQ1_T[1:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[1:6:length(vQ2_T)], vQ2_T[1:6:end], linewidth = 3, color = :brown)
plot!(widen = false)
xlims!(0, 15)  
ylims!(0, 38)  
plot!(yaxis = L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel = false)
vline!([xlims(p2)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p2)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false)
plot!(legend = false)
annotate!(14, 24, text("(b)", 17, :black, :right))
ticks_length!(tl=.03)
plot!(xaxis = L"tω_C")



#= p3 = plot(time_steps[10:end], fvQ1.(time_steps[10:end])./fmQ1.(time_steps[10:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2.(time_steps[10:end])./fmQ2.(time_steps[10:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ1T.(time_steps[10:end])./fmQ1T.(time_steps[10:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(time_steps[10:end], fvQ2T.(time_steps[10:end])./fmQ2T.(time_steps[10:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
p3 = plot(time_steps[8:6:length(vQ1)], vQ1[8:6:end] ./ mQ1[8:6:end], color = :lightblue, xticks = (xticks3, xtick_labels3), yticks = (yticks3, ytick_labels3), xtickfont = font(14), ytickfont = font(14),
	xguidefontsize = 24, yguidefontsize = 22, seriesalpha = 1, xaxis = "", linewidth = 3) #, label = L"\  (1, 1.5)")
plot!(time_steps[8:6:length(vQ2)], vQ2[8:6:end] ./ mQ2[8:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(time_steps[8:6:length(vQ1_T)], vQ1_T[8:6:end] ./ mQ1_T[8:6:end], linewidth = 3, color = :lightcoral)
plot!(time_steps[8:6:length(vQ2_T)], vQ2_T[8:6:end] ./ mQ2_T[8:6:end], linewidth = 3, color = :brown)
plot!(widen = false)
#plot!(yaxis = L"F")
ylims!(4., 10)  
xlims!(0, 16)  
vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false)
plot!(grid = false, ymirror = true)
plot!(legend = false)
annotate!(19.5, 7, text(L"F", 24, :black, :right))
ticks_length!(tl=.02)
annotate!(15.2, 9.6, text("(c)", 17, :black, :right))
plot!(xaxis = L"tω_C")


plot!(p3, inset=bbox(0.35,0.01,0.42, 0.6), subplot=2)

#= plot!(p3[2], time_steps[50:end], fvQ1.(time_steps[50:end])./fmQ1.(time_steps[50:end]), color = :lightblue, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2.(time_steps[50:end])./fmQ2.(time_steps[50:end]), color = :teal, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ1T.(time_steps[50:end])./fmQ1T.(time_steps[50:end]), color = :lightcoral, seriesalpha = 1, linewidth = 2, label = false)
plot!(p3[2], time_steps[50:end], fvQ2T.(time_steps[50:end])./fmQ2T.(time_steps[50:end]), color = :brown, seriesalpha = 1, linewidth = 2, label = false) =#
plot!(p3[2], time_steps[50:6:length(vQ1)], vQ1[50:6:end] ./ mQ1[50:6:end], color = :lightblue, xticks = (xticks3sub, xtick_labels3sub), yticks = (yticks3sub, ytick_labels3sub), xtickfont = font(12), ytickfont = font(12),
	xguidefontsize = 10, yguidefontsize = 15, seriesalpha = 1, xaxis = "", linewidth = 3) #, label = L"\  (1, 1.5)")
plot!(p3[2], time_steps[50:6:length(vQ2)], vQ2[50:6:end] ./ mQ2[50:6:end], linewidth = 3, color = :teal) #, label = L"\ (0.1, 0.75)")
plot!(p3[2], time_steps[50:6:length(vQ1_T)], vQ1_T[50:6:end] ./ mQ1_T[50:6:end], linewidth = 3, color = :lightcoral)
plot!(p3[2], time_steps[50:6:length(vQ2_T)], vQ2_T[50:6:end] ./ mQ2_T[50:6:end], linewidth = 3, color = :brown)
ylims!(p3[2], 4.4, 5.9)  
xlims!(p3[2], 7, 15)  
#= vline!([xlims(p3)[1]], lc = :black, lw = 2, label = false)
hline!([ylims(p3)[2]], lc = :black, lw = 2, label = false) =#
plot!(p3[2], grid = false)
plot!(p3[2], legend = false, aspect_ratio = 5., framestyle = :box)	
#annotate!(19.7, 4.7, text(L"F", 24, :black, :right))
#annotate!(14.5, 5.8, text("(c)", 20, :black, :right))
#plot!(p3[2], xaxis = L"tω_C")
#plot!(p3[2], xaxis = " ")



custom_layout = @layout [[a{0.5h}; b{1.35w}] c{0.6w}]
p = plot(p1, p2, p3, layout = custom_layout, size = (600, 400), left_margin = 5mm, right_margin = 7mm)



#p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png", p)

