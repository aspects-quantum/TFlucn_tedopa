using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(;tl=0.02)
    p = Plots.current()
    xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
    xl, yl = Plots.xlims(p), Plots.ylims(p)
    x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
    sz = p.attr[:size]
    r = sz[1]/sz[2]
    dx, dy = tl*(xl[2] - xl[1]), tl*r*(yl[2] - yl[1])
    plot!([xticks xticks]', [y1 y1 .+ dy]', c=:black, labels=false)
    plot!([x1 x1 .+ dx]', [yticks yticks]', c=:black, labels=false, xlims=xl, ylims=yl)
    return Plots.current()
end
# Define data


T = 0.1
α = 0.5

#T = 0, alpha = 0.1, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;

mQ1 = [1.1548289194346837e-10;
0.0003120066328231101;
0.010988441634399096;
0.03510680762979128;
0.06878226688970603;
0.10775388778786078;
0.1483002897657531;
0.18708027226396692;
0.2232064037376123;
0.25566161753916233;
0.2842526784069933;
0.30940410592089534;
0.3312218836552533;
0.35023510324383667;
0.3668965575602423;
0.38162123500430595;
0.39448260167444754;
0.4053872621154928;
0.4148079052848426;
0.4230477847178284;
0.43004908882744225;
0.4367979096234406;
0.4429907738504922;
0.44736008954582884;
0.4526291824913432;
0.45745338401469443;
0.4616871493264878;
0.46573889318876244;
0.46933914635266333;
0.4726285588516753;
0.47561473226252826;
0.4786240736024611;
0.4816900129063305;
0.48463623111105764;
0.48760153190358885;
0.4907350983944678;
0.4940604505325087;
0.4957741402277561;
0.49829185428067235;
0.5016008041844393;
0.5035923894714975;
0.5072628038625253;
0.5092023339295692;
0.5096685323671432;
0.5085039210458027;
0.5119114526007742;
0.5142886510781237;
0.5163100877976441;
0.5182913231707477;
0.5149499751283063;
0.5168067640756963;
0.5168455299633741;

]
vQ1 = [1.316148913939056e-20;
9.740525905711966e-8;
0.16236435732124363;
0.502355944139672;
0.9409905990755112;
1.3941483729853192;
1.8070561455917493;
2.138830656067847;
2.400611658289239;
2.595311910418992;
2.7328090923771016;
2.838468472777996;
2.9030724606101814;
2.9527858471205604;
2.9984414771936456;
3.049872726235353;
3.040668437683771;
3.032236370681957;
3.0330621004013105;
3.033041816257962;
3.0155227516220577;
3.000509301994374;
2.979393067482374;
2.960931203088789;
2.954967159035859;
2.9598621843564943;
2.9408652284298995;
2.9053274615913933;
2.9067298358475377;
2.8836213379886764;
2.8381961226345527;
2.8249143998850967;
2.8258486276900654;
2.833255859435108;
2.8252915650011445;
2.819992220313522;
2.8307617494871873;
2.815485857234638;
2.807103963234848;
2.8115050515091697;
2.7957759886669034;
2.7464461143520733;
2.7386640067967525;
2.667417333540646;
2.6676017391595215;
2.714545986754626;
2.5196616304329904;
2.494442315703144;
2.5043524909511583;
2.2771230364291752;
2.184116047587022;
2.2104547045274905;
]
#

#T = 0, alpha = 1.5, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;
mQ2 = [2.4292158838401497e-10;
0.0046799828250777085;
0.16482678771973344;
0.5265580201407486;
1.0330182808866737;
1.6178969357605857;
2.2238196508644723;
2.8092266880836285;
3.3495715522196865;
3.834020550656686;
4.258576460052674;
4.636559118728705;
4.954497019954804;
5.2313329263229384;
5.469209772812501;
5.674007499900834;
5.8510085929372195;
6.003766257216114;
6.135702847410954;
6.250515265853334;
6.350243119945167;
6.43640891032271;
6.510810386176094;
6.577169579510763;
6.635138893195992;
6.683791155192243;
6.728594176860648;
]

#T = 0, alpha = 1.5, N_chain = 180, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 16, omega_C = 5, jump = 5;

vQ2 = [6.367301730915374e-20;
2.1914029432656162e-5;
2.4608508356961396;
7.8002137770964275;
15.130750435307947;
23.38467446426539;
31.6932787531177;
39.51367174098088;
46.499071452011734;
52.642291780279734;
57.70517226975717;
62.31069811657466;
66.00824057388694;
69.21501685350141;
71.64744648661784;
74.07400916028;
75.98008466897875;
77.60343290192013;
78.90639718855634;
80.07910721726628;
81.0798758683694;
81.97533175135142;
82.7727447632775;
83.19512418487638;
83.73081243670603;
84.11794264323704;
84.53365170460795;
]

#T = 0, alpha = 1.5, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, jump = 5, omega_C = 5, boson_dim = 13;
Sx2 = [0.5000000000000079;
0.4999937539153088;
0.4997788975180781;
0.4992608400104756;
0.4984682694772785;
0.4974238988186841;
0.4961715698239579;
0.49474481233133827;
0.4931870233412073;
0.49153918159946874;
0.48984072023888736;
0.4881272217767965;
0.48642747101466566;
0.4847715979701658;
0.4831820321147927;
0.4816713648177493;
0.48025288020973655;
0.47893338744139;
0.47771379867712604;
0.476594339459994;
0.47557395791521373;
0.47464589446634375;
0.47380551114060365;
0.473047023539649;
0.4723633889130105;
0.47174972805520154;
0.47120129084630585;
0.4707091044035708;
0.4702690286716751;
0.4698745028980611;
0.4695221171607096;
0.46920673923851286;
0.4689245135551995;
0.46867209546444905;
0.46844539748823727;
0.4682415266568821;
0.46805912406845707;
0.467895168019274;
]



#T = 0, alpha = 0.1, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, jump = 5, omega_C = 5, boson_dim = 13;
Sx1 = [0.5000000000000079;
0.499993750273277;
0.4997753516538661;
0.499247653096056;
0.49841215415803913;
0.4972661512097529;
0.49581932107717225;
0.49407537212002944;
0.49203325766001244;
0.4897056074327806;
0.48709013164392323;
0.48419879381322284;
0.48103043354971153;
0.4775961598862138;
0.4738982850171625;
0.4699435127729113;
0.4657373069311448;
0.4612854857326785;
0.4565938542497714;
0.451668895513928;
0.4465157011281731;
0.4411405980976286;
0.435546069028752;
0.4297388637015962;
0.42372427396143;
0.4175082592797544;
0.411098999754206;
0.4044972362533452;
0.3977100242902663;
0.3907437503133952;
0.38360461563657783;
0.37629809354583876;
0.36882743840349347;
0.3611992431494381;
0.35341994792935555;
0.3454965730669159;
0.3374304621156686;
0.3292300902830357;
0.3209005502341082;
0.3124482193220841;
0.30387770964382455;
0.2951932040502059;
0.2864019096403889;
0.2775096705818049;
0.26852126072708177;
0.25944147751261026;
0.25027736848380194;
0.2410339688932861;
0.2317162313187679;
0.2223304280611705;
0.2128813619366386;
0.20337505751022905;
0.1938164600388608;
0.18421116840602506;
0.17456473650111734;
0.16488242755275376;
0.1551694681631056;
0.14543098532796755;
0.13567265602036144;
0.12589976327143662;
0.11611714776324002;
0.10632984014850906;
0.09654369638667143;
0.0867633433789585;
0.07699374900441934;
0.06724042572013485;
0.05750775620196002;
0.047800916502853015;
0.038124092997061584;
0.028482476069063272;
0.0188812846675323;
0.009325600778337042;
-0.00018071170622296085;
-0.009633175598690875;
-0.01902662945980023;
-0.02835671315382775;
-0.03761930117885838;
-0.04681023818251692;
-0.0559255593238911;
-0.064960239263983;
-0.07391102886450211;]



mQ1 = mQ1[1:26]
vQ1 = vQ1[1:26]
mQ2 = mQ2[1:26]
vQ2 = vQ2[1:26]
Sx1 = Sx1[1:26]
Sx2 = Sx2[1:26]


ω_C = 5


# Time step duration
tau = 0.005  


time_steps = collect(0:lastindex(mQ1)-1)*5*tau*ω_C


# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0.2, stop = maximum(time_steps[end-1]), length = 5)
yticks1 = range(0, stop = 6, length = 4)
yticks2 = range(0, stop = 70, length = 4)
yticks3 = range(0, stop = 15, length = 4)
yticks4 = range(0.3, stop = .5, length = 7)

xtick_labels = [string(round(x, digits = 1)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]
ytick_labels3 = [string(round(y, digits = 1)) for y in yticks3]
ytick_labels4 = [string(round(y, digits = 2)) for y in yticks4]


p1 = scatter(time_steps[1:2:end], mQ1[1:2:end], markersize=6, markerstrokewidth=1, xaxis = "", #yaxis = L"\langle Q \rangle", 
xticks = (xticks, xtick_labels), yticks = (yticks1, ytick_labels1),
xtickfont = font(14), ytickfont = font(14), 
xguidefontsize=24,yguidefontsize=22, color = :teal) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:2:end], mQ2[1:2:end], markersize=6, markerstrokewidth=1, color = :lightcoral) #, label = L"\ (0.1, 0.75)")
plot!(yaxis=L"⟨Q⟩")
plot!(legend=false)
plot!(widen=false)
vline!([xlims(p1)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p1)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
#= 
curves!(twinx(), x, 2 * cos.(x), yaxis = "Y label 2"; kw...)
 =#

p2 = scatter(time_steps[1:2:end], vQ1[1:2:end], markersize=6, markerstrokewidth=1, color = :teal, seriesalpha = 1, xaxis = "", linewidth = 7) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:2:end], vQ2[1:2:end], markersize=6, markerstrokewidth=1, color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),  yticks = (yticks2, ytick_labels2),
seriesalpha = 1, linewidth = 7,xguidefontsize=24,yguidefontsize=22)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"⟨⟨Q^2⟩⟩")
plot!(xaxislabel=false)
vline!([xlims(p2)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p2)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)

#plot!(legend = :outertopright)
#plot!(legend = (.6,0.7), grid = false, legendfontsize = 13) #, left_margin = [2mm 0mm], right_margin = [0mm 3mm], bottom_margin = [3mm 3mm])   #,framestyle = :box), legendposition = (1.6, 0.7)

#ticks_length!(tl=.02)

p3 = scatter(time_steps[1:2:end], vQ1[1:2:end]./mQ1[1:2:end], markersize=6, markerstrokewidth=1, color = :teal, seriesalpha = 1, xaxis = "", linewidth = 7) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:2:end], vQ2[1:2:end]./mQ2[1:2:end], markersize=6, markerstrokewidth=1, color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),  yticks = (yticks3, ytick_labels3),
seriesalpha = 1, linewidth = 7,xguidefontsize=24,yguidefontsize=22)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"F")
vline!([xlims(p3)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p3)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)


#############
p4 = scatter(time_steps[1:2:end], Sx1[1:2:end], markersize=6, markerstrokewidth=1, color = :teal, seriesalpha = 1, xaxis = "", linewidth = 7,  yticks = (yticks4, ytick_labels4)) #, label = L"\  (1, 1.5)")
scatter!(time_steps[1:2:end], Sx2[1:2:end], markersize=6, markerstrokewidth=1, color = :lightcoral,xtickfont = font(14), ytickfont = font(14), xticks = (xticks, xtick_labels),
seriesalpha = 1, linewidth = 7,xguidefontsize=24,yguidefontsize=22)#, label = L"\ (1, 0.75)", yaxis = L"\langle\langle Q^2 \rangle\rangle")
plot!(widen=false)
plot!(yaxis=L"S_x")
vline!([xlims(p4)[2]], lc=:black, lw=2, label = false)
hline!([ylims(p4)[2]], lc=:black, lw=2, label = false)
plot!(grid = false)
plot!(legend=false)




p=plot(p1, p2, p3, p4, layout=(2,2))

display("image/png",p)

