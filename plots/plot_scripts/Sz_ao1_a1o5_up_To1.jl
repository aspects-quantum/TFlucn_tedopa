

using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


#T = 0.1, alpha = 0.1, N_chain = 140, maxdim = 80, cutoff = -11, tau = 0.005, jump = 10, boson_dim = 12;

Sz1 = [0.5000000000000158, 0.49999807671780044, 0.49999306899372464, 0.49998588744465067, 0.49997684172767776, 0.49996599067803, 0.49995334188673146, 0.49993890134327823, 0.49992268105628423, 0.4999047050136479, 0.4998850087765842, 0.4998636360272944, 0.49984064508333564, 0.49981610302976964, 0.4997900825679517, 0.4997626614245358, 0.49973392634003866, 0.49970396899534253, 0.49967288038934055, 0.4996407560929917, 0.49958377947790744, 0.49951728291041, 0.49944934016035664, 0.49938016943211705, 0.4993099925207529, 0.4992390345131292, 0.4991675231869707, 0.49909568822475125, 0.49902376032073964, 0.4989519704010677, 0.49888054872317233, 0.4988097239782283, 0.4987397225025352, 0.4986707694246638, 0.4986031768688218, 0.49853717039627427, 0.4984728247029344, 0.49841023638409676, 0.49834963599572374, 0.4982913531377776, 0.4982356549980693, 0.49818264588967376, 0.49813237620743755, 0.49808506566001404, 0.49804096289545063, 0.49800019582709854, 0.49796285101649357, 0.49792897612083037, 0.49789858554813493, 0.4978717385549496, 0.4978484626823814, 0.49782874745462874, 0.49781267102620536, 0.49780031577672756, 0.4977919994512465, 0.4977877149831961, 0.49778713439584626, 0.49779040278328923, 0.4977975584613064, 0.49780829264557086, 0.49782260182781646, 0.4978408073408518, 0.49786265779095445, 0.4978875849185289, 0.49791562890818536, 0.4979472567224815, 0.49798238835430436, 0.4980202957779028, 0.4980604975687784, 0.49810328699227635, 0.49814916879223214, 0.49819799301701956, 0.49824895712670964, 0.4983013428215257, 0.49835506864594437, 0.49841059392749326, 0.49846821715673345, 0.4985276521408694, 0.4985881521771096, 0.4986490667966952, 0.4987102384153176, 0.4987718544031117, 0.4988341401674877, 0.4988971095432032, 0.4989604347142842, 0.4990235168933151, 0.49908574547462214, 0.499146745872342, 0.4992064836066572, 0.4992651313058417, 0.4993228774153231, 0.49937972208708, 0.4994354531711623, 0.4994896747473237, 0.4995419035228849, 0.4995917278571262, 0.49963889357547003, 0.4996833621596598, 0.49972519343390925, 0.4997645081444527, 0.4998014151039075, 0.4998359508482148, 0.4998680374832896, 0.49989744953625526, 0.4999239679319615, 0.4999473491291022, 0.49996738919634115, 0.49998400799911485, 0.4999971488364678, 0.5000068591807426, 0.5000132881611904, 0.5000165295441689, 0.5000167215712923, 0.5000140646966619, 0.5000085823167184, 0.5000002477100859, 0.4999891402220864, 0.49997520758486474, 0.49995827202823406, 0.49993835273658005, 0.4999155768915845, 0.4998898722959215, 0.49986116465158537, 0.49982969584388587, 0.49979577187788565, 0.49975942567680903, 0.4997206788715857, 0.49967989354507886, 0.4996375237519148, 0.499593672130018, 0.49954821308043945, 0.4995012455788513, 0.49945317732576144, 0.49940429749233, 0.4993544979831832, 0.4993035643842413, 0.49925161189906686, 0.49919908248981637, 0.4991462845089597, 0.49909314817560235, 0.4990394758031815, 0.4989853643442008, 0.4989313258019611, 0.4988779113985715, 0.49882528396990905, 0.49877324104707793, 0.49872158170918357, 0.49867048952398535, 0.49862043939855516, 0.4985719314744351, 0.4985250908461485, 0.498479728239207, 0.49843573442765304, 0.4983932415855577, 0.4983526943699825, 0.49831453419661104, 0.49827903020903636, 0.498246082578827, 0.4982152242855941, 0.49818627118120046, 0.49815935568580194, 0.4981348138189461, 0.4981131085875862, 0.4980943212461241, 0.4980780425767495, 0.4980639321498806, 0.4980517604352725, 0.4980414594583964, 0.49803340855650774, 0.4980280202302808, 0.49802536737931363, 0.4980254088424208, 0.4980279023815773, 0.4980323398217491, 0.49803847937644136, 0.4980465810581431, 0.49805687880033056, 0.4980694668430186, 0.49808462821410404, 0.49810255966944866, 0.4981228525279474, 0.49814495266993813, 0.4981687558986934, 0.49819425852942206, 0.49822137779930936, 0.49825023477583014, 0.49828120349310706, 0.49831446183130906, 0.49834960657833804, 0.4983861204298321, 0.4984238337809376, 0.49846255777104737, 0.49850191586040565, 0.4985415934442394, 0.4985816826771266, 0.49862248146316207, 0.49866413972915663, 0.4987063751513343, 0.498748919218683, 0.49879175689276006, 0.49883486606412886, 0.49887790233511253, 0.4989202618244495, 0.49896166473508957, 0.49900219922953776, 0.49904206570749654, 0.4990813400773921, 0.4991198281258067, 0.4991573839981388, 0.49919412642437183, 0.49923025558839385, 0.49926567472848166, 0.4992998390769909, 0.4993321528659189, 0.49936242593758345, 0.49939068429530575, 0.4994170037314357, 0.49944141775193535, 0.499463707942759, 0.4994836651718619, 0.49950151158167716, 0.4995178150816186, 0.4995327869763979, 0.499546233322926, 0.49955787903838594, 0.49956737638148985, 0.49957467580190235, 0.49958001064116725, 0.4995835301937441, 0.4995850945050471, 0.4995845518290189, 0.499581663994678, 0.4995763586638445, 0.49956902002776415, 0.4995601158337441, 0.49954985697571885, 0.49953820511526614, 0.49952503829144307, 0.4995102719799727, 0.4994938804436966, 0.49947602948778913, 0.49945705536512386, 0.4994370588221455, 0.49941579863161756, 0.49939297727416665, 0.49936850264370247, 0.4993424735504616, 0.4993149766114711, 0.4992862567757834, 0.49925678189924105, 0.49922672145576313, 0.4991959153623227, 0.49916414617419896, 0.49913155920960905, 0.49909856812014364, 0.4990652791400141, 0.4990317918148054, 0.49899831377024506, 0.49896515710589595, 0.4989322541252867, 0.4988991502624972, 0.49886561984593253, 0.4988317965298002, 0.49879804004174483, 0.4987645576110847, 0.49873133371950307, 0.4986984868382699, 0.4986662152697039, 0.4986345158900014, 0.4986032889195642, 0.49857243569204746, 0.498542110063971, 0.49851295309804255, 0.498485466026653, 0.4984596511176187, 0.4984351720265149, 0.4984119491107966, 0.49839001898864155, 0.4983693311496031, 0.4983497494260768, 0.4983310524807784, 0.4983132144301343, 0.4982967459829212, 0.498282212701701, 0.4982697206116162, 0.498258921672556, 0.4982495426162226, 0.49824130680985557, 0.4982343107969507, 0.4982287036350571, 0.4982243933015756, 0.49822117870851723, 0.4982191054360541, 0.4982185781002212, 0.49822002081543576, 0.49822363221290666, 0.4982293672875952, 0.4982367845138448, 0.4982454240093773, 0.4982551743850301, 0.49826635069035163, 0.4982792001807618, 0.49829353356419226, 0.4983091404589898, 0.4983259283538113, 0.49834388533662277, 0.4983630925679485, 0.4983836388312698, 0.4984055884010421, 0.4984285093256443, 0.49845172704551893, 0.49847502481375655, 0.4984986171697611, 0.4985228548985685, 0.49854779509345126, 0.4985732298870966, 0.4985991469401961, 0.49862548732195805, 0.49865201371987794, 0.4986786967549401, 0.4987056764149742, 0.49873310972289286, 0.49876084659110786, 0.49878833429193953, 0.49881518690316823, 0.4988415892188473, 0.4988677475902703, 0.49889366062315604, 0.4989194399348614, 0.49894508404410864, 0.49897052992872326, 0.4989956775341366, 0.4990202095056282, 0.4990438311386458, 0.49906660955310994, 0.4990887626063635, 0.4991101875430646, 0.49913046386548, 0.49914931606260005, 0.499166624578573, 0.49918244796830447, 0.49919689930384176, 0.49920976758869556, 0.49922114562791703, 0.4992313817705004, 0.49924081070612764, 0.4992493738617804, 0.4992564506891334, 0.4992615256189476, 0.4992647174390243, 0.4992664431515827, 0.4992673508481076, 0.49926804823910764, 0.49926806035918736, 0.49926669965247805, 0.49926407094520203, 0.4992604776629551, 0.4992552601568201, 0.49924793957295893, 0.4992390608936739, 0.49922883600566975, 0.49921778502071623, 0.49920656321997847, 0.49919522809713635, 0.4991831817957863, 0.49916927217722384, 0.49915366521446286, 0.4991369398939117, 0.49911967603141005, 0.4991022781981282, 0.49908430912321344, 0.4990659726333072, 0.4990474232729221, 0.49902822748604314, 0.4990085375924399, 0.49898822946565735, 0.4989663155439028, 0.4989426134860477, 0.4989174792962056, 0.4988926549680441, 0.4988700373722153, 0.4988489819525637, 0.49882843606676963, 0.4988079436228587, 0.4987865850840682, 0.49876334094375185, 0.49873837809825156, 0.49871325537410405, 0.4986883463593818, 0.49866414801098474, 0.49864101911242337, 0.4986185205061916, 0.49859720587433254, 0.4985772864735732, 0.4985579524145673, 0.49853886183249574, 0.498519818399025, 0.49850079102028755, 0.49848155916151, 0.49846273897086285, 0.49844598784931526]


#T = 0.1, alpha = 1.5, N_chain = 140, maxdim = 80, cutoff = -11, tau = 0.005, jump = 10, boson_dim = 12;
Sz2 = [0.5000000000000158;
0.4999711486670101;
0.49983429002679436;
0.4996291212230531;
0.49936240762062784;
0.49903774224100605;
0.49865616963714204;
0.49822285433414754;
0.49774025255578525;
0.49720649578938464;
0.4966203013638639;
0.49598358956172217;
0.4952962510288682;
0.4945624406238346;
0.4937806497014605;
0.4929554856828852;
0.4920933395244521;
0.4911908034538857;
0.4902531446434397;
0.4892836868060726;
0.48828508355603223;
0.48726238942977756;
0.4862146446199329;
0.4851506690305918;
0.4840704710206015;
0.48297401505975623;
0.4818723026336645;
0.48076315519799373;
0.4796492277511596;
0.47853792595037425;
0.4774324657142935;
0.4763352820039526;
0.475249581949806;
0.47417895484803424;
0.4731282917642931;
0.4721010110346031;
0.471101032079487;
0.4701342184730219;
0.4692064291214521;
0.4683123331750251;
0.46745823719611046;
0.4666488438683905;
0.46587753185239816;
0.4651371129562638;
0.4644435662439951;
0.4638045265492497;
0.46321169638313403;
0.46267846532213625;
0.4622018821642439;
0.4617735926511378;
0.46142134430362863;
0.46111780275628766;
0.4608650136320077;
0.4607012485725976;
0.46059108019297273;
0.46051638294513936;
0.4605468012748711;
0.4606575720503008;
0.4607773251883169;
0.4609509904118998;
0.46124067895226495;
0.4615977794991425;
0.4619528124233913;
0.462333918715071;
0.4628264398722745;
0.46342793461000426;
0.4640472127706189;
0.46463586485998065;
0.46525601360915675;
0.4659935309966467;
0.46684110553680913;
0.4677141878965428;
0.46854816235952934;
0.4693527657482831;
0.470200100581299;
0.47113806976679307;
0.47215677894205005;
0.4731916763164202;
0.4741854601137519;
0.47512484990868653;
0.4760512308089852;
0.4770106596091732;
0.47803043296179315;
0.47910001500434174;
0.4801756001339306;
0.48121369741615916;
0.48219286045627824;
0.4831092111808203;
0.4839933772474676;
0.484868781170212;
0.48575474941710495;
0.48665133049961284;
0.48754730392578655;
0.4884213547005931;
0.4892455554318659;
0.4900090980725481;
0.49070106313910283;
0.4913262547436262;
0.4918973208025402;
0.49242140729609496;
0.4929128249764542;
0.4933770680408939;
0.49380606709872243;
0.494202859180992;
0.49456002234904406;
0.4948590383312899;
0.4951075027778804;
0.49530126623017157;
0.49542881513908804;
0.49548641334193233;
0.4954842865122939;
0.49541762583294074;
0.4952791352291572;
0.49509135390894526;
0.49486638105809216;
0.4945958008292268;
0.49428227849395;
0.49394822567860597;
0.4935957885157188;
0.4932115008369201;
0.49278734405600355;
0.4923331241512272;
0.4918550276245303;
0.49133151650943996;
0.49073907333558153;
0.49009177971294343;
0.4894108378197059;
0.488686394093802;
0.4878960305397741;
0.48704605781769417;
0.486167057131517;
0.4852924773792;
0.48441649249984226;
0.48352342544807525;
0.48262160864441983;
0.48174097617487566;
0.48091020455664624;
0.48010900369384824;
0.4793100684064087;
0.4784933745738864;
0.47767649319305827;
0.47689023392313706;
0.4761333984509239;
0.4753860349398941;
0.4746078641153052;
0.4737962757528297;
0.47298342146300104;
0.47219321975553336;
0.47144752156285297;
0.4707240772962534;
0.46998340865366317;
0.46922749956045934;
0.4684649084969786;
0.46772557564984235;
0.467057805009316;
0.46646840715635285;
0.46592303705733384;
0.46540729298789124;
0.46490305415867045;
0.4644015663779764;
0.4639536262123671;
0.4636010554802953;]
#


Sz1 = Sz1[1:162]
Sz2 = Sz2[1:162]

# Time step duration
tau = 0.005
nt = 250
omega_C = 10
ttotal = nt * tau  # Total time evolution
#time_steps = collect(0:10*tau:ttotal)

time_steps = collect(0:lastindex(Sz1)-1) * 10 * tau*omega_C

# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0, stop = maximum(time_steps), length = 5)
yticks1 = range(0, stop = 6, length = 5)
yticks2 = range(0, stop = 60, length = 5)
#= 
xtick_labels = [L"\$" * string(round(x, digits = 2)) * "\$" for x in xticks]
ytick_labels1 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks1]
ytick_labels2 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks2] =#

xtick_labels = [string(round(x, digits = 1)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]


p1 = plot(time_steps, Sz1, xaxis = L"tω_C", yaxis = L"S_z", #yaxis = L"\frac{\langle\langle Q^2 \rangle\rangle}{\langle Q \rangle}", 
xtickfont = font(20), ytickfont = font(20), xticks = (xticks, xtick_labels),
xguidefontsize=28,yguidefontsize=28, color = :cornflowerblue,
seriesalpha = 1, linewidth = 9, label = "")

# Add a dummy dataset with markers for the legend
#= scatter!(time_steps, Sz1,
      color = :cornflowerblue, marker = :circle, markersize=5, markerstrokewidth=0,# Marker-only for legend
      label = L"\ \alpha = 0.1")

# Add a dummy dataset with markers for the legend
scatter!(time_steps, Sz2, seriesalpha=0.5,
      color = :violetred4, marker = :circle, markersize=5, markerstrokewidth=0, # Marker-only for legend
      label = L"\ \alpha = 1.5") =#
plot!(time_steps, Sz2, color = :violetred4,seriesalpha = .8, linewidth = 9, label = "")


plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
#plot!(legend = :outertopright)
plot!(size=(500, 400))

#title!(string(L"\epsilon = 1, \Delta = 0, ω_C = 10, |1\rangle"))

ticks_length!(tl=.02)

# Customize plot appearance, place legend inside
plot!(legend = false, grid = false, legendfontsize = 20, left_margin = [2mm 0mm], right_margin = [10mm 10mm])   #,framestyle = :box), legendposition = (1.6, 0.7)

display("image/png", p1)
