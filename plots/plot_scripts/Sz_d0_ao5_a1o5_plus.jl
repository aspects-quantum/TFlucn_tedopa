

using DrWatson, Plots, LaTeXStrings

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


#T = 0.01, alpha = 0.5, N_chain = 160, maxdim = 80, cutoff = -12, tau = 0.005, boson_dim = 12;

mQ1 = [0, 4.163336342344337e-16, -9.984822159946101e-8, -1.1880674665948618e-6, -4.717208145221893e-6, -1.1815200846308038e-5, -2.2867141198216205e-5, -3.766471800055895e-5, -5.581946019056911e-5, -7.68930619976634e-5, -0.00010046477474962901, -0.00012619384920896766, -0.00015379190374682503, -0.00018299255838237925, -0.00021354409646597152, -0.0002452395081498553, -0.0002779352259752877, -0.0003115202606916182, -0.00034589681819158257, -0.0003809013641236629, -0.0004165217775077681, -0.0004528867723540912, -0.0004900879094872989, -0.0005281450128375589, -0.0005670106508515066, -0.0006066255025154736, -0.0006469752652597735, -0.0006880755503448303, -0.0007299319534093992, -0.0007725303920855386, -0.0008158373470047219, -0.0008597977199599711, -0.0009043451662382899, -0.000949414592417765, -0.000994951632949172, -0.001040923953581809, -0.0010873167361481755, -0.0011340996086941458, -0.0011812115588574986, -0.001228544022750878, -0.0012759603916719187, -0.001323392138667275, -0.0013708726828245026, -0.00141845726768701, -0.0014661520319953628, -0.001513906724996882, -0.0015616538812374475, -0.0016093740653343866, -0.0016570517008866656, -0.001704681399082572, -0.0017523191752154106, -0.001799970265150493, -0.0018475408426128442, -0.0018949245212865568, -0.0019420485762840405, -0.001988837313542038, -0.002035262417769746, -0.002081370192753303, -0.002127362521839946, -0.002173520027295193, -0.00221994204000626, -0.0022666432196508067, -0.0023135150099947046, -0.0023603804142258277, -0.002406999465374613, -0.0024533259311629472, -0.0024996133653616107, -0.0025461907377374404, -0.0025930974322035307, -0.0026400953002687043, -0.0026870323463565066, -0.0027339624502633487, -0.0027809508038240823, -0.0028280343233090264, -0.002875257950457656, -0.0029226721361606434, -0.0029703100433288907, -0.00301817201046522, -0.003066341240547564, -0.003114864557016765, -0.0031636658874161444, -0.0032125986613224483, -0.003261680581006838, -0.0033110960632984354, -0.0033609613460235713, -0.0034112624515450387, -0.0034619773706402934, -0.0035130678154454242, -0.003564506594988597, -0.0036163618247343956, -0.0036685024124821744, -0.0037209316066210488, -0.003773768603386666, -0.0038268342760750308, -0.003880235354078318, -0.0039341718857603845, -0.00398827038949269, -0.004042505035922791, -0.004097399973091166, -0.004152723732092092, -0.004207881890283378, -0.004263273987033422, -0.004319415156968937, -0.0043756764811311724, -0.0044315350396230725, -0.004487790076830957, -0.00454515170637436, -0.004602839551555639, -0.004659833913736533, -0.004716627774866589, -0.004774550560053667, -0.00483359390211031, -0.004892288515825745, -0.004949773582550519, -0.005006930048887781, -0.005065027005117489, -0.005124014012933862, -0.0051827951807465, -0.005240810970357322, -0.0052987160074982565, -0.005357362864162842, -0.005416764739915407, -0.005476174147356465, -0.005534969343472736, -0.005593253812037791, -0.005651648573855943, -0.005710563742633838, -0.005769718074996932, -0.005828622171955107, -0.005887306768448826, -0.005946365964213401, -0.006006198578523379, -0.006066288175031039, -0.006125554095264435, -0.00618335363657124, -0.006240163733140878, -0.00629737950105295, -0.006356410334419061, -0.0064177041442348435, -0.0064801103412198535, -0.006541308453995532, -0.0065992987085798, -0.006653944220857845, -0.0067072752330395195, -0.006762419947164226, -0.006821894471774787, -0.006886086724106218, -0.0069528339561059855, -0.0070184908385139185, -0.007079649017021161, -0.007134815568382757, -0.007185294218835518, -0.007234666939910957, -0.00728719018609872, -0.007345910802776194, -0.00741136019514647, -0.007481319330691089, -0.00755171421886565, -0.007618222183083405, -0.007677959254765148, -0.007730553711172229, -0.00777823317776281]
mQ2 = [0, 4.163336342344337e-16, -2.9369910132298797e-7, -3.527626709971362e-6, -1.4189327322926771e-5, -3.5684526621245424e-5, -6.902743575796944e-5, -0.00011366225880335231, -0.00016840116231555747, -0.00023191661693928913, -0.0003029560175609179, -0.00038042352555302635, -0.0004633644459738055, -0.0005509754585483735, -0.000642606103549467, -0.000737672958274774, -0.0008356549957721576, -0.0009362131757687653, -0.0010390548117654795, -0.0011439272704669142, -0.0012507738852435978, -0.0013596682761175208, -0.0014707639822177697, -0.0015841940101096862, -0.001700016910910695, -0.0018182896426161602, -0.0019390588441000676, -0.0020622940251453113, -0.0021879299371526575, -0.0023158939296465814, -0.002446084776080445, -0.002578426350444643, -0.002712806658050449, -0.002849107716256724, -0.002987190356640332, -0.0031268804267261603, -0.00326798192977442, -0.003410292352752587, -0.0035535871931429287, -0.0036976423471588, -0.0038422901202443765, -0.0039874211183411196, -0.0041329606005063675, -0.004278826154045401, -0.004424954106843487, -0.004571400184259462, -0.004718129591199379, -0.004864963040019942, -0.005011656592687355, -0.005158022767295908, -0.005303931085391226, -0.00544940599599778, -0.005594502478575588, -0.005739149842953154, -0.005883316701199073, -0.006027162069241128, -0.006170882191366299, -0.0063144964360923005, -0.006457888298821434, -0.006601041947880746, -0.006744014942128862, -0.006886814778695041, -0.007029320113841512, -0.007171351867155121, -0.007312933257723088, -0.00745434981869187, -0.007595926168451401, -0.00773780958793414, -0.007879932930467569, -0.008022298811737593, -0.008165010147360124, -0.00830819307045555, -0.008452065918239928, -0.008596869536115295, -0.008742687187100298, -0.008889521474163267, -0.009037142091599185, -0.009185325246746161, -0.009334138606870207, -0.009483863483547168, -0.00963475750409481, -0.009786876727657772, -0.009940134232867775, -0.010094520421712237, -0.0102499567058037, -0.010406434716213053, -0.010564249882149625, -0.01072334554267266, -0.010883876119840676, -0.011045802850066492, -0.011208621623413094, -0.01137288030688115, -0.011538785082061841, -0.011705426332412991, -0.011873401015783188, -0.012043496406253424, -0.012214225448471007, -0.01238514488692223, -0.012558237876828826, -0.012733275629863226, -0.012907807421522791, -0.01308248218893321, -0.013260177757289975, -0.013440089761071014, -0.013618611338943524, -0.01379582610878738, -0.013975675383393596, -0.014159150490288111, -0.014342275623113163, -0.014522201359633322, -0.014701601805631445, -0.014884899986093133, -0.015071921913329256, -0.015258043760553258, -0.015440276105660178, -0.015621189275847183, -0.01580547489142776, -0.0159940537691706, -0.016183745610752445, -0.01637107108028549, -0.016555871159612677, -0.01674080188131741, -0.01692827373394179, -0.017117889903349937, -0.017307376861166856, -0.017495230668880497, -0.01768189150833922, -0.017868460737943584, -0.018054930848995086, -0.018240511534232236, -0.018424995634652202, -0.01860989888275051, -0.018797491455468447, -0.018988929084680913, -0.019182664135945618, -0.01937480067695317, -0.019561657499533418, -0.019742150941517614, -0.019919977779764387, -0.020101704720607374, -0.020292648825163805, -0.02049340109151441, -0.020698993037557047, -0.020900898423780134, -0.02109150712995853, -0.021268679508155936, -0.021437495827743024, -0.021607884631428653, -0.021789804515438174, -0.021988959252728976, -0.02220353902639564, -0.02242485168387607, -0.02264090950332115, -0.022841374680259405, -0.023021761170979527, -0.023185344685563047, -0.02334207907549064, -0.023504801062590824, -0.023684396568728266, -0.023885759675250893, -0.024106191580748598, -0.024336627658085495]
#


#= 
mQ1 = mQ1[1:43]
vQ1 = vQ1[1:43]
 =#
# Time step duration
tau = 0.005
nt = 250
ttotal = nt * tau  # Total time evolution
#time_steps = collect(0:10*tau:ttotal)

time_steps = collect(0:lastindex(mQ1)-1) * 5 * tau

# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0, stop = maximum(time_steps), length = 5)
yticks1 = range(0, stop = 6, length = 5)
yticks2 = range(0, stop = 60, length = 5)
#= 
xtick_labels = [L"\$" * string(round(x, digits = 2)) * "\$" for x in xticks]
ytick_labels1 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks1]
ytick_labels2 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks2] =#

xtick_labels = [string(round(x, digits = 2)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]


p1 = plot(time_steps, mQ1, xaxis = L"t", yaxis = L"\langle Q \rangle", 
xtickfont = font(12), ytickfont = font(12), xticks = (xticks, xtick_labels),# yticks = (yticks1, ytick_labels1), 
xguidefontsize=18,yguidefontsize=20, color = :orange,
seriesalpha = 0.9, linewidth = 6, label = L"\ \alpha = 0.5")


plot!(time_steps, mQ2, line = :line, color = :brown, ytickfont = font(12),
seriesalpha = 0.9, linewidth = 6, label = L"\ \alpha = 1.5", yguidefontsize=20, yaxis = L"S_z")

plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
#plot!(legend = :outertopright)

title!(L"\epsilon = 1, \Delta = 0, T = 0.01, (|0\rangle+|1\rangle)/ \sqrt{2}")

#ticks_length!(tl=.04)

# Customize plot appearance, place legend inside
plot!(legend = :right, grid = false, legendfontsize = 16)

display("image/png", p1)
