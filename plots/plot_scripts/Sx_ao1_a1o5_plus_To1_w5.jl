

using DrWatson, Plots, LaTeXStrings
using Plots.PlotMeasures

gr()  # Use GR backend, but you can switch to PyPlot if needed
function ticks_length!(; tl = 0.02)
	p = Plots.current()
	xticks, yticks = Plots.xticks(p)[1][1], Plots.yticks(p)[1][1]
	xl, yl = Plots.xlims(p), Plots.ylims(p)
	x1, y1 = zero(yticks) .+ xl[1], zero(xticks) .+ yl[1]
	sz = p.attr[:size]
	r = sz[1] / sz[2]
	dx, dy = tl * (xl[2] - xl[1]), tl * r * (yl[2] - yl[1])
	plot!([xticks xticks]', [y1 y1 .+ dy]', c = :black, labels = false)
	plot!([x1 x1 .+ dx]', [yticks yticks]', c = :black, labels = false, xlims = xl, ylims = yl)
	return Plots.current()
end
# Define data


#T = 0.1, alpha = 1.5, N_chain = 120, maxdim = 80, cutoff = -12, tau = 0.005, omega_C = 5, boson_dim = 10

Sx2 = [0.5000000000000014, 0.4998437306726534, 0.4993747217967283, 0.49859249621075047, 0.4974966039924199, 0.4960869565077975, 0.49436405828391927, 0.4923290952704198, 0.4899839141774583, 0.4873309430660187, 0.4843730932072611, 0.48111366594432403, 0.47755627397657635, 0.47370477981190834, 0.4695502564880803, 0.46510600117734047, 0.4603770486482604, 0.45536774619620496, 0.4500814414918354, 0.44452189695974853, 0.43869556778796964, 0.43260712649188743, 0.4262622316572586, 0.4196657914858891, 0.41281943565113766, 0.4057287422356362, 0.3984009517275814, 0.3908423830523784, 0.3830546005300239, 0.3750454644976242, 0.366821641084411, 0.35838616375457666, 0.3497470641904787, 0.3409087572495262, 0.33187766879227937, 0.32266020576230303, 0.3132619753179865, 0.30368898789240767, 0.2939480432984824, 0.2840451903794357, 0.2739867528444421, 0.2637769057454859, 0.2534251957859301, 0.24293700491241335, 0.23231961409755847, 0.22157949626091022, 0.21072360990578837, 0.1997587810484234, 0.18869204861574673, 0.17753032766456123, 0.1662798323867723, 0.1549484940359464, 0.14354322074093379, 0.13207131208388917, 0.12053873511450415, 0.10895352517614867, 0.09732284532214544, 0.08565367575088886, 0.07395246111730454, 0.06222753901389038, 0.05048544962957882, 0.03873340176501614, 0.026978848142685207, 0.015228750325256269, 0.0034902195777928324, -0.008229586482192726, -0.019923698402823587, -0.031584975453322915, -0.04320639752383619, -0.05478128795443251, -0.06630244120497512, -0.07776305577181296, -0.089155641725245, -0.10047296652618314, -0.1117090214634681, -0.12285763681510328, -0.1339114368654461, -0.14486391698613638, -0.15570923297494904, -0.16644069811245374, -0.17705260944260437, -0.18753735229269378, -0.19788983494490156, -0.2081030466440788, -0.21817210483345964, -0.22809167993027146, -0.23785486416227541, -0.2474558189051985, -0.25688816486457955, -0.2661473584995455, -0.2752290275922672, -0.284126592097606, -0.2928361960041145, -0.3013514099613636, -0.3096674093682826, -0.3177802500391741, -0.32568525876758003, -0.3333772343421225, -0.3408528729813748, -0.3481076657330738, -0.35513600344981106, -0.3619347311649562, -0.36850162728634434, -0.37483076077907196, -0.38091772031777293, -0.38676290307800404, -0.39236021175781793, -0.3977062116543467, -0.4027995024344977, -0.40763789129583283, -0.41221655881115377, -0.41653293996171825, -0.4205876659414282, -0.42437609394844367, -0.42789623506876984, -0.43114366590232656, -0.43411898772407315, -0.43681962695434035, -0.4392477552439299, -0.44139896606789153, -0.44327129648465463, -0.4448670276751231, -0.4461831079452068, -0.44722101206320014, -0.4479791054075426, -0.4484561584647469, -0.44865404910030376, -0.44857089204676115, -0.4482068665068754, -0.44756452788553236, -0.44664411823958305, -0.44544602832553604, -0.44396990489167726, -0.44221831324754163, -0.44019223097934557, -0.437890907600511, -0.4353212720793839, -0.4324816096013148, -0.4293750479196128, -0.4260005138299317, -0.4223622754363721, -0.41846052487677254, -0.41429895470730943, -0.409876108849841, -0.40519828389700546, -0.40027152400591604, -0.39509419694870695, -0.38967255254472233, -0.3840080288294644, -0.37810360282047717, -0.3719638877814512, -0.3655976297948892, -0.3590069277201982, -0.35219473107361216, -0.34516449296499363, -0.3379168261585384, -0.330454183246617, -0.3227852982903537, -0.3149177089450464, -0.3068616468417588, -0.2986223702800537, -0.2902025420705866, -0.2816025949164656, -0.2728238251854193, -0.2638666062085772, -0.2547367616669994, -0.245446725712177, -0.2360076576655077, -0.22643271323285727, -0.21673096522959875, -0.20690783556557849, -0.1969612408093618, -0.18688896999930557, -0.17668749456068078, -0.16635804351570507, -0.1559080043128206, -0.14535066365243124, -0.13470448756138645, -0.12398669108783279, -0.11321420843396367, -0.1023950283021845, -0.09153082510912901, -0.08061749108346164, -0.06964755330176392, -0.058614158840236324, -0.04751487557193933, -0.03635391522973849, -0.025144214115234653, -0.013904877491662882, -0.002659197452269935, 0.008570256456845225, 0.019764839105033596, 0.03091268224042633, 0.042010601359715335, 0.053062026708465555, 0.06407615877205715, 0.0750640230585611, 0.08603427363079169, 0.09699125921899963, 0.10793220519866967, 0.1188460520812343]



#T = 0.1, alpha = 0.1, N_chain = 140, maxdim = 80, cutoff = -12, tau = 0.005, jump = 5, omega_C = 5, boson_dim = 13;
Sx1 = [0.5000000000000049;
0.49999375000884616;
0.4997750114096665;
0.499243894845025;
0.49840067919015835;
0.49724583162181174;
0.49578002554877576;
0.4940041558316804;
0.4919193450078589;
0.489526939261012;
0.48682850050759024;
0.48382579919205215;
0.48052080751317144;
0.4769156934979441;
0.47301281608394313;
0.4688147209336683;
0.46432413701464853;
0.4595439738604841;
0.4544773185232597;
0.4491274323671829;
0.4434977487559385;
0.4375918709026867;
0.4314135689252135;
0.42496677726235793;
0.4182555919176641;
0.41128426810797725;
0.40405721740985956;
0.39657900453164674;
0.38885434460709595;
0.38088810039312815;
0.37268527830650017;
0.3642510245503621;
0.3555906218392964;
0.34670948665765816;
0.3376131668663738;
0.32830466744898357;
0.3187883719693899;
0.3090742092504785;
0.2991682658402052;
0.28907674631352204;
0.2788059693189579;
0.26836236368822486;
0.2577524636922533;
0.24698290485096727;
0.23606042076669906;
0.224991840058216;
0.2137840822527943;
0.20244415298132382;
0.19097910462616013;
0.17939610720948254;
0.16770240766357963;
0.15590531713536654;
0.1440122118502319;
0.13203052718578834;
0.11996775165355744;
0.1078314212083498;
0.09562911317361736;
0.08336844078412335;
0.07105705325816995;
0.058702624292822546;
0.04631284841678223;
0.033895447925575445;
0.02145816538449029;
0.009008756178538758;
-0.0034450176277735067;
-0.015895391651703294;
-0.028334602533512724;
-0.04075488720027326;
-0.053148499748838444;
-0.06550772903087866;
-0.07782487696865446;
-0.09009225442349124;
-0.10230223695216538;
-0.11444722175190579;
-0.12651963982707604;
-0.13851197898322107;
-0.1504167691193881;
-0.1622265928148798;
-0.17393409998636605;
-0.18553200405823309;
-0.19701307976128166;
-0.20837018146453845;
-0.21959623862275268;
-0.23068427392802998;
-0.24162738919279228;
-0.252418764190418;
-0.2630516797161766;
-0.2735195215970241;
-0.2838157749887444;
-0.2939340267937767;
-0.30386798824770417;
-0.31361147340704904;
-0.3231584236896173;
-0.3325028929419258;
-0.3416390694579;
-0.3505612658399568;
-0.359263930736851;
-0.36774164198533865;
-0.3759891369252137;
-0.38400127178777205;
-0.39177307510361153;
-0.39929971122001756;
-0.40657650181752836;
-0.4135989061557901;
-0.4203625745879222;
-0.4268632887720307;
-0.43309700799133893;
-0.4390598457071554;
-0.444748102008491;
-0.45015824243410457;
-0.45528690457052284;
-0.46013090273020685;
-0.4646872223154886;
-0.46895302585473814;
-0.472925669582514;
-0.47660267967134035;
-0.4799817720487599;
-0.48306083989726856;
-0.485837987217893;
-0.48831149650894506;
-0.49047982586757755;
-0.4923416363747161;
-0.49389577043915606;
-0.49514127772951694;
-0.4960773905037425;
-0.4967035351024764;
-0.4970193289920832;
-0.4970245632142251;
-0.4967192566641297;
-0.4961036045454602;
-0.4951779809470138;
-0.4939429535200918;
-0.49239929690847956;
-0.490547971468118;
-0.48839014582358303;
-0.4859271642591885;
-0.4831605527905048;
-0.4800920268963;
-0.4767234974723486;
-0.47305705663254966;
-0.4690949841505274;
-0.464839748895725;
-0.4602939961752642;
-0.45546055879036706;
-0.45034243958595327;
-0.4449428223187667;
-0.4392650657520665;
-0.4333126972330701;
-0.4270894291573424;
-0.42059914118641634;
-0.41384584608385655;
-0.40683375122829407;
-0.39956720453274736;
-0.39205072548526904;
-0.38428899374699527;
-0.3762868230164264;
-0.36804919630295774;
-0.3595812458795178;
-0.350888231859693;
-0.34197555183194006;
-0.33284873527102854;
-0.32351345863785363;
-0.313975536803466;
-0.3042409176928854;
-0.2943156594208152;
-0.28420590647203026;
-0.2739179399571442;
-0.26345686035209864;
-0.2528305509560102;
-0.2420456894838187;
-0.23110902859183374;
-0.2200273687784907;
-0.2088076413685217;
-0.1974568229971194;
-0.18598185796334724;
-0.174390106236243;
-0.16268898184397293;
-0.1508854457059693;
-0.1389868399638136;
-0.12700058584435456;
-0.11493452809075849;
-0.10279619006329306;
-0.09059321269347796;
-0.07833314751719843;
-0.066023293711964;
-0.05367113603949164;
-0.041284388644509735;
-0.028870989945405687;
-0.01643902086040906;
-0.003996451159300348;
0.008448905405286986;
0.0208896231569944;
0.033318266007023006;
0.045727396600398214;
0.0581092261367919;
0.07045577343881684;
0.08275892612739001;
0.09501063042689187;
0.10720319688444324;
0.11932922421339093;
0.13138169935241825;
0.14335347186631356;
0.1552374803530479;
0.1670261482711819;
0.17871190124424605;
0.1902868114765822;
0.20174309855074826;
0.21307386177355037;
0.22427169979241535;
0.23532978416933334;
0.24624234140002924;
0.2570022501057329;
0.26760391554980606;
0.2780403424240258;
0.28830427398660735;
0.2983891747085037;
0.3082881728698208;
0.3179950494440664;
0.3275033903086625;
0.3368065296428878;
0.3459004334221303;
0.35477956694449614;
0.3634384930962582;
0.37187251178932856;
0.38007586449613934;
0.38804340299332407;
0.39576918561974594;
0.4032492062196245;
0.41047748753195484;
0.41744998749405143;
0.4241624609874088;
0.43061020285082446;
0.4367901553599994;
0.44269855612943143;
0.44833175780067097;
0.45368629119268283;
0.45875905915524884;
0.4635462174513484;
0.46804500118375836;
0.47225281677765746;
0.4761663984769162;
0.4797835157056375;
]
#

#= 
Sx1 = Sx1[1:201]
Sx2 = Sx2[1:201] =#

Sx1 = Sx1[1:30]
Sx2 = Sx2[1:30]

# Time step duration
tau = 0.005
omega_C = 5
ttotal = nt * tau  # Total time evolution
#time_steps = collect(0:10*tau:ttotal)

time_steps = collect(0:lastindex(Sx2)-1) * 5 * tau*omega_C

# Set tick positions and convert tick labels to LaTeX strings automatically
xticks = range(0, stop = maximum(time_steps), length = 5)
yticks1 = range(0, stop = 6, length = 5)
yticks2 = range(0, stop = 60, length = 5)
#= 
xtick_labels = [L"\$" * string(round(x, digits = 2)) * "\$" for x in xticks]
ytick_labels1 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks1]
ytick_labels2 = [L"\$" * string(round(y, digits = 1)) * "\$" for y in yticks2] =#

xtick_labels = [string(round(x, digits = 1)) for x in xticks]
ytick_labels1 = [string(round(y, digits = 1)) for y in yticks1]
ytick_labels2 = [string(round(y, digits = 1)) for y in yticks2]


p1 = plot(time_steps, Sx1, xaxis = L"tω_C", yaxis = L"S_x", #yaxis = L"\frac{\langle\langle Q^2 \rangle\rangle}{\langle Q \rangle}", 
xtickfont = font(20), ytickfont = font(20), xticks = (xticks, xtick_labels),
xguidefontsize=28,yguidefontsize=28, color = :cornflowerblue,
seriesalpha = 1, linewidth = 9, label = "")

# Add a dummy dataset with markers for the legend
#= scatter!(time_steps, Sz1,
      color = :cornflowerblue, marker = :circle, markersize=5, markerstrokewidth=0,# Marker-only for legend
      label = L"\ \alpha = 0.1")

# Add a dummy dataset with markers for the legend
scatter!(time_steps, Sz2, seriesalpha=0.5,
      color = :violetred4, marker = :circle, markersize=5, markerstrokewidth=0, # Marker-only for legend
      label = L"\ \alpha = 1.5") =#
plot!(time_steps, Sx2, color = :violetred4,seriesalpha = .8, linewidth = 9, label = "")


plot!(widen = false)
vline!([xlims(p1)[2]], lc = :black, lw = 2, label = false)
hline!([ylims(p1)[2]], lc = :black, lw = 2, label = false)
#plot!(legend = :outertopright)
plot!(size=(500, 400))

#title!(string(L"\epsilon = 1, \Delta = 0, ω_C = 10, |1\rangle"))

ticks_length!(tl=.02)

# Customize plot appearance, place legend inside
plot!(legend = false, grid = false, legendfontsize = 20, left_margin = [2mm 0mm], right_margin = [10mm 10mm])   #,framestyle = :box), legendposition = (1.6, 0.7)

display("image/png", p1)
